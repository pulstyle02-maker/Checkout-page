<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VENA by modmedicalis | Professional E-commerce</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the carousels and fonts */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Oswald:wght@200..700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap');
        
        :root {
            --primary-color: #5D4037; /* Vintage Brown */
            --brand-red: #EF4444; /* Used for cart count and totals */
            --brand-blue: #3B82F6;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }

        /* Utility classes from user snippet/implied */
        .custom-red-bg {
            background-color: var(--brand-red);
        }

        .text-brand-red {
            color: var(--brand-red);
        }
        
        .oswald-font {
            font-family: 'Oswald', sans-serif;
            letter-spacing: 0.05em;
        }
        
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #D1D5DB;
            border-radius: 0.5rem;
            transition: border-color 0.2s;
        }
        .form-input:focus {
            border-color: var(--brand-red);
            outline: none;
            box-shadow: 0 0 0 1px var(--brand-red);
        }
        
        .confirm-btn {
            background-color: var(--brand-red);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            font-weight: bold;
            transition: opacity 0.2s, transform 0.2s;
        }
        .confirm-btn:hover:not(:disabled) {
            opacity: 0.9;
            transform: scale(1.01);
        }

        /* Sidebar transition classes */
        #cart-sidebar.translate-x-full {
            transform: translateX(100%);
        }
        #cart-sidebar {
            transition: transform 0.3s ease-out;
        }

        /* Full width and snap behavior for carousels */
        .header-carousel-item, .product-carousel-item {
            scroll-snap-align: start;
            flex-shrink: 0;
            width: 100%;
        }

        .snap-x-mandatory {
            scroll-snap-type: x mandatory;
        }

        .vintage-brown-bg {
            background-color: var(--primary-color);
            color: white;
            font-family: 'Playfair Display', serif;
        }
        
        .product-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
        }
        
        /* Disable body scroll when modals are open */
        body.modal-open {
            overflow: hidden;
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Navbar - UPDATED for Centered, Enlarged Logo & Text Removal -->
    <nav class="sticky top-0 z-50 bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Grid layout to center the logo and push cart to the right -->
            <div class="grid grid-cols-3 h-20 items-center">
                <!-- Left spacing (col 1) -->
                <div></div>

                <!-- Center Logo (col 2) -->
                <div class="flex justify-center">
                    <!-- Logo (h-16 for larger size) -->
                    <img class="h-16 w-auto" 
                         src="https://i.imgur.com/6y8Yrdp.png" 
                         alt="VENA by modmedicalis Logo" 
                         loading="eager" 
                         onerror="this.src='https://placehold.co/100x40/000/fff?text=VENA'">
                    <!-- Removed VENA text span -->
                </div>

                <!-- Right Cart Button (col 3) -->
                <div class="flex justify-end items-center">
                    <!-- Cart Button -->
                    <button id="cart-toggle" class="text-gray-800 hover:text-brand-red transition relative p-2 rounded-full">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>
                        <span id="cart-count" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 custom-red-bg rounded-full">0</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header Carousel -->
    <header class="w-full relative overflow-hidden h-96 md:h-[600px] shadow-xl">
        <div id="header-carousel" class="flex w-full h-full snap-x-mandatory overflow-x-auto scroll-smooth">
            <img class="header-carousel-item object-cover w-full h-full" src="https://i.imgur.com/QjemELd.png" alt="Header Image 1" onerror="this.src='https://placehold.co/1200x600/388e3c/ffffff?text=VENA+1'">
            <img class="header-carousel-item object-cover w-full h-full" src="https://i.imgur.com/y1DqJUx.png" alt="Header Image 2" onerror="this.src='https://placehold.co/1200x600/388e3c/ffffff?text=VENA+2'">
            <img class="header-carousel-item object-cover w-full h-full" src="https://i.imgur.com/YHOLedE.png" alt="Header Image 3" onerror="this.src='https://placehold.co/1200x600/388e3c/ffffff?text=VENA+3'">
            <img class="header-carousel-item object-cover w-full h-full" src="https://i.imgur.com/1OZTjKB.png" alt="Header Image 4" onerror="this.src='https://placehold.co/1200x600/388e3c/ffffff?text=VENA+4'">
        </div>
        <div id="header-nav-dots" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
            <!-- Navigation dots will be injected here -->
        </div>
    </header>

    <!-- Main Content -->
    <main class="py-12 px-4">
        
        <!-- BOOKMARKS Section -->
        <section class="max-w-7xl mx-auto">
            <h2 class="text-4xl font-bold text-gray-800 mb-8 text-center">BOOKMARKS</h2>
            
            <!-- THE HUMAN ANATOMY Product Card -->
            <div id="product-card" class="rounded-xl overflow-hidden shadow-2xl vintage-brown-bg max-w-4xl mx-auto mb-16">
                
                <h3 class="product-title text-center pt-8 px-4 border-b border-white/20 pb-4 tracking-wider">THE HUMAN ANATOMY</h3>

                <div class="md:flex">
                    <!-- Product Image Carousel -->
                    <div class="md:w-1/2 relative overflow-hidden h-80 md:h-96">
                        <div id="product-carousel" class="flex w-full h-full snap-x-mandatory overflow-x-auto scroll-smooth">
                            <img class="product-carousel-item object-cover w-full h-full" src="https://i.imgur.com/h7KdUZE.png" alt="Anatomy Bookmark 1" onerror="this.src='https://placehold.co/500x500/8d6e63/ffffff?text=Anatomy+1'">
                            <img class="product-carousel-item object-cover w-full h-full" src="https://i.imgur.com/xsY8EKr.png" alt="Anatomy Bookmark 2" onerror="this.src='https://placehold.co/500x500/8d6e63/ffffff?text=Anatomy+2'">
                            <img class="product-carousel-item object-cover w-full h-full" src="https://i.imgur.com/zAJE5mW.png" alt="Anatomy Bookmark 3" onerror="this.src='https://placehold.co/500x500/8d6e63/ffffff?text=Anatomy+3'">
                            <img class="product-carousel-item object-cover w-full h-full" src="https://i.imgur.com/tm4AidM.jpeg" alt="Anatomy Bookmark 4" onerror="this.src='https://placehold.co/500x500/8d6e63/ffffff?text=Anatomy+4'">
                            <img class="product-carousel-item object-cover w-full h-full" src="https://i.imgur.com/yxbjdq3.png" alt="Anatomy Bookmark 5" onerror="this.src='https://placehold.co/500x500/8d6e63/ffffff?text=Anatomy+5'">
                        </div>
                        <div id="product-nav-dots" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
                            <!-- Navigation dots will be injected here -->
                        </div>
                    </div>
                    
                    <!-- Product Details -->
                    <div class="md:w-1/2 p-8 flex flex-col justify-center">
                        <h4 class="text-3xl font-semibold mb-2">THE HUMAN ANATOMY BOOKMARKS</h4>
                        <p class="text-lg font-light mb-4">Pack of 5</p>
                        <p class="text-4xl font-bold mb-6">Rs 200</p>
                        
                        <button 
                            onclick="addToCartAndShowCart('p1')"
                            class="bg-white text-gray-800 font-bold py-3 px-6 rounded-lg shadow-xl hover:bg-gray-100 transition duration-300 transform hover:scale-[1.02] text-xl"
                        >
                            Add to Cart
                        </button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white p-6 text-center">
        <p>&copy; 2025 VENA by modmedicalis. All rights reserved.</p>
    </footer>

    <!-- Custom Message Box (Replaces Alert/Confirm) -->
    <div id="custom-message-box" class="fixed top-20 left-1/2 transform -translate-x-1/2 p-4 rounded-lg shadow-xl text-white font-semibold transition-opacity duration-300 z-[120] opacity-0 pointer-events-none"></div>

    <!-- Modals (Cart Sidebar & Checkout Modal) -->

    <!-- 1. Cart Modal (Sidebar) UI/UX - Initially Hidden -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 z-[100] hidden" role="dialog" aria-modal="true">
        <div class="fixed top-0 right-0 h-full w-full sm:w-[400px] bg-white shadow-2xl flex flex-col transform translate-x-full transition-transform duration-300" id="cart-sidebar">
            
            <div class="p-4 border-b flex justify-between items-center sticky top-0 bg-white z-10">
                <h2 class="text-xl font-bold text-gray-900 oswald-font">YOUR CART</h2>
                <button id="cart-close" class="text-gray-500 hover:text-brand-red text-2xl font-light">&times;</button>
            </div>

            <div id="cart-items-container" class="flex-grow overflow-y-auto p-4 space-y-4">
                <!-- Cart items will be rendered here -->
            </div>

            <div class="p-4 border-t sticky bottom-0 bg-white shadow-lg z-10">
                <div class="flex justify-between items-center mb-4 text-lg font-bold">
                    <span>Subtotal:</span>
                    <span id="cart-subtotal" class="text-brand-red">Rs.0</span>
                </div>
                <button id="checkout-button" class="w-full custom-red-bg text-white font-bold py-3 px-4 rounded-xl shadow-lg transition transform hover:opacity-90 disabled:opacity-50" disabled>
                    PROCEED TO CHECKOUT
                </button>
            </div>
        </div>
    </div>

    <!-- 2. Checkout Modal UI/UX - Initially Hidden -->
    <div id="checkout-modal" class="fixed inset-0 bg-black bg-opacity-50 z-[110] hidden" role="dialog" aria-modal="true">
        <div class="fixed inset-0 flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg p-6 sm:p-8 transform transition-all max-h-[90vh] overflow-y-auto" id="checkout-form-container">
                
                <div class="flex justify-between items-center mb-6 sticky top-0 bg-white pt-2 pb-2 -mx-2 z-20">
                    <h2 class="text-2xl font-bold oswald-font text-gray-900">CHECKOUT DETAILS</h2>
                    <button id="checkout-form-close" class="text-gray-500 hover:text-brand-red text-2xl font-light">&times;</button>
                </div>

                <form id="checkout-form" action="https://formsubmit.co/hasnainmughal4200@gmail.com" method="POST" enctype="multipart/form-data" class="space-y-6">
                    <!-- Hidden fields for form submission -->
                    <input type="hidden" name="_subject" id="order-subject-input" value="New Order from VENA Website!">
                    <input type="hidden" name="_redirect" value="https://example.com/thank-you"> <!-- Placeholder redirect -->
                    <input type="hidden" name="Order_Number" id="order-number-input">
                    <input type="hidden" name="Cart_Summary_and_Details" id="cart-summary-input">
                    <input type="hidden" name="Total_Price_Paid" id="total-price-input">
                    
                    <!-- Form Fields -->
                    <div><label for="full_name" class="block text-sm font-semibold mb-1 text-gray-700 oswald-font">FULL NAME</label><input type="text" id="full_name" name="Full Name" required class="form-input oswald-font" placeholder="Muhammad Hasnain"></div>
                    <div><label for="contact_number" class="block text-sm font-semibold mb-1 text-gray-700 oswald-font">CONTACT NUMBER</label><input type="tel" id="contact_number" name="Contact Number" required class="form-input oswald-font" placeholder="e.g. 03096554421"></div>
                    
                    <!-- COLLEGE SECTION REMOVED -->
                    <!-- PROMO CODE SECTION REMOVED -->

                    <div><label for="shipping_address" class="block text-sm font-semibold mb-1 text-gray-700 oswald-font">SHIPPING ADDRESS</label><textarea id="shipping_address" name="Shipping Address" required rows="3" class="form-input oswald-font" placeholder="Enter full address with city and landmark"></textarea></div>

                    <div class="payment-box p-4 border border-gray-200 rounded-xl bg-gray-50">
                        <h3 class="text-lg font-bold oswald-font text-gray-800 mb-2">PAYMENT DETAILS</h3>
                        <p class="text-sm font-medium text-gray-700 mb-1">Total to Pay: <span id="final-total" class="font-bold text-lg text-brand-red">Rs.0</span></p>
                        
                        <div class="mt-3">
                             <h4 class="text-sm font-bold text-gray-700 mb-1">Payment Method (EasyPaisa / JazzCash)</h4>
                             <p class="text-sm text-gray-600 mb-2">Please pay the amount to the following account:</p>
                             <div class="bg-white p-3 rounded-lg border border-indigo-200">
                                <p class="font-bold text-md mb-1 text-indigo-700">03096554421 - MUHAMMAD HASNAIN</p>
                             </div>
                        </div>

                        <div class="mt-4">
                            <!-- This input sends the file as an attachment due to enctype="multipart/form-data" -->
                            <label for="payment_slip" class="block text-sm font-semibold mb-1 text-gray-700 oswald-font">UPLOAD PAYMENT SLIP <span class="text-red-500">*</span></label>
                            <input type="file" id="payment_slip" name="Payment Slip" accept="image/*" required class="form-input text-sm pt-2">
                        </div>
                    </div>

                    <!-- Final Order Summary will be visible once payment slip is attached -->
                    <div id="final-order-summary" class="hidden p-4 bg-yellow-50 border border-yellow-300 rounded-xl text-sm">
                        <p class="font-bold text-yellow-800">Order Summary:</p>
                        <p>Products: <span id="summary-product-price">Rs.0</span></p>
                        <!-- Discount Row Removed -->
                        <p class="font-extrabold text-base border-t mt-1 pt-1 text-brand-red">GRAND TOTAL: <span id="summary-final-total">Rs.0</span></p>
                    </div>

                    <div class="text-center">
                        <button type="submit" id="confirm-order-btn" class="confirm-btn w-full oswald-font text-lg py-3" disabled>CONFIRM ORDER</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 3. Thank You Message Modal -->
    <div id="thank-you-modal" class="fixed inset-0 bg-black bg-opacity-50 z-[120] hidden flex items-center justify-center p-4" role="dialog" aria-modal="true">
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-sm p-8 text-center">
            <svg class="mx-auto w-16 h-16 text-green-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <h3 class="text-2xl font-bold oswald-font text-gray-900 mb-2">ORDER PLACED!</h3>
            <p class="text-gray-700 mb-4">Your order has been successfully sent to VENA. We will contact you soon!</p>
            <p id="receipt-order-number" class="text-lg font-bold text-indigo-600 mb-6"></p>
            <button onclick="window.location.reload()" class="w-full bg-gray-800 text-white font-bold py-3 px-4 rounded-xl transition hover:bg-gray-700">
                Finish & Go Home
            </button>
        </div>
    </div>

    <script>
        // --- Core Data Structure ---
        const products = [
            {
                id: 'p1',
                name: 'The Human Anatomy Bookmarks (Pack of 5)',
                price: 200,
                img: 'https://i.imgur.com/h7KdUZE.png',
                status: 'available'
            }
        ];

        // --- Global State ---
        let cart = []; // The array storing cart items: [{ id: 'p1', quantity: 1 }]
        let finalTotal = 0;
        let orderNumber = '';

        // --- Helper Functions ---
        const getProductById = (id) => products.find(p => p.id === id);

        const formatPrice = (price) => {
            if (price === 0) return 'Rs.0';
            // Simple comma formatting for display
            return `Rs.${price.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",")}`;
        };

        function showCustomMessage(message, type = 'info') {
            const messageBox = document.getElementById('custom-message-box');
            
            if (type === 'error') {
                messageBox.style.backgroundColor = '#EF4444'; // Red-500
            } else if (type === 'success') {
                 messageBox.style.backgroundColor = '#10B981'; // Green-500
            } else {
                messageBox.style.backgroundColor = '#3B82F6'; // Blue-500
            }

            messageBox.textContent = message;
            
            messageBox.classList.remove('opacity-0', 'pointer-events-none');
            
            setTimeout(() => {
                messageBox.classList.add('opacity-0', 'pointer-events-none');
            }, 3000);
        }

        // --- Cart Management Functions ---
        
        function addToCartAndShowCart(productId) {
            if (productId) {
                addToCart(productId);
            }
            // Show the cart modal and slide in the sidebar
            document.getElementById('cart-modal').classList.remove('hidden');
            document.body.classList.add('modal-open');
            // Use requestAnimationFrame for smooth transition start
            requestAnimationFrame(() => document.getElementById('cart-sidebar').classList.remove('translate-x-full'));
        }

        function addToCart(productId) {
            const product = getProductById(productId);
            if (!product) {
                showCustomMessage('Product not found.', 'error');
                return;
            }
            if (product.status === 'coming-soon') {
                showCustomMessage('This product is not yet available for purchase.', 'error');
                return;
            }

            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ id: productId, quantity: 1 });
            }
            showCustomMessage(`${product.name} added to cart!`, 'success');
            updateCartUI();
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartUI();
            if (cart.length === 0) {
                 showCustomMessage('Cart is now empty.', 'info');
                 closeCartSidebar();
            }
        }

        function increaseQuantity(productId) {
            const item = cart.find(i => i.id === productId);
            if (item) {
                item.quantity += 1;
                updateCartUI();
            }
        }

        function decreaseQuantity(productId) {
            const item = cart.find(i => i.id === productId);
            if (item && item.quantity > 1) {
                item.quantity -= 1;
            } else if (item && item.quantity === 1) {
                removeFromCart(productId);
            }
            updateCartUI();
        }

        function updateCartUI() {
            const container = document.getElementById('cart-items-container');
            const subtotalEl = document.getElementById('cart-subtotal');
            const countEl = document.getElementById('cart-count');
            const checkoutBtn = document.getElementById('checkout-button');
            let subtotal = 0;
            let totalItems = 0;
            container.innerHTML = '';

            if (cart.length === 0) {
                container.innerHTML = `<p class="text-center text-gray-500 mt-8">Your cart is empty.</p>`;
                subtotalEl.textContent = formatPrice(0);
                countEl.textContent = '0';
                checkoutBtn.disabled = true; // Disable checkout button
            } else {
                cart.forEach(item => {
                    const product = getProductById(item.id);
                    if (!product) return;
                    const itemTotal = product.price * item.quantity;
                    totalItems += item.quantity;
                    subtotal += itemTotal;

                    const imageSrc = product.img || `https://placehold.co/64x64/CCCCCC/333333?text=Product`;

                    const cartItemHTML = `
                        <div class="flex items-start justify-between border-b border-gray-100 pb-4 pt-4">
                            <div class="flex space-x-3">
                                <div class="w-16 h-16 bg-gray-200 rounded-lg flex-shrink-0 overflow-hidden">
                                    <img src="${imageSrc}" alt="${product.name}" class="object-cover w-full h-full">
                                </div>
                                <div class="flex flex-col">
                                    <p class="font-semibold text-sm line-clamp-2 text-gray-800">${product.name}</p>
                                    <p class="text-xs text-gray-500">${formatPrice(product.price)} each</p>
                                    <button onclick="removeFromCart('${product.id}')" class="text-xs text-brand-red text-left mt-1 hover:opacity-70 transition">Remove</button>
                                </div>
                            </div>
                            <div class="flex flex-col items-end space-y-1">
                                <span class="font-bold text-sm text-gray-900">${formatPrice(itemTotal)}</span>
                                <div class="flex items-center border border-gray-300 rounded-lg">
                                    <button onclick="decreaseQuantity('${product.id}')" class="w-7 h-7 flex items-center justify-center text-gray-700 hover:bg-gray-100 rounded-l-lg disabled:opacity-30 transition" ${item.quantity <= 1 ? 'disabled' : ''}>&minus;</button>
                                    <span class="w-6 text-center text-sm font-medium text-gray-800">${item.quantity}</span>
                                    <button onclick="increaseQuantity('${product.id}')" class="w-7 h-7 flex items-center justify-center text-gray-700 hover:bg-gray-100 rounded-r-lg transition">+</button>
                                </div>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', cartItemHTML);
                });

                subtotalEl.textContent = formatPrice(subtotal);
                countEl.textContent = totalItems > 99 ? '99+' : totalItems.toString();
                checkoutBtn.disabled = false; // Enable checkout button
                
                // Set the initial finalTotal
                finalTotal = subtotal; 
                document.getElementById('total-price-input').value = finalTotal;
            }
        }

        // --- Checkout Form Logic ---
        
        function closeCartSidebar() {
            const cartModal = document.getElementById('cart-modal');
            const cartSidebar = document.getElementById('cart-sidebar');
            cartSidebar.classList.add('translate-x-full');
            document.body.classList.remove('modal-open');
            setTimeout(() => cartModal.classList.add('hidden'), 300); // Wait for transition
        }


        function openCheckoutForm() {
            if (cart.length === 0) {
                showCustomMessage('Your cart is empty. Please add a product to proceed.', 'error');
                return;
            }

            closeCartSidebar(); // Hide the cart modal

            // Show the checkout modal
            const checkoutModal = document.getElementById('checkout-modal');
            checkoutModal.classList.remove('hidden');
            document.body.classList.add('modal-open');
            
            // Recalculate and display total
            updateFinalSummary();

            // Set hidden form fields for submission
            orderNumber = `DRG-${Math.floor(Math.random() * 1000000)}`;
            document.getElementById('order-number-input').value = orderNumber;

            const cartSummary = cart.map(item => {
                const product = getProductById(item.id);
                return `${product.name} (x${item.quantity})`;
            }).join(' | ');
            document.getElementById('cart-summary-input').value = cartSummary;
        }

        function closeCheckoutForm() {
            document.getElementById('checkout-modal').classList.add('hidden');
            document.body.classList.remove('modal-open');
        }

        function updateFinalSummary() {
            // Since discount is removed, finalTotal is always equal to subtotal
            finalTotal = cart.reduce((sum, item) => sum + getProductById(item.id).price * item.quantity, 0);
            
            // Update all elements
            document.getElementById('final-total').textContent = formatPrice(finalTotal);
            document.getElementById('summary-product-price').textContent = formatPrice(finalTotal);
            document.getElementById('summary-final-total').textContent = formatPrice(finalTotal);
            document.getElementById('total-price-input').value = finalTotal;
        }

        function showThankYouMessage(orderNum) {
            closeCheckoutForm();
            document.getElementById('receipt-order-number').textContent = `Order Ref: ${orderNum}`;
            document.getElementById('thank-you-modal').classList.remove('hidden');
            document.body.classList.add('modal-open');
        }

        // --- Initialization and Event Listeners ---
        window.onload = function() {
            // Setup carousels
            setupCarousel('header-carousel', 5000); 
            setupCarousel('product-carousel', 4000); 
            
            // Initial cart UI render
            updateCartUI();

            // --- Cart Modal Toggles ---
            const cartToggle = document.getElementById('cart-toggle');
            const cartModal = document.getElementById('cart-modal');
            const checkoutBtn = document.getElementById('checkout-button');

            cartToggle.addEventListener('click', () => {
                if(cartModal.classList.contains('hidden')) {
                    addToCartAndShowCart(null); // Just opens the cart
                } else {
                    closeCartSidebar();
                }
            });

            document.getElementById('cart-close').addEventListener('click', closeCartSidebar);

            // Close sidebar when clicking outside the sidebar but inside the modal
            cartModal.addEventListener('click', (e) => {
                if (e.target === cartModal) {
                    closeCartSidebar();
                }
            });

            // --- Checkout Form UI & Logic ---
            checkoutBtn.addEventListener('click', openCheckoutForm);
            document.getElementById('checkout-form-close').addEventListener('click', closeCheckoutForm);

            // Enables the final order button and shows summary once payment slip is attached
            const confirmOrderBtn = document.getElementById('confirm-order-btn');
            const finalOrderSummary = document.getElementById('final-order-summary');
            document.getElementById('payment_slip').addEventListener('change', () => {
                if (document.getElementById('payment_slip').files.length > 0) {
                    confirmOrderBtn.disabled = false;
                    finalOrderSummary.classList.remove('hidden');
                    updateFinalSummary();
                } else {
                    confirmOrderBtn.disabled = true;
                    finalOrderSummary.classList.add('hidden');
                }
            });

            // --- Form Submission Logic with FormSubmit ---
            document.getElementById('checkout-form').addEventListener('submit', function(e) {
                e.preventDefault();
                confirmOrderBtn.textContent = 'SUBMITTING...';
                confirmOrderBtn.disabled = true;

                const form = e.target;
                const formData = new FormData(form);
                
                // Update final total just before submission
                updateFinalSummary(); 
                formData.set('Total_Price_Paid', document.getElementById('total-price-input').value);
                
                // Adding a static field for the removed 'College' selection, to prevent FormSubmit issues
                formData.append('College', 'N/A (Removed from Form)');
                // Adding a static field for the removed 'Promo Code', to prevent FormSubmit issues
                formData.append('Promo_Code_Used', 'N/A (Removed from Form)');


                // FormSubmit submission logic (uses fetch API)
                fetch(form.action, {
                    method: 'POST',
                    body: formData,
                }).then(response => {
                    if (response.ok) {
                         // Success handling
                         showThankYouMessage(orderNumber);
                         cart = [];
                         updateCartUI(); // Clear cart
                    } else {
                        // Error handling
                        showCustomMessage('Order submission failed. Please try again.', 'error');
                    }
                }).catch(error => {
                    showCustomMessage('Network error. Check your connection.', 'error');
                    console.error('Submission Error:', error);
                }).finally(() => {
                    confirmOrderBtn.textContent = 'CONFIRM ORDER';
                });
            });
        };
        
        // --- Carousel Logic (Unchanged) ---
        function setupCarousel(containerId, interval = 5000) {
            const container = document.getElementById(containerId);
            const items = container.children;
            const numItems = items.length;
            let currentIndex = 0;
            let autoSwipeTimer;
            const dotsContainer = document.getElementById(`${containerId.replace('-carousel', '')}-nav-dots`);
            
            if (numItems === 0) return;

            const scrollTo = (index) => {
                if (items[index]) {
                    const scrollPosition = index * items[index].offsetWidth;
                    container.scrollTo({
                        left: scrollPosition,
                        behavior: 'smooth'
                    });
                    currentIndex = index;
                    updateDots(currentIndex);
                }
            };

            const startAutoSwipe = () => {
                clearInterval(autoSwipeTimer);
                autoSwipeTimer = setInterval(() => {
                    currentIndex = (currentIndex + 1) % numItems;
                    scrollTo(currentIndex);
                }, interval);
            };

            container.addEventListener('scroll', () => {
                const scrollLeft = container.scrollLeft;
                const itemWidth = container.offsetWidth;
                const newIndex = Math.round(scrollLeft / itemWidth);
                if (newIndex !== currentIndex && newIndex >= 0 && newIndex < numItems) {
                    currentIndex = newIndex;
                    updateDots(currentIndex);
                }
                
                clearInterval(autoSwipeTimer);
                startAutoSwipe();
            }, { passive: true });

            dotsContainer.innerHTML = '';
            for (let i = 0; i < numItems; i++) {
                const dot = document.createElement('button');
                dot.className = 'w-3 h-3 rounded-full bg-white transition-all duration-300 bg-opacity-50 hover:bg-opacity-90';
                dot.onclick = () => {
                    scrollTo(i);
                    clearInterval(autoSwipeTimer);
                    startAutoSwipe();
                };
                dotsContainer.appendChild(dot);
            }
            
            const updateDots = (index) => {
                Array.from(dotsContainer.children).forEach((dot, i) => {
                    if (i === index) {
                        dot.classList.add('w-5', 'bg-opacity-90');
                        dot.classList.remove('w-3', 'bg-opacity-50');
                    } else {
                        dot.classList.add('w-3', 'bg-opacity-50');
                        dot.classList.remove('w-5', 'bg-opacity-90');
                    }
                });
            };

            updateDots(0);
            startAutoSwipe();
        }
    </script>
</body>
</html>


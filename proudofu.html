<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histology UWorld Style Quiz</title>
    <style>
        :root {
            --bg-color: #1e2124;
            --sidebar-bg: #2f3136;
            --text-color: #dcddde;
            --accent-blue: #7289da;
            --hover-color: #36393f;
            --correct-green: #2ecc71;
            --incorrect-red: #e74c3c;
            --border-color: #40444b;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 20px;
            font-weight: bold;
            font-size: 1.2rem;
            border-bottom: 1px solid var(--border-color);
            background-color: #202225;
        }

        .q-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .q-item {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 1px solid #383c42;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .q-item:hover {
            background-color: var(--hover-color);
        }

        .q-item.active {
            background-color: #40444b;
            border-left: 4px solid var(--accent-blue);
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-correct { background-color: var(--correct-green); }
        .status-incorrect { background-color: var(--incorrect-red); }
        .status-unanswered { background-color: transparent; }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 0;
            overflow-y: auto;
        }

        .top-bar {
            padding: 15px 30px;
            background-color: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .timer {
            font-family: monospace;
            font-size: 1.1rem;
            color: #b9bbbe;
        }

        .content-area {
            padding: 30px;
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .question-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-label {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .option-label:hover {
            background-color: var(--hover-color);
        }

        .option-input {
            margin-right: 15px;
            transform: scale(1.2);
        }

        /* Buttons */
        .controls {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            padding-bottom: 30px;
        }

        .btn {
            padding: 10px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            color: white;
            transition: opacity 0.2s;
        }

        .btn:hover { opacity: 0.9; }

        .btn-submit { background-color: var(--accent-blue); }
        .btn-nav { background-color: #4f545c; }
        .btn:disabled { background-color: #333; cursor: not-allowed; opacity: 0.5; }

        /* Explanation Section */
        .explanation-box {
            margin-top: 30px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: #26292e;
            display: none; /* Hidden by default */
        }

        .explanation-header {
            background-color: #36393f;
            padding: 10px 15px;
            font-weight: bold;
            border-bottom: 1px solid var(--border-color);
        }

        .explanation-content {
            padding: 20px;
            line-height: 1.6;
            color: #b9bbbe;
        }

        .highlight-correct { border: 2px solid var(--correct-green); background-color: rgba(46, 204, 113, 0.1); }
        .highlight-incorrect { border: 2px solid var(--incorrect-red); background-color: rgba(231, 76, 60, 0.1); }

    </style>
</head>
<body>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            Skin & Neuro Quiz
            <div style="font-size: 0.8rem; color: #888; margin-top:5px;">50 Questions</div>
        </div>
        <ul class="q-list" id="questionList">
            <!-- List generated by JS -->
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="top-bar">
            <div id="q-header">Question 1 of 50</div>
            <div class="timer" id="timer">00:00:00</div>
        </div>

        <div class="content-area">
            <div class="question-text" id="questionText">
                Loading question...
            </div>

            <div class="options-container" id="optionsContainer">
                <!-- Options generated by JS -->
            </div>

            <div class="controls">
                <button class="btn btn-submit" id="submitBtn" onclick="submitAnswer()">Submit</button>
                <button class="btn btn-nav" id="nextBtn" onclick="nextQuestion()">Next &gt;</button>
            </div>

            <div class="explanation-box" id="explanationBox">
                <div class="explanation-header">Explanation</div>
                <div class="explanation-content" id="explanationText"></div>
            </div>
        </div>
    </div>

    <script>
        // --- 50 MCQs Data (25 Skin, 25 Neuro) ---
        const questions = [
            // SKIN HISTOLOGY (1-25)
            {
                q: "Which layer of the epidermis is responsible for the continuous renewal of keratinocytes?",
                options: ["Stratum corneum", "Stratum granulosum", "Stratum basale", "Stratum lucidum"],
                answer: 2,
                explanation: "The <strong>Stratum basale</strong> (basal layer) contains stem cells that are mitotically active. These cells divide to produce new keratinocytes, which then migrate superficially."
            },
            {
                q: "In which layer of the epidermis are desmosomes most prominent, giving the cells a 'spiny' appearance under the microscope?",
                options: ["Stratum spinosum", "Stratum basale", "Stratum granulosum", "Stratum corneum"],
                answer: 0,
                explanation: "The <strong>Stratum spinosum</strong> is named for the 'spiny' appearance of cells caused by shrinkage during tissue preparation, which reveals the prominent desmosomes connecting adjacent cells."
            },
            {
                q: "Which cell type is responsible for producing the pigment that protects the skin from UV radiation?",
                options: ["Keratinocytes", "Langerhans cells", "Melanocytes", "Merkel cells"],
                answer: 2,
                explanation: "<strong>Melanocytes</strong> produce melanin. They are found in the stratum basale and transfer melanin granules (melanosomes) to adjacent keratinocytes."
            },
            {
                q: "Langerhans cells found in the stratum spinosum are functionally classified as:",
                options: ["Mechanoreceptors", "Antigen-presenting cells", "Stem cells", "Sebum producers"],
                answer: 1,
                explanation: "<strong>Langerhans cells</strong> are dendritic cells derived from the bone marrow. They function as antigen-presenting cells (APCs) in the skin's immune system."
            },
            {
                q: "Which layer of the dermis consists primarily of loose areolar connective tissue and forms dermal papillae?",
                options: ["Reticular layer", "Papillary layer", "Hypodermis", "Stratum basale"],
                answer: 1,
                explanation: "The <strong>Papillary layer</strong> is the superficial layer of the dermis. It consists of loose connective tissue and forms dermal papillae that interdigitate with the epidermis."
            },
            {
                q: "Thick skin, such as that found on the palms and soles, is distinguished from thin skin by the presence of which distinct layer?",
                options: ["Stratum spinosum", "Stratum lucidum", "Stratum granulosum", "Papillary dermis"],
                answer: 1,
                explanation: "The <strong>Stratum lucidum</strong> is a thin, translucent layer of dead keratinocytes found only in thick skin, located between the stratum granulosum and stratum corneum."
            },
            {
                q: "Sebaceous glands release their secretory product via which mechanism?",
                options: ["Merocrine", "Apocrine", "Holocrine", "Endocrine"],
                answer: 2,
                explanation: "Sebaceous glands use <strong>Holocrine</strong> secretion, where the entire cell disintegrates to release sebum."
            },
            {
                q: "Which receptor is most commonly associated with detecting light touch and is located in the dermal papillae?",
                options: ["Pacinian corpuscle", "Ruffini ending", "Meissner's corpuscle", "Free nerve ending"],
                answer: 2,
                explanation: "<strong>Meissner's corpuscles</strong> are tactile receptors found in the dermal papillae of hairless skin (e.g., fingertips) and are responsible for detecting light touch."
            },
            {
                q: "Pacinian corpuscles are typically located in the deep dermis or hypodermis and are responsible for detecting:",
                options: ["Fine touch", "Deep pressure and vibration", "Temperature", "Pain"],
                answer: 1,
                explanation: "<strong>Pacinian corpuscles</strong> are large, onion-like structures found deep in the dermis/hypodermis that detect deep pressure and high-frequency vibration."
            },
            {
                q: "The intense basophilia of the keratohyalin granules is a characteristic feature of which epidermal layer?",
                options: ["Stratum spinosum", "Stratum granulosum", "Stratum corneum", "Stratum basale"],
                answer: 1,
                explanation: "The <strong>Stratum granulosum</strong> contains coarse, basophilic keratohyalin granules involved in keratinization."
            },
            {
                q: "Which protein is the primary structural component of the epidermal barrier produced by keratinocytes?",
                options: ["Collagen type I", "Elastin", "Keratin", "Vimentin"],
                answer: 2,
                explanation: "<strong>Keratin</strong> (intermediate filaments) is the primary structural protein in keratinocytes, providing strength and waterproofing to the epidermis."
            },
            {
                q: "Merkel cells are located in the stratum basale and function as:",
                options: ["Immune cells", "Mechanoreceptors for touch", "Pigment producers", "Sweat producers"],
                answer: 1,
                explanation: "<strong>Merkel cells</strong> are neuroendocrine cells in the basal layer associated with sensory nerve endings, functioning as mechanoreceptors for light touch/texture."
            },
            {
                q: "Eccrine sweat glands are classified histologically as:",
                options: ["Simple coiled tubular glands", "Simple branched acinar glands", "Compound tubuloacinar glands", "Simple alveolar glands"],
                answer: 0,
                explanation: "Eccrine sweat glands are <strong>simple coiled tubular glands</strong>. They secrete watery sweat directly onto the skin surface."
            },
            {
                q: "The reticular layer of the dermis is composed primarily of:",
                options: ["Loose areolar connective tissue", "Dense irregular connective tissue", "Dense regular connective tissue", "Adipose tissue"],
                answer: 1,
                explanation: "The <strong>reticular layer</strong> makes up the bulk of the dermis and consists of dense irregular connective tissue, providing tensile strength in multiple directions."
            },
            {
                q: "Myoepithelial cells are found associated with which skin structure?",
                options: ["Sebaceous glands", "Sweat glands", "Hair shaft", "Stratum corneum"],
                answer: 1,
                explanation: "<strong>Sweat glands</strong> (both eccrine and apocrine) contain myoepithelial cells at their base, which contract to help expel secretions."
            },
            {
                q: "The glassy membrane is a thickened basement membrane associated with:",
                options: ["The dermo-epidermal junction", "Hair follicles", "Sebaceous glands", "Sweat ducts"],
                answer: 1,
                explanation: "The <strong>glassy membrane</strong> separates the hair follicle from the surrounding dermis. It is a thickened basement membrane."
            },
            {
                q: "Which of the following is NOT a layer of the hair shaft?",
                options: ["Medulla", "Cortex", "Cuticle", "Glassy membrane"],
                answer: 3,
                explanation: "The hair shaft consists of the medulla, cortex, and cuticle. The <strong>glassy membrane</strong> is a connective tissue sheath surrounding the follicle, not part of the shaft itself."
            },
            {
                q: "The arrector pili muscle attaches to the hair follicle and the:",
                options: ["Hypodermis", "Papillary dermis", "Reticular dermis", "Periosteum"],
                answer: 1,
                explanation: "The arrector pili muscle extends from the hair follicle to the <strong>papillary dermis</strong>. Its contraction causes 'goosebumps'."
            },
            {
                q: "Birbeck granules (tennis racquet shape) are the ultrastructural hallmark of:",
                options: ["Melanocytes", "Langerhans cells", "Merkel cells", "Keratinocytes"],
                answer: 1,
                explanation: "<strong>Langerhans cells</strong> contain unique rod-shaped organelles called Birbeck granules, which look like tennis racquets under EM."
            },
            {
                q: "In the skin, Type VII collagen is a major component of:",
                options: ["Anchoring fibrils", "Reticular fibers", "Elastic fibers", "Hemidesmosomes"],
                answer: 0,
                explanation: "<strong>Anchoring fibrils</strong>, composed of Type VII collagen, secure the basement membrane to the underlying dermal collagen fibrils."
            },
            {
                q: "Which junctional complex anchors the stratum basale keratinocytes to the underlying basement membrane?",
                options: ["Desmosomes", "Gap junctions", "Hemidesmosomes", "Tight junctions"],
                answer: 2,
                explanation: "<strong>Hemidesmosomes</strong> anchor the basal domain of epithelial cells to the basal lamina (basement membrane)."
            },
            {
                q: "Apocrine sweat glands are most abundant in the:",
                options: ["Palms and soles", "Forehead", "Axilla and groin", "Back"],
                answer: 2,
                explanation: "<strong>Apocrine sweat glands</strong> are restricted to specific areas like the axilla (armpit), areola, and anogenital region. They become functional at puberty."
            },
            {
                q: "The hypodermis (subcutaneous tissue) consists mainly of:",
                options: ["Dense irregular connective tissue", "Adipose tissue", "Stratified squamous epithelium", "Cartilage"],
                answer: 1,
                explanation: "The <strong>hypodermis</strong> is composed primarily of adipose tissue (fat) and loose connective tissue, providing insulation and energy storage."
            },
            {
                q: "Eleidin is a protein found in which layer of the epidermis?",
                options: ["Stratum spinosum", "Stratum lucidum", "Stratum granulosum", "Stratum basale"],
                answer: 1,
                explanation: "<strong>Eleidin</strong> is a clear, intracellular protein found in the Stratum lucidum (clear layer) of thick skin."
            },
            {
                q: "Which cells in the dermis are responsible for synthesizing collagen and elastin?",
                options: ["Macrophages", "Mast cells", "Fibroblasts", "Adipocytes"],
                answer: 2,
                explanation: "<strong>Fibroblasts</strong> are the principal cells of the dermis responsible for producing the extracellular matrix components, including collagen and elastin."
            },

            // NEURO HISTOLOGY (26-50)
            {
                q: "Which cell type produces the myelin sheath in the Central Nervous System (CNS)?",
                options: ["Schwann cell", "Oligodendrocyte", "Astrocyte", "Microglia"],
                answer: 1,
                explanation: "<strong>Oligodendrocytes</strong> form myelin in the CNS. One oligodendrocyte can myelinate segments of multiple axons."
            },
            {
                q: "Which cell type produces the myelin sheath in the Peripheral Nervous System (PNS)?",
                options: ["Schwann cell", "Oligodendrocyte", "Ependymal cell", "Satellite cell"],
                answer: 0,
                explanation: "<strong>Schwann cells</strong> (neurolemmocytes) form myelin in the PNS. One Schwann cell myelinates only one segment of a single axon."
            },
            {
                q: "Nissl bodies found in the neuronal cytoplasm correspond to which organelle?",
                options: ["Smooth Endoplasmic Reticulum", "Rough Endoplasmic Reticulum", "Golgi apparatus", "Mitochondria"],
                answer: 1,
                explanation: "<strong>Nissl bodies</strong> (chromophilic substance) are large aggregates of Rough Endoplasmic Reticulum (RER) and free ribosomes, indicating high protein synthesis."
            },
            {
                q: "Which glial cell is part of the Mononuclear Phagocyte System and functions as the immune cell of the CNS?",
                options: ["Astrocyte", "Ependymal cell", "Microglia", "Oligodendrocyte"],
                answer: 2,
                explanation: "<strong>Microglia</strong> are small, mesodermally-derived cells that function as phagocytes (macrophages) in the CNS."
            },
            {
                q: "The blood-brain barrier is formed primarily by endothelial tight junctions and the foot processes of:",
                options: ["Oligodendrocytes", "Astrocytes", "Microglia", "Ependymal cells"],
                answer: 1,
                explanation: "<strong>Astrocytes</strong> extend perivascular feet that cover capillary endothelial cells, inducing and maintaining the blood-brain barrier."
            },
            {
                q: "Which connective tissue layer wraps around a single nerve fiber (axon)?",
                options: ["Epineurium", "Perineurium", "Endoneurium", "Dura mater"],
                answer: 2,
                explanation: "The <strong>Endoneurium</strong> is the delicate loose connective tissue that surrounds individual nerve fibers (axons) and their myelin sheaths."
            },
            {
                q: "The gap between two adjacent Schwann cells where the axon is exposed is called:",
                options: ["Node of Ranvier", "Schmidt-Lanterman cleft", "Axon hillock", "Synaptic cleft"],
                answer: 0,
                explanation: "The <strong>Node of Ranvier</strong> is the gap in the myelin sheath between adjacent Schwann cells, essential for saltatory conduction."
            },
            {
                q: "Which neurons are most common in the body and possess multiple dendrites and a single axon?",
                options: ["Unipolar", "Bipolar", "Multipolar", "Pseudounipolar"],
                answer: 2,
                explanation: "<strong>Multipolar neurons</strong> (e.g., motor neurons, interneurons) have one axon and many dendrites. They are the most common type."
            },
            {
                q: "Pseudounipolar neurons are characteristically found in:",
                options: ["Cerebral cortex", "Dorsal root ganglia", "Retina", "Anterior horn of spinal cord"],
                answer: 1,
                explanation: "<strong>Pseudounipolar neurons</strong> (sensory neurons) are found in the dorsal root ganglia and cranial nerve sensory ganglia."
            },
            {
                q: "Ependymal cells lining the ventricles of the brain are classified as:",
                options: ["Simple squamous epithelium", "Cuboidal-to-columnar epithelium", "Stratified squamous epithelium", "Transitional epithelium"],
                answer: 1,
                explanation: "<strong>Ependymal cells</strong> form a simple cuboidal to low columnar epithelium (often ciliated) that lines the ventricles and central canal."
            },
            {
                q: "The perineurium acts as a diffusion barrier due to the presence of:",
                options: ["Tight junctions", "Desmosomes", "Gap junctions", "Hemidesmosomes"],
                answer: 0,
                explanation: "Cells of the <strong>perineurium</strong> (which wraps nerve fascicles) are joined by tight junctions, forming the blood-nerve barrier."
            },
            {
                q: "In the cerebellum, Purkinje cells are located between which two layers?",
                options: ["Molecular and Granular layers", "White matter and Granular layer", "Molecular and Pia mater", "Cortex and Medulla"],
                answer: 0,
                explanation: "The large, flask-shaped <strong>Purkinje cells</strong> form a distinct monolayer between the outer Molecular layer and the inner Granular layer of the cerebellar cortex."
            },
            {
                q: "Which structure typically lacks Nissl bodies?",
                options: ["Dendrite", "Soma", "Axon hillock", "Nucleolus"],
                answer: 2,
                explanation: "The <strong>Axon hillock</strong> and the axon itself lack Nissl bodies (RER), distinguishing them from the soma and dendrites."
            },
            {
                q: "Satellite cells are glial cells found in:",
                options: ["CNS white matter", "CNS gray matter", "PNS ganglia", "Choroid plexus"],
                answer: 2,
                explanation: "<strong>Satellite cells</strong> surround the cell bodies of neurons in PNS ganglia (both sensory and autonomic), providing structural and metabolic support."
            },
            {
                q: "White matter in the CNS appears white primarily due to:",
                options: ["Abundance of cell bodies", "High lipid content of myelin", "Large blood vessels", "Dense collagen fibers"],
                answer: 1,
                explanation: "<strong>White matter</strong> contains high concentrations of myelinated axons. Myelin is lipid-rich, which appears white in fresh tissue."
            },
            {
                q: "Pyramidal cells are the characteristic output neurons of the:",
                options: ["Cerebral cortex", "Cerebellar cortex", "Spinal cord", "Retina"],
                answer: 0,
                explanation: "<strong>Pyramidal cells</strong> are the primary excitatory neurons of the cerebral cortex."
            },
            {
                q: "Schmidt-Lanterman clefts are:",
                options: ["Gaps between Schwann cells", "Areas of cytoplasm retention within PNS myelin", "Synapses in the autonomic nervous system", "Breaks in the blood-brain barrier"],
                answer: 1,
                explanation: "<strong>Schmidt-Lanterman clefts</strong> are small pockets of cytoplasm left within the myelin layers of Schwann cells."
            },
            {
                q: "The dense irregular connective tissue wrapping an entire peripheral nerve is the:",
                options: ["Endoneurium", "Perineurium", "Epineurium", "Meninges"],
                answer: 2,
                explanation: "The <strong>Epineurium</strong> is the outermost layer of dense connective tissue that surrounds the entire nerve."
            },
            {
                q: "Which of the following is an example of a bipolar neuron?",
                options: ["Alpha motor neuron", "Dorsal root ganglion neuron", "Retinal ganglion cell", "Purkinje cell"],
                answer: 2,
                explanation: "<strong>Bipolar neurons</strong> are found in special sensory organs, such as the retina (bipolar cells), olfactory epithelium, and inner ear."
            },
            {
                q: "In a cross-section of the spinal cord, the butterfly-shaped central region consists of:",
                options: ["White matter", "Gray matter", "Dura mater", "Adipose tissue"],
                answer: 1,
                explanation: "The central H or butterfly shape in the spinal cord is <strong>Gray matter</strong>, containing neuronal cell bodies."
            },
            {
                q: "Chromatolysis describes the reaction of a neuron to injury, characterized by:",
                options: ["Cell shrinkage", "Dissolution of Nissl bodies", "Nuclear condensation", "Immediate apoptosis"],
                answer: 1,
                explanation: "<strong>Chromatolysis</strong> is the dispersion/dissolution of Nissl bodies and swelling of the cell body following axonal injury."
            },
            {
                q: "Which cytoskeletal component is most abundant in axons and crucial for structural support?",
                options: ["Actin filaments", "Neurofilaments", "Myosin", "Keratin"],
                answer: 1,
                explanation: "<strong>Neurofilaments</strong> (intermediate filaments of neurons) are abundant in axons and provide structural support and determine axon diameter."
            },
            {
                q: "The dorsal root ganglia contain the cell bodies of:",
                options: ["Somatic motor neurons", "Autonomic motor neurons", "Sensory neurons", "Interneurons"],
                answer: 2,
                explanation: "Dorsal root ganglia contain the cell bodies of <strong>sensory (afferent) neurons</strong>."
            },
            {
                q: "Anterograde axonal transport involves which motor protein?",
                options: ["Dynein", "Kinesin", "Myosin", "Actin"],
                answer: 1,
                explanation: "<strong>Kinesin</strong> moves cargo in the anterograde direction (away from soma), while Dynein moves cargo retrograde (toward soma)."
            },
            {
                q: "Which layer of the cerebellar cortex contains the granule cells?",
                options: ["Outer layer", "Middle layer", "Inner layer", "White matter"],
                answer: 2,
                explanation: "The <strong>Granular layer</strong> is the innermost layer of the cerebellar cortex, tightly packed with very small granule cells."
            }
        ];

        // --- App Logic ---
        let currentQIndex = 0;
        let userAnswers = new Array(questions.length).fill(null); // Stores index of selected option
        let timerSeconds = 0;

        // DOM Elements
        const questionListEl = document.getElementById("questionList");
        const questionTextEl = document.getElementById("questionText");
        const optionsContainerEl = document.getElementById("optionsContainer");
        const qHeaderEl = document.getElementById("q-header");
        const nextBtnEl = document.getElementById("nextBtn");
        const submitBtnEl = document.getElementById("submitBtn");
        const explanationBoxEl = document.getElementById("explanationBox");
        const explanationTextEl = document.getElementById("explanationText");
        const timerEl = document.getElementById("timer");

        // Initialize
        function init() {
            renderSidebar();
            loadQuestion(0);
            startTimer();
        }

        function startTimer() {
            setInterval(() => {
                timerSeconds++;
                const hrs = Math.floor(timerSeconds / 3600).toString().padStart(2, '0');
                const mins = Math.floor((timerSeconds % 3600) / 60).toString().padStart(2, '0');
                const secs = (timerSeconds % 60).toString().padStart(2, '0');
                timerEl.textContent = `${hrs}:${mins}:${secs}`;
            }, 1000);
        }

        function renderSidebar() {
            questionListEl.innerHTML = "";
            questions.forEach((q, index) => {
                const li = document.createElement("li");
                li.className = "q-item";
                li.id = `q-item-${index}`;
                li.onclick = () => loadQuestion(index);
                
                const spanNum = document.createElement("span");
                spanNum.textContent = `Q ${index + 1}`;
                
                const spanStatus = document.createElement("span");
                spanStatus.className = "status-indicator status-unanswered";
                spanStatus.id = `status-${index}`;

                li.appendChild(spanNum);
                li.appendChild(spanStatus);
                questionListEl.appendChild(li);
            });
        }

        function loadQuestion(index) {
            currentQIndex = index;
            
            // Sidebar active state
            document.querySelectorAll(".q-item").forEach(item => item.classList.remove("active"));
            document.getElementById(`q-item-${index}`).classList.add("active");

            // UI Text
            qHeaderEl.textContent = `Question ${index + 1} of ${questions.length}`;
            questionTextEl.innerHTML = questions[index].q;
            
            // Render Options
            optionsContainerEl.innerHTML = "";
            const isAnswered = userAnswers[index] !== null;

            questions[index].options.forEach((opt, i) => {
                const label = document.createElement("label");
                label.className = "option-label";
                
                const input = document.createElement("input");
                input.type = "radio";
                input.name = "option";
                input.className = "option-input";
                input.value = i;
                input.checked = (userAnswers[index] === i);
                input.disabled = isAnswered; // Disable if already answered

                // Styles for answered state
                if (isAnswered) {
                    if (i === questions[index].answer) {
                        label.classList.add("highlight-correct");
                    } else if (userAnswers[index] === i) {
                        label.classList.add("highlight-incorrect");
                    }
                }

                label.appendChild(input);
                label.appendChild(document.createTextNode(opt));
                optionsContainerEl.appendChild(label);
            });

            // Handle Buttons & Explanation
            if (isAnswered) {
                submitBtnEl.style.display = "none";
                nextBtnEl.style.display = "inline-block";
                explanationBoxEl.style.display = "block";
                explanationTextEl.innerHTML = questions[index].explanation;
            } else {
                submitBtnEl.style.display = "inline-block";
                nextBtnEl.style.display = "none";
                explanationBoxEl.style.display = "none";
            }
        }

        function submitAnswer() {
            const selected = document.querySelector('input[name="option"]:checked');
            if (!selected) return;

            const answerIndex = parseInt(selected.value);
            userAnswers[currentQIndex] = answerIndex;

            // Update Sidebar Status
            const statusEl = document.getElementById(`status-${currentQIndex}`);
            if (answerIndex === questions[currentQIndex].answer) {
                statusEl.classList.remove("status-unanswered");
                statusEl.classList.add("status-correct");
            } else {
                statusEl.classList.remove("status-unanswered");
                statusEl.classList.add("status-incorrect");
            }

            // Reload to show explanation/colors
            loadQuestion(currentQIndex);
        }

        function nextQuestion() {
            if (currentQIndex < questions.length - 1) {
                loadQuestion(currentQIndex + 1);
            }
        }

        init();

    </script>
</body>
</html>

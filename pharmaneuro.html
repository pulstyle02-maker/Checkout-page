<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharmacology Quiz - Neurosciences Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a0b2e; /* Deep Purple Background */
            color: #ffffff;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2d1b4e; 
        }
        ::-webkit-scrollbar-thumb {
            background: #fbbf24; 
            border-radius: 4px;
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .btn-glass:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: #fbbf24;
            transform: translateY(-2px);
        }

        .option-btn {
            transition: all 0.2s;
        }
        
        .option-btn.selected {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.1);
        }

        .correct-anim {
            background-color: #22c55e !important;
            border-color: #22c55e !important;
            color: white !important;
        }

        .wrong-anim {
            background-color: #ef4444 !important;
            border-color: #ef4444 !important;
            color: white !important;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="p-4 bg-opacity-90 backdrop-blur-md bg-[#2d1b4e] border-b border-yellow-500/30 sticky top-0 z-50 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <i class="fa-solid fa-brain text-yellow-400 text-2xl"></i>
                <h1 class="text-xl md:text-2xl font-bold tracking-wider text-white">
                    NEURO<span class="text-yellow-400">PHARMA</span>
                </h1>
            </div>
            <button onclick="goHome()" class="text-sm text-gray-300 hover:text-yellow-400 transition">
                <i class="fa-solid fa-house"></i> Home
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto p-4 md:p-6 flex flex-col items-center justify-center">
        
        <!-- Section Selection Screen -->
        <div id="section-menu" class="w-full max-w-4xl grid gap-6 fade-in">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-yellow-400 mb-2">Neurosciences Module (Katzung)</h2>
                <p class="text-gray-400">Select a Learning Objective to begin (25 MCQs each)</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Buttons generated by JS -->
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-container" class="w-full max-w-2xl hidden fade-in">
            <!-- Progress Header -->
            <div class="flex justify-between items-center mb-4 text-sm text-gray-400">
                <span id="progress-text">Question 1/25</span>
                <span id="score-badge" class="bg-yellow-500/20 text-yellow-400 px-3 py-1 rounded-full border border-yellow-500/30">
                    Score: 0
                </span>
            </div>
            
            <!-- Progress Bar -->
            <div class="w-full bg-gray-700 h-2 rounded-full mb-6 overflow-hidden">
                <div id="progress-bar" class="bg-gradient-to-r from-yellow-400 to-orange-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>

            <!-- Question Card -->
            <div class="bg-[#2d1b4e] border border-purple-500/30 rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden">
                <div class="absolute top-0 right-0 w-32 h-32 bg-yellow-500/10 rounded-full blur-3xl -mr-16 -mt-16"></div>
                
                <h3 id="question-text" class="text-xl md:text-2xl font-semibold mb-8 leading-relaxed text-gray-100">
                    Loading Question...
                </h3>

                <!-- Options -->
                <div id="options-container" class="grid gap-3">
                    <!-- Options injected here -->
                </div>

                <!-- Explanation Box -->
                <div id="explanation-box" class="mt-6 p-4 bg-blue-900/30 border border-blue-500/30 rounded-xl hidden">
                    <p class="text-blue-200 text-sm"><i class="fa-solid fa-circle-info mr-2"></i><span id="explanation-text"></span></p>
                </div>

                <!-- Next Button -->
                <button id="next-btn" onclick="nextQuestion()" class="mt-8 w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-3 px-6 rounded-xl shadow-lg transform transition hover:-translate-y-1 hidden">
                    Next Question <i class="fa-solid fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="w-full max-w-3xl hidden fade-in text-center">
            <div class="bg-[#2d1b4e] border border-yellow-500/30 rounded-3xl p-8 shadow-2xl">
                <div class="w-24 h-24 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-6 shadow-[0_0_20px_rgba(251,191,36,0.5)]">
                    <i class="fa-solid fa-trophy text-4xl text-black"></i>
                </div>
                
                <h2 class="text-3xl font-bold text-white mb-2">Module Completed!</h2>
                <p class="text-gray-400 mb-6">Here is how you performed</p>

                <div class="text-6xl font-bold text-yellow-400 mb-8" id="final-score">0%</div>

                <div class="flex flex-col md:flex-row gap-4 justify-center mb-8">
                    <button onclick="restartModule()" class="btn-glass text-white px-8 py-3 rounded-xl font-semibold hover:bg-white/10">
                        <i class="fa-solid fa-rotate-right mr-2"></i> Retry Module
                    </button>
                    <button onclick="goHome()" class="bg-yellow-400 text-black px-8 py-3 rounded-xl font-semibold hover:bg-yellow-500 transition">
                        <i class="fa-solid fa-list mr-2"></i> Main Menu
                    </button>
                </div>

                <!-- Wrong Answers Section -->
                <div id="review-section" class="text-left mt-8 border-t border-gray-700 pt-8 hidden">
                    <h3 class="text-xl font-bold text-red-400 mb-4"><i class="fa-solid fa-circle-exclamation mr-2"></i>Review Incorrect Answers</h3>
                    <div id="wrong-answers-list" class="space-y-4">
                        <!-- Wrong answers injected here -->
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="text-center p-6 text-gray-600 text-sm">
        <p>Pharmacology Neurosciences Module • Designed for Mobile</p>
    </footer>

    <script>
        // --- DATA: 50 MCQs for Neurosciences Module (Katzung) ---
        const questionBank = [
            // NS-Ph-001: Opioids: Receptors, Agonists & Antagonists (LO 1) - 25 MCQs
            {
                id: 1, section: "NS-Ph-001", question: "Which opioid receptor subtype is primarily responsible for mediating analgesia, respiratory depression, euphoria, and physical dependence?",
                options: ["Kappa ($\kappa$)", "Delta ($\delta$)", "Mu ($\mu$)", "Sigma ($\sigma$)"], answer: 2,
                explanation: "The Mu ($\mu$) opioid receptor is the most important receptor, mediating the classic therapeutic (analgesia) and severe adverse effects (respiratory depression, dependence) of strong agonists like morphine."
            },
            {
                id: 2, section: "NS-Ph-001", question: "Morphine produces its effect by acting as a strong agonist. The primary cellular mechanism involves coupling to which type of G-protein?",
                options: ["Gs (stimulatory)", "Gq (excitatory)", "Gi/o (inhibitory)", "G12/13"], answer: 2,
                explanation: "Opioid receptors are G-protein coupled receptors (GPCRs) that couple to the inhibitory $\\text{G}_{\\text{i/o}}$ protein, leading to inhibition of adenylyl cyclase and reduced neurotransmitter release."
            },
            {
                id: 3, section: "NS-Ph-001", question: "A patient develops miosis (pinpoint pupils) after receiving a high dose of Morphine. This effect is due to:",
                options: ["Direct effect on the iris muscles", "Blockade of adrenergic receptors", "Stimulation of the Edinger-Westphal nucleus", "Peripheral parasympathetic blockade"], answer: 2,
                explanation: "Opioids cause miosis by stimulating the $\\text{Edinger-Westphal}$ nucleus of the $\\text{oculomotor nerve}$ (CN III), increasing parasympathetic outflow to the pupil. Tolerance to miosis rarely develops."
            },
            {
                id: 4, section: "NS-Ph-001", question: "Which adverse effect of Morphine administration rarely shows tolerance, even with chronic high-dose use?",
                options: ["Sedation", "Nausea and vomiting", "Analgesia", "Miosis and Constipation"], answer: 3,
                explanation: "Tolerance rapidly develops to the euphoric, analgesic, and sedative effects. However, tolerance to miosis and opioid-induced constipation (OIC) develops slowly, if at all."
            },
            {
                id: 5, section: "NS-Ph-001", question: "Fentanyl is approximately 100 times more potent than Morphine. What is its primary clinical advantage over Morphine in anesthesia?",
                options: ["Lack of respiratory depression", "Extremely short half-life for rapid control", "Oral administration only", "Low potential for physical dependence"], answer: 1,
                explanation: "Fentanyl is highly lipophilic, allowing for rapid onset and offset, making it ideal for intravenous anesthesia and transdermal patches for chronic pain."
            },
            {
                id: 6, section: "NS-Ph-001", question: "Pentazocine is classified as a mixed agonist-antagonist. What is its mechanism of action?",
                options: ["$\\mu$ agonist, $\\kappa$ antagonist", "$\\mu$ antagonist, $\\kappa$ agonist", "Pure $\\mu$ agonist", "Pure $\\mu$ antagonist"], answer: 1,
                explanation: "Pentazocine acts as a $\\mu$-opioid receptor antagonist (or weak partial agonist) and a $\\kappa$-opioid receptor agonist. $\\kappa$-agonism contributes to analgesia but also dysphoria and psychotomimetic effects."
            },
            {
                id: 7, section: "NS-Ph-001", question: "A patient in the Emergency Department presents with acute respiratory depression following illicit drug use. Which pure opioid antagonist is the immediate drug of choice?",
                options: ["Naltrexone", "Buprenorphine", "Naloxone", "Methadone"], answer: 2,
                explanation: "Naloxone is the pure $\\mu$ antagonist used intravenously to rapidly reverse acute opioid toxicity and respiratory depression. Its short duration may require repeat doses."
            },
            {
                id: 8, section: "NS-Ph-001", question: "Opioid-induced constipation (OIC) is a common adverse effect, primarily resulting from:",
                options: ["Increased secretion of fluid into the gut lumen", "Blockade of central vagal tone", "Decreased propulsive peristalsis and increased sphincter tone", "Inhibition of pancreatic enzyme release"], answer: 2,
                explanation: "Opioid receptors in the GI tract (myenteric and submucosal plexuses) are stimulated, which decreases motility, increases smooth muscle tone (sphincters), and reduces fluid secretion."
            },
            {
                id: 9, section: "NS-Ph-001", question: "Which opioid drug is a prodrug that relies on the CYP2D6 enzyme for conversion into its active metabolite, Morphine?",
                options: ["Codeine", "Meperidine", "Tramadol", "Oxycodone"], answer: 0,
                explanation: "Codeine is metabolized to morphine (the active analgesic) by $\\text{CYP2D6}$. Patients who are ultra-rapid metabolizers can experience toxicity, while poor metabolizers get no pain relief."
            },
            {
                id: 10, section: "NS-Ph-001", question: "Loperamide is an opioid derivative used over-the-counter for diarrhea. Its therapeutic effect is due to:",
                options: ["Strong agonist activity in the CNS", "Selective blockade of $\\kappa$ receptors", "Poor penetration into the CNS", "Increased gastrointestinal fluid secretion"], answer: 2,
                explanation: "Loperamide is a $\\mu$ agonist that achieves high concentrations in the gut wall, but is actively pumped out of the CNS by $\\text{P-glycoprotein}$, minimizing central euphoric effects."
            },
            {
                id: 11, section: "NS-Ph-001", question: "A key feature distinguishing opioid antagonists used for maintenance treatment of addiction from those used for acute overdose is:",
                options: ["Route of administration (IV vs. IM)", "Duration of action (long vs. short)", "Potency at $\\delta$ receptors", "Ability to cross the blood-brain barrier"], answer: 1,
                explanation: "Naltrexone (maintenance) is long-acting (oral/IM) to prevent relapse, while Naloxone (overdose) is short-acting (IV/nasal) for rapid reversal."
            },
            {
                id: 12, section: "NS-Ph-001", question: "Chronic activation of opioid receptors leads to the upregulation of the $\\text{cAMP}$ pathway. Abrupt opioid cessation results in withdrawal symptoms due to:",
                options: ["Decreased neurotransmitter release", "Excessive $\\text{cAMP}$ activity and neuronal hyperexcitability", "Total receptor destruction", "Increased GABAergic tone"], answer: 1,
                explanation: "Opioids inhibit adenylyl cyclase (decreasing $\\text{cAMP}$). When the drug is removed, the upregulated $\\text{cAMP}$ system is hyperactive, causing withdrawal symptoms like agitation and tremors."
            },
            {
                id: 13, section: "NS-Ph-001", question: "Which strong opioid agonist is known for its toxic metabolite, $\\text{normeperidine}$, which can accumulate and cause seizures, especially in patients with renal failure?",
                options: ["Hydromorphone", "Meperidine (Pethidine)", "Sufentanil", "Remifentanil"], answer: 1,
                explanation: "Meperidine's metabolite, $\\text{normeperidine}$, is a $\\text{CNS}$ stimulant and can induce convulsions and neurotoxicity. Its use is largely restricted."
            },
            {
                id: 14, section: "NS-Ph-001", question: "Why is Methadone used in the maintenance treatment of opioid use disorder?",
                options: ["It is a pure antagonist with no dependence potential", "It has a long plasma half-life and milder withdrawal symptoms", "It blocks the rewarding effects of alcohol", "It is only active in the liver"], answer: 1,
                explanation: "Methadone is a long-acting $\\mu$ agonist that prevents withdrawal symptoms and blocks the euphoric effects of other opioids without the rapid highs and lows."
            },
            {
                id: 15, section: "NS-Ph-001", question: "Buprenorphine is a partial $\\mu$ agonist and $\\kappa$ antagonist. Its partial agonism provides a 'ceiling effect' for which critical side effect?",
                options: ["Itching", "Nausea", "Euphoria", "Respiratory depression"], answer: 3,
                explanation: "The partial agonism means that even at high doses, Buprenorphine's effect on respiratory depression plateaus, making it safer in overdose compared to full agonists."
            },
            {
                id: 16, section: "NS-Ph-001", question: "Opioids are generally contraindicated in patients with severe head injury because they:",
                options: ["Cause hyperthermia and dehydration", "Increase cerebral blood flow and intracranial pressure (ICP)", "Increase cerebral oxygen demand", "Induce cerebral vasoconstriction"], answer: 1,
                explanation: "Opioids cause respiratory depression, leading to $\\text{CO}_2$ retention. $\\text{CO}_2$ acts as a potent cerebral vasodilator, increasing blood flow and $\\text{ICP}$."
            },
            {
                id: 17, section: "NS-Ph-001", question: "Which drug is a peripherally acting $\\mu$-opioid receptor antagonist (PAMORA) specifically approved to treat opioid-induced constipation without crossing the $\\text{BBB}$?",
                options: ["Naloxone", "Naltrexone", "Methylnaltrexone", "Tramadol"], answer: 2,
                explanation: "Methylnaltrexone is quaternary (charged) and does not cross the $\\text{BBB}$, blocking GI-tract $\\mu$ receptors but sparing central analgesia."
            },
            {
                id: 18, section: "NS-Ph-001", question: "Activation of the $\\kappa$-opioid receptor subtype is commonly associated with which adverse effect?",
                options: ["Profound euphoria", "Nausea and vomiting", "Hallucinations and dysphoria", "Severe hypotension"], answer: 2,
                explanation: "Kappa receptor agonists (like Pentazocine) often induce dose-dependent dysphoria, unsettling feelings, and sometimes psychotomimetic effects."
            },
            {
                id: 19, section: "NS-Ph-001", question: "What is the primary mechanism of the antitussive action of Codeine and Dextromethorphan?",
                options: ["Bronchodilation", "Reducing pulmonary secretions", "Direct suppression of the cough center in the medulla", "Inhibition of prostaglandin synthesis in the airways"], answer: 2,
                explanation: "They act centrally to raise the threshold for the cough reflex."
            },
            {
                id: 20, section: "NS-Ph-001", question: "A major difference between Morphine and Tapentadol is that Tapentadol also has which additional mechanism of action?",
                options: ["$\\kappa$ receptor antagonism", "Serotonin-Norepinephrine Reuptake Inhibition (SNRI)", "NMDA receptor blockade", "$\\text{GABA}_{\\text{A}}$ potentiation"], answer: 1,
                explanation: "Tapentadol is a $\\mu$-opioid agonist AND a norepinephrine reuptake inhibitor (NRI), contributing to its analgesic effect."
            },
            {
                id: 21, section: "NS-Ph-001", question: "Which opioid agonist is primarily used for post-operative shivering (rigors) due to its activity on the thermoregulatory center?",
                options: ["Fentanyl", "Tramadol", "Meperidine", "Buprenorphine"], answer: 2,
                explanation: "Meperidine (Pethidine) is particularly effective in treating post-anesthesia or drug-induced shivering due to its unique central effects."
            },
            {
                id: 22, section: "NS-Ph-001", question: "Which clinical use is considered an exception to the general rule of avoiding opioids in acute trauma?",
                options: ["Chronic cancer pain", "Post-operative pain control", "Acute pulmonary edema (Morphine)", "General anesthesia induction"], answer: 2,
                explanation: "Morphine is used for acute pulmonary edema, especially if secondary to $\\text{MI}$, due to its ability to cause peripheral vasodilation and reduce the preload/afterload."
            },
            {
                id: 23, section: "NS-Ph-001", question: "Nalbuphine is a mixed agonist-antagonist that is associated with a lower risk of which side effect compared to pure $\\mu$ agonists?",
                options: ["Sedation", "Nausea", "Physical dependence and abuse potential", "Miosis"], answer: 2,
                explanation: "Due to its $\\mu$-antagonist activity, Nalbuphine has a lower abuse potential and ceiling for respiratory depression compared to Morphine."
            },
            {
                id: 24, section: "NS-Ph-001", question: "Tramadol produces analgesia primarily through $\\mu$ receptor agonism, but also via:",
                options: ["Selective COX-2 inhibition", "Dopamine release", "Inhibition of Norepinephrine and Serotonin reuptake", "Inhibition of $\\text{GABA}_{\\text{A}}$ receptors"], answer: 2,
                explanation: "Tramadol's dual mechanism (opioid + $\\text{SNRI}$ activity) differentiates it from pure opioids."
            },
            {
                id: 25, section: "NS-Ph-001", question: "High doses of Meperidine combined with MAO inhibitors can lead to which life-threatening syndrome?",
                options: ["Neuroleptic Malignant Syndrome", "Reye’s Syndrome", "Serotonin Syndrome", "Adrenal Crisis"], answer: 2,
                explanation: "Meperidine inhibits the neuronal uptake of serotonin. When combined with $\\text{MAO}$ inhibitors, excessive serotonin levels can lead to $\\text{Serotonin Syndrome}$ (hyperthermia, rigidity, mental status changes)."
            },

            // NS-Ph-002: CNS Stimulants & Depressants (LO 2) - 25 MCQs
            {
                id: 26, section: "NS-Ph-002", question: "Which characteristic of Barbiturates differentiates them from Benzodiazepines and contributes to their narrow therapeutic index?",
                options: ["They increase the frequency of $\\text{GABA}_{\\text{A}}$ channel opening", "They increase the duration of $\\text{GABA}_{\\text{A}}$ channel opening", "They act as pure $\\text{GABA}_{\\text{A}}$ antagonists", "They are selective $\\text{5-HT}_{\\text{1A}}$ partial agonists"], answer: 1,
                explanation: "Barbiturates increase the *duration* that the $\\text{GABA}_{\\text{A}}$ channel stays open, leading to greater $\\text{Cl}^{-}$ influx and higher risk of severe $\\text{CNS}$ depression and respiratory failure in overdose (independent of $\\text{GABA}$ levels)."
            },
            {
                id: 27, section: "NS-Ph-002", question: "Benzodiazepines exert their sedative-hypnotic effects by increasing the *frequency* of chloride channel opening. This enhancement requires the presence of which endogenous neurotransmitter?",
                options: ["Acetylcholine", "Glutamate", "GABA", "Dopamine"], answer: 2,
                explanation: "Benzodiazepines are $\\text{GABA}_{\\text{A}}$ positive allosteric modulators; they enhance $\\text{GABA}$'s effect but cannot fully activate the receptor themselves, making them safer than Barbiturates."
            },
            {
                id: 28, section: "NS-Ph-002", question: "Methylphenidate is a CNS stimulant used to treat ADHD. Its primary mechanism of action is:",
                options: ["Reversible $\\text{MAO}$ inhibition", "Direct $\\text{GABA}_{\\text{A}}$ agonism", "Blockade of dopamine and norepinephrine reuptake", "Selective $\\text{5-HT}_{\\text{2A}}$ agonism"], answer: 2,
                explanation: "Methylphenidate (Ritalin) blocks the reuptake transporters for dopamine and norepinephrine, increasing their concentrations in the synaptic cleft."
            },
            {
                id: 29, section: "NS-Ph-002", question: "Which Benzodiazepine is preferred for use in elderly patients or those with severe liver disease due to its metabolism only via glucuronidation (non-oxidative pathway)?",
                options: ["Diazepam", "Flurazepam", "Lorazepam", "Clonazepam"], answer: 2,
                explanation: "The 'LOT' drugs ($\\text{Lorazepam}$, $\\text{Oxazepam}$, $\\text{Temazepam}$) are preferred in hepatic impairment because they bypass $\\text{CYP450}$ oxidation."
            },
            {
                id: 30, section: "NS-Ph-002", question: "The primary mechanism of action for the intense, short-lived euphoric and stimulating effects of Cocaine is:",
                options: ["Inhibition of $\\text{NMDA}$ receptors", "Blockade of $\\text{Dopamine}$ reuptake transporters", "Selective release of $\\text{GABA}$", "Antagonism of $\\text{Adenosine}$ receptors"], answer: 1,
                explanation: "Cocaine potently blocks the reuptake of $\\text{Dopamine}$ (especially), Norepinephrine, and Serotonin, flooding the synapse and producing extreme euphoria."
            },
            {
                id: 31, section: "NS-Ph-002", question: "Flumazenil is used to reverse Benzodiazepine overdose. Its mechanism of action is:",
                options: ["Non-competitive $\\text{GABA}_{\\text{A}}$ agonism", "Competitive $\\text{GABA}_{\\text{A}}$ receptor antagonism", "Irreversible inhibition of $\\text{CYP450}$", "Blockade of $\\text{NMDA}$ receptors"], answer: 1,
                explanation: "Flumazenil is a selective competitive antagonist at the $\\text{BZD}$ binding site on the $\\text{GABA}_{\\text{A}}$ receptor complex."
            },
            {
                id: 32, section: "NS-Ph-002", question: "Abrupt withdrawal from chronic high-dose Benzodiazepine therapy can be dangerous and may precipitate which serious symptom?",
                options: ["Profuse diarrhea", "Severe seizures", "Psychotic depression", "Respiratory depression"], answer: 1,
                explanation: "Chronic $\\text{GABA}_{\\text{A}}$ potentiation causes receptor adaptation. Abrupt removal leads to a dramatic drop in inhibitory tone, resulting in rebound anxiety, insomnia, and potentially life-threatening seizures."
            },
            {
                id: 33, section: "NS-Ph-002", question: "Which short-acting barbiturate is highly lipophilic, allowing it to rapidly cross the $\\text{BBB}$ and be used primarily for the induction of general anesthesia?",
                options: ["Phenobarbital", "Amobarbital", "Thiopental", "Secobarbital"], answer: 2,
                explanation: "Thiopental's high lipid solubility causes rapid onset (seconds) and short duration of action due to rapid redistribution out of the brain."
            },
            {
                id: 34, section: "NS-Ph-002", question: "Zolpidem (Ambien) is a non-Benzodiazepine hypnotic (Z-drug). Its selectivity is based on:",
                options: ["Specific antagonism of the $\\beta_2$ subunit", "Selective binding to the $\\text{GABA}_{\\text{A}}$ $\\alpha_1$ subunit", "Selective $\\text{H}_1$ blockade", "Inhibition of $\\text{adenosine}$ reuptake"], answer: 1,
                explanation: "Z-drugs target the $\\alpha_1$ subunit of the $\\text{GABA}_{\\text{A}}$ receptor, which is associated with sedation, leading to fewer anxiolytic or anticonvulsant effects than standard $\\text{BZDs}$."
            },
            {
                id: 35, section: "NS-Ph-002", question: "The primary mechanism of action responsible for the stimulating effects of Caffeine is:",
                options: ["Release of $\\text{NE}$ from synaptic vesicles", "Antagonism of central $\\text{Adenosine}$ receptors", "Direct $\\text{NMDA}$ agonism", "Inhibition of $\\text{GABA}$ synthesis"], answer: 1,
                explanation: "Caffeine is a competitive antagonist of $\\text{adenosine}$ receptors ($\\text{A}_1$ and $\\text{A}_{\\text{2A}}$). Adenosine is an inhibitory neuromodulator, so blocking it leads to $\\text{CNS}$ excitation."
            },
            {
                id: 36, section: "NS-Ph-002", question: "Which CNS stimulant is often associated with the adverse effects of 'formication' (sensation of insects crawling under the skin) and severe paranoia?",
                options: ["Nicotine", "Caffeine", "Amphetamines/Cocaine", "Modafinil"], answer: 2,
                explanation: "The severe paranoia and tactile hallucinations (e.g., 'cocaine bugs' or 'snow bugs') are characteristic of high-dose cocaine or amphetamine intoxication."
            },
            {
                id: 37, section: "NS-Ph-002", question: "Barbiturates induce hepatic $\\text{CYP450}$ enzymes. This action leads to which clinical consequence?",
                options: ["Decreased metabolism and increased half-life of other drugs", "Increased synthesis of endogenous steroids", "Increased metabolism and decreased efficacy of co-administered drugs", "Reduced absorption of nutrients"], answer: 2,
                explanation: "Enzyme induction speeds up the metabolism of many drugs (e.g., warfarin, oral contraceptives), requiring dose adjustments."
            },
            {
                id: 38, section: "NS-Ph-002", question: "Buspirone is an anxiolytic used for generalized anxiety disorder ($\text{GAD}$). Unlike $\\text{BZDs}$, it lacks which of the following properties?",
                options: ["Anxiolytic activity", "Tolerance development", "Hypnotic, anticonvulsant, and muscle relaxant activity", "Oral bioavailability"], answer: 2,
                explanation: "Buspirone's mechanism ($\\text{5-HT}_{\\text{1A}}$ partial agonism) provides anxiolysis without the sedative, hypnotic, $\\text{GABA}_{\\text{A}}$-mediated effects, and lower abuse potential."
            },
            {
                id: 39, section: "NS-Ph-002", question: "The CNS depressant effect of Ethanol (alcohol) is due to its ability to:",
                options: ["Increase dopamine release and block $\\text{GABA}_{\\text{A}}$", "Potentiate $\\text{GABA}_{\\text{A}}$ activity and inhibit $\\text{NMDA}$ glutamate receptors", "Inhibit $\\text{COX-1}$ in the brain", "Block voltage-gated $\\text{Na}^{+}$ channels"], answer: 1,
                explanation: "Ethanol acts as an allosteric modulator on $\\text{GABA}_{\\text{A}}$ and is a non-competitive antagonist at $\\text{NMDA}$ receptors, creating profound $\\text{CNS}$ depression."
            },
            {
                id: 40, section: "NS-Ph-002", question: "Which agent is a non-amphetamine stimulant used specifically for the treatment of narcolepsy and shift work sleep disorder?",
                options: ["Phentermine", "Lisdexamfetamine", "Modafinil", "MDMA"], answer: 2,
                explanation: "Modafinil promotes wakefulness through mechanisms that are not fully understood, but include inhibiting $\\text{Dopamine}$ reuptake and increasing histamine and orexin signaling."
            },
            {
                id: 41, section: "NS-Ph-002", question: "Phenobarbital, a long-acting barbiturate, is still clinically useful primarily as an:",
                options: ["Acute muscle relaxant", "Anticonvulsant for certain seizure types", "Anesthetic induction agent", "Antihypertensive"], answer: 1,
                explanation: "Phenobarbital's long half-life makes it useful for maintenance anticonvulsant therapy (e.g., in generalized tonic-clonic seizures)."
            },
            {
                id: 42, section: "NS-Ph-002", question: "Which effect is *most* likely to occur with typical therapeutic doses of a first-generation Benzodiazepine like Diazepam?",
                options: ["Psychosis", "Anxiolysis and sedation", "Severe vomiting", "Urinary retention"], answer: 1,
                explanation: "The primary effects are reduction of anxiety and calming/drowsiness."
            },
            {
                id: 43, section: "NS-Ph-002", question: "In the treatment of tonic-clonic status epilepticus, which ultra-short acting Benzodiazepine is typically administered intravenously?",
                options: ["Flumazenil", "Midazolam (or Lorazepam)", "Buspirone", "Zolpidem"], answer: 1,
                explanation: "Midazolam (or Lorazepam) is commonly used to terminate status epilepticus due to rapid $\\text{CNS}$ penetration and potent anticonvulsant effects."
            },
            {
                id: 44, section: "NS-Ph-002", question: "Which $\\text{CNS}$ depressant is structurally related to $\\text{GABA}$ and acts as a $\\text{GABA}_{\\text{B}}$ receptor agonist to treat spasticity?",
                options: ["Diazepam", "Chloral Hydrate", "Baclofen", "Zolpidem"], answer: 2,
                explanation: "Baclofen is an analog of $\\text{GABA}$ that selectively activates $\\text{GABA}_{\\text{B}}$ receptors, inhibiting presynaptic release of excitatory neurotransmitters in the spinal cord."
            },
            {
                id: 45, section: "NS-Ph-002", question: "In contrast to Amphetamines, Atomoxetine (Strattera) treats $\\text{ADHD}$ primarily by:",
                options: ["Potentiating $\\text{GABA}$ effects", "Selective norepinephrine reuptake inhibition (SNRI)", "Selective dopamine reuptake inhibition", "Direct $\\text{MAO-B}$ inhibition"], answer: 1,
                explanation: "Atomoxetine is a non-stimulant selective norepinephrine reuptake inhibitor, lacking the immediate abuse potential of $\\text{dopamine}$-releasing agents."
            },
            {
                id: 46, section: "NS-Ph-002", question: "The $\\text{Z-drugs}$ (Zolpidem, Zaleplon) are used specifically for insomnia, but chronic use can lead to which unique adverse effect?",
                options: ["Severe $\\text{OIC}$", "Daytime somnolence and retrograde amnesia", "Gastrointestinal bleeding", "Hepatic enzyme induction"], answer: 1,
                explanation: "These drugs can impair memory consolidation (amnesia) and cause residual sleepiness the next day."
            },
            {
                id: 47, section: "NS-Ph-002", question: "Which of the following is a key characteristic of the pharmacological effects of $\\text{MDMA}$ (Ecstasy)?",
                options: ["Selective dopamine blockade", "Massive release of Serotonin and Dopamine", "Pure $\\text{NMDA}$ antagonism", "Selective $\\text{ACh}$ release"], answer: 1,
                explanation: "MDMA is a serotonergic neurotoxin that causes reverse transport (release) of Serotonin, Dopamine, and Norepinephrine, leading to its powerful empathogenic and stimulating effects."
            },
            {
                id: 48, section: "NS-Ph-002", question: "A primary danger of mixing Ethanol (alcohol) with Barbiturates or Benzodiazepines is the risk of:",
                options: ["Hyperactivity and mania", "Hypotension", "Profound synergistic $\\text{CNS}$ and respiratory depression", "Serotonin syndrome"], answer: 2,
                explanation: "Alcohol also potentiates $\\text{GABA}_{\\text{A}}$, leading to a dangerous synergistic effect with other $\\text{GABA}$-enhancing drugs."
            },
            {
                id: 49, section: "NS-Ph-002", question: "Which classification of drug has a primary clinical use in treating obesity by suppressing appetite due to its mild $\\text{CNS}$ stimulant properties?",
                options: ["Phentermine (or Diethylpropion)", "Diazepam", "Phenobarbital", "Modafinil"], answer: 0,
                explanation: "Phentermine is an anorexiant (appetite suppressant) with a mechanism similar to amphetamines, increasing $\\text{NE}$ and $\\text{DA}$."
            },
            {
                id: 50, section: "NS-Ph-002", question: "A patient suffering from chronic insomnia is prescribed a long-acting $\\text{BZD}$ like Flurazepam. The risk of residual daytime sedation (hangover) is due to:",
                options: ["Rapid excretion", "Conversion to highly active, long-lived metabolites", "Selective $\\alpha_1$ agonism", "Hepatic enzyme induction"], answer: 1,
                explanation: "Flurazepam is metabolized into a major, active metabolite with a very long half-life (up to 100 hours), causing accumulation and persistent effects."
            }
        ];

        // --- STATE MANAGEMENT ---
        let currentSectionQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let wrongAnswers = [];

        // --- DOM ELEMENTS ---
        const sectionMenu = document.getElementById('section-menu');
        const quizContainer = document.getElementById('quiz-container');
        const resultScreen = document.getElementById('result-screen');
        
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const scoreBadge = document.getElementById('score-badge');
        const explanationBox = document.getElementById('explanation-box');
        const explanationText = document.getElementById('explanation-text');
        const nextBtn = document.getElementById('next-btn');
        const finalScoreDisplay = document.getElementById('final-score');
        const reviewSection = document.getElementById('review-section');
        const wrongAnswersList = document.getElementById('wrong-answers-list');

        // --- INITIALIZATION ---
        function init() {
            const sections = [
                { id: "NS-Ph-001", title: "LO 1: Opioids (Agonists, Mixed & Antagonists)", desc: "25 MCQs on Receptors, MOA, Uses, and A/Es" },
                { id: "NS-Ph-002", title: "LO 2: CNS Stimulants & Depressants", desc: "25 MCQs on Barbiturates, BZDs, Z-Drugs, and Stimulants" }
            ];

            const container = sectionMenu.querySelector('.grid');
            container.innerHTML = '';

            sections.forEach(sec => {
                const btn = document.createElement('button');
                btn.className = "bg-[#2d1b4e] border border-purple-500/30 hover:border-yellow-400 p-6 rounded-2xl text-left transition-all hover:bg-purple-900/50 group shadow-lg";
                btn.onclick = () => startQuiz(sec.id);
                btn.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <span class="bg-yellow-400/10 text-yellow-400 text-xs px-2 py-1 rounded uppercase tracking-wide">${sec.id}</span>
                        <i class="fa-solid fa-chevron-right text-gray-500 group-hover:text-yellow-400 transition"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-1 group-hover:text-yellow-300 transition">${sec.title}</h3>
                    <p class="text-sm text-gray-400">${sec.desc}</p>
                `;
                container.appendChild(btn);
            });
        }

        // --- QUIZ LOGIC ---
        function startQuiz(sectionId) {
            currentSectionQuestions = questionBank.filter(q => q.section === sectionId);
            currentQuestionIndex = 0;
            score = 0;
            wrongAnswers = [];
            
            sectionMenu.classList.add('hidden');
            resultScreen.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            
            // Adjust progress text for the new total
            progressText.innerText = `Question 1/${currentSectionQuestions.length}`;
            
            renderQuestion();
        }

        function renderQuestion() {
            const q = currentSectionQuestions[currentQuestionIndex];
            
            // Update UI
            questionText.innerText = `${currentQuestionIndex + 1}. ${q.question}`;
            progressText.innerText = `Question ${currentQuestionIndex + 1}/${currentSectionQuestions.length}`;
            scoreBadge.innerText = `Score: ${score}`;
            progressBar.style.width = `${((currentQuestionIndex) / currentSectionQuestions.length) * 100}%`;
            
            // Reset State
            optionsContainer.innerHTML = '';
            explanationBox.classList.add('hidden');
            nextBtn.classList.add('hidden');

            // Create Options
            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = "option-btn w-full text-left p-4 rounded-xl border border-gray-600 bg-gray-800/50 hover:bg-gray-700 text-gray-200 font-medium relative";
                btn.innerHTML = `<span class="inline-block w-6 h-6 rounded-full bg-gray-700 text-center text-xs leading-6 mr-3 border border-gray-600">${String.fromCharCode(65 + index)}</span> ${opt}`;
                btn.onclick = () => checkAnswer(index, btn);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selectedIndex, btnElement) {
            // Disable all buttons
            const buttons = optionsContainer.querySelectorAll('button');
            buttons.forEach(b => b.disabled = true);

            const q = currentSectionQuestions[currentQuestionIndex];
            const isCorrect = selectedIndex === q.answer;

            if (isCorrect) {
                score++;
                btnElement.classList.add('correct-anim');
                btnElement.querySelector('span').classList.replace('bg-gray-700', 'bg-green-600');
                scoreBadge.innerText = `Score: ${score}`;
            } else {
                btnElement.classList.add('wrong-anim');
                btnElement.querySelector('span').classList.replace('bg-gray-700', 'bg-red-600');
                
                // Highlight correct answer
                buttons[q.answer].classList.add('correct-anim');
                buttons[q.answer].querySelector('span').classList.replace('bg-gray-700', 'bg-green-600');
                
                wrongAnswers.push({
                    question: q.question,
                    yourAnswer: q.options[selectedIndex],
                    correctAnswer: q.options[q.answer],
                    explanation: q.explanation
                });
            }

            // Show Explanation
            explanationText.innerHTML = `<strong>${isCorrect ? "Correct!" : "Incorrect."}</strong> ${q.explanation}`;
            explanationBox.classList.remove('hidden');
            
            // Show Next Button
            nextBtn.classList.remove('hidden');
            
            // Update Progress Bar
            progressBar.style.width = `${((currentQuestionIndex + 1) / currentSectionQuestions.length) * 100}%`;
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentSectionQuestions.length) {
                renderQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            quizContainer.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            
            const percentage = Math.round((score / currentSectionQuestions.length) * 100);
            finalScoreDisplay.innerText = `${percentage}%`;
            finalScoreDisplay.className = `text-6xl font-bold mb-8 ${percentage >= 70 ? 'text-green-400' : 'text-red-400'}`;

            // Render Wrong Answers
            if (wrongAnswers.length > 0) {
                reviewSection.classList.remove('hidden');
                wrongAnswersList.innerHTML = '';
                wrongAnswers.forEach(item => {
                    const div = document.createElement('div');
                    div.className = "bg-gray-800/50 p-4 rounded-xl border border-red-500/20";
                    div.innerHTML = `
                        <p class="text-white font-semibold mb-2 text-sm md:text-base">${item.question}</p>
                        <div class="text-xs md:text-sm grid gap-1">
                            <p class="text-red-400"><i class="fa-solid fa-xmark mr-2"></i>Your Answer: ${item.yourAnswer}</p>
                            <p class="text-green-400"><i class="fa-solid fa-check mr-2"></i>Correct Answer: ${item.correctAnswer}</p>
                            <p class="text-blue-300 mt-2 italic border-t border-gray-700 pt-2"><i class="fa-solid fa-lightbulb mr-1"></i> ${item.explanation}</p>
                        </div>
                    `;
                    wrongAnswersList.appendChild(div);
                });
            } else {
                reviewSection.classList.add('hidden');
            }
        }

        function restartModule() {
            // Identify current section ID by checking the first question of the last set
            // The section ID is stored in the first question of the current set
            const currentSecID = currentSectionQuestions[0].section;
            startQuiz(currentSecID);
        }

        function goHome() {
            quizContainer.classList.add('hidden');
            resultScreen.classList.add('hidden');
            sectionMenu.classList.remove('hidden');
        }

        // Run
        init();

    </script>
</body>
</html>


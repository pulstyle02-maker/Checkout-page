<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ModMedicalis | Let the visuals speak</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLMDJd/r7oQ9tTdsLqB81lE1K8j/bNq0lR7a/m4N1zJ3I7Z5n7W2vP0yQ5G7gNl1g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Import Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@700;800;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Lilita+One&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap'); /* Added Roboto */

        /* Custom font definitions for Main Site */
        .algerya-sans-sc-font { font-family: 'Saira Condensed', sans-serif; font-weight: 900; letter-spacing: -0.03em; text-transform: uppercase; }
        
        body { font-family: 'Lexend', sans-serif; background-color: #f8fafc; color: #1e293b; transition: background-color 0.3s, color 0.3s; overflow-x: hidden; width: 100%; }

        /* --- EXISTING SITE STYLES --- */
        .red-curved-section { background-color: #ef4444; border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; position: relative; overflow: hidden; z-index: 1; }
        @media (min-width: 640px) { .red-curved-section { border-bottom-left-radius: 50px; border-bottom-right-radius: 50px; } }
        .medical-pattern-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; opacity: 0.05; }
        .avail-btn { background-color: #1e293b; color: white; padding: 0.75rem 2rem; font-weight: 700; border-radius: 1.5rem; transition: background-color 0.3s, transform 0.2s; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); font-size: 0.875rem; }
        @media (min-width: 640px) { .avail-btn { padding: 1rem 2.5rem; font-size: 1rem; } }
        .avail-btn:hover { background-color: #334155; transform: translateY(-2px); }
        .filter-text-button { position: relative; cursor: pointer; padding: 0.5rem 0.75rem; font-weight: 700; transition: color 0.3s ease; padding-bottom: 0.5rem; font-size: 0.875rem; }
        @media (min-width: 640px) { .filter-text-button { padding: 0.5rem 1rem; padding-bottom: 0.75rem; font-size: 1rem; } }
        .filter-text-button::after { content: ''; position: absolute; left: 50%; bottom: 0; height: 3px; width: 0; background-color: #3b82f6; transition: width 0.3s ease, transform 0.3s ease; transform: translateX(-50%); }
        .filter-text-button.active { color: #3b82f6; }
        #filter-buttons-container .filter-text-button.active::after { background-color: #3b82f6 !important; }
        .filter-text-button.active::after { width: 100%; }
        .review-box-design { background-color: white; border: 1px solid #e5e7eb; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); border-radius: 1rem; position: relative; overflow: hidden; transition: all 0.3s ease; height: 100%; }
        .review-box-design::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background-color: #1A5693; transform: scaleX(0); transform-origin: left; transition: transform 0.3s ease; }
        .review-box-design:hover::before { transform: scaleX(1); }
        .product-popup-image-container { width: 100%; padding-top: 140%; position: relative; overflow: hidden; background-color: #f3f4f6; }
        .product-popup-image-container img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain; }
        .glass-card { background-color: #F8F8F8; box-shadow: 0 8px 16px rgba(0, 0, 0, 0.05); transition: all 0.3s ease; position: relative; border: 1px solid #f3f4f6; }
        .horizontal-scroll-container { display: flex; overflow-x: scroll; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; padding-bottom: 1rem; }
        .horizontal-scroll-container::-webkit-scrollbar { display: none; }
        .horizontal-scroll-container { -ms-overflow-style: none; scrollbar-width: none; }
        .product-image-box { background-color: #e5e7eb; position: relative; width: 100%; aspect-ratio: 4/5; margin-bottom: 0.5rem; cursor: pointer; }
        .product-image-box img { object-fit: contain; width: 100%; height: 100%; }
        .product-card-title { font-size: 0.9rem; line-height: 1.0; font-weight: 900; text-transform: uppercase; cursor: pointer; font-family: 'Saira Condensed', sans-serif; letter-spacing: -0.03em; }
        @media (min-width: 640px) { .product-card-title { font-size: 1.1rem; } }
        .product-price-main { color: #ef4444; font-size: 1.1rem; font-weight: 900; }
        @media (min-width: 640px) { .product-price-main { font-size: 1.25rem; } }
        .product-price-cut { color: #9ca3af; text-decoration: line-through; font-size: 0.75rem; }
        .add-to-cart-btn { width: 1.75rem; height: 1.75rem; font-size: 1rem; background-color: #1e293b; color: white; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); position: absolute; bottom: 0.5rem; right: 0.5rem; }
        @media (min-width: 640px) { .add-to-cart-btn { width: 2rem; height: 2rem; font-size: 1.25rem; bottom: 0.75rem; right: 0.75rem; } }
        .cart-item-card { background-color: #fff; border: 1px solid #e5e7eb; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); }
        .tilted-overlap-image { position: absolute; top: -1.5rem; right: 0.25rem; width: 80px; height: 80px; z-index: 20; transform: rotate(10deg); object-fit: contain; pointer-events: none; }
        @media (min-width: 640px) { .tilted-overlap-image { top: -2.5rem; right: 0.5rem; width: 120px; height: 120px; } }
        
        /* Tab Styles */
        .hero-tab-card { background: white; border: 2px solid transparent; border-radius: 12px; padding: 0.75rem; display: flex; align-items: center; gap: 0.75rem; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03); position: relative; overflow: hidden; }
        @media (min-width: 640px) { .hero-tab-card { padding: 1rem; gap: 1rem; } }
        .hero-tab-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .hero-tab-card.active-custom-red { border-color: #F94A4A; background-color: #fff1f2; }
        .hero-tab-card.active-custom-red .tab-icon-box { background-color: #F94A4A; color: white; }
        .hero-tab-card.active-custom-red span { color: #F94A4A; }
        .hero-tab-card.active-blue { border-color: #3b82f6; background-color: #eff6ff; }
        .hero-tab-card.active-pink { border-color: #ec4899; background-color: #fdf2f8; }
        .tab-icon-box { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; transition: all 0.3s ease; flex-shrink: 0; }
        @media (min-width: 640px) { .tab-icon-box { width: 48px; height: 48px; font-size: 1.25rem; } }
        .tab-panel { display: none; }
        .tab-panel.active { display: flex; }
        
        /* Animations */
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        .animate-fade-right { animation: fadeInRight 0.5s ease-out forwards; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .product-slide-up { animation: slideUp 0.4s ease-out forwards; }
        .reveal-on-scroll { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        .reveal-on-scroll.is-visible { opacity: 1; transform: translateY(0); }

        /* ================================================= */
        /* SHOPIFY STYLE CHECKOUT CSS (Mobile Optimized)    */
        /* ================================================= */
        #checkout-page {
            /* FIXED FONT: Roboto or System Fonts */
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: #ffffff;
            min-height: 100vh;
            color: #333;
            /* FIXED LAYOUT ISSUE */
            width: 100%;
            overflow-x: hidden;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 100;
        }

        /* Layout Container */
        .shopify-layout {
            display: flex;
            flex-direction: row;
            height: 100%;
            max-width: 1200px;
            margin: 0 auto;
            /* Prevent horizontal overflow */
            width: 100%;
            overflow-x: hidden;
        }

        /* LEFT SIDE: Form */
        .shopify-main {
            width: 58%;
            padding: 3rem 4% 2rem 0;
            border-right: 1px solid #e1e1e1;
        }

        /* RIGHT SIDE: Summary */
        .shopify-sidebar {
            width: 42%;
            background-color: #fafafa;
            padding: 3rem 0 2rem 4%;
            min-height: 100vh;
            border-left: 1px solid #e1e1e1;
            margin-left: -1px; /* Overlap borders */
        }

        /* HEADER */
        .checkout-header-logo { margin-bottom: 1.5rem; }

        /* BREADCRUMBS */
        .shopify-breadcrumbs {
            display: flex;
            align-items: center;
            font-size: 0.85rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .shopify-breadcrumbs .step {
            display: inline-flex;
            align-items: center;
            color: #707070;
            font-weight: 500;
        }
        .shopify-breadcrumbs .step.active { color: #000; font-weight: 700; }
        .shopify-breadcrumbs .step.completed { color: #1A5693; cursor: pointer; }
        .shopify-breadcrumbs .step::after {
            content: '>';
            margin: 0 0.5rem;
            color: #707070;
            font-size: 0.8em;
        }
        .shopify-breadcrumbs .step:last-child::after { display: none; }
        
        .step-circle, .progress-bar-container { display: none !important; }
        .step-label { font-size: inherit; color: inherit; font-weight: inherit; }

        /* INPUT FIELDS (Shopify Style) */
        .shopify-input-group { margin-bottom: 0.85rem; }
        .shopify-input-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: #333;
            margin-bottom: 0.35rem;
        }
        .modern-input {
            width: 100%;
            padding: 0.9rem; /* Larger touch area */
            border: 1px solid #d9d9d9;
            border-radius: 5px;
            font-size: 16px; /* Prevents zoom on iOS */
            color: #333;
            transition: all 0.2s ease-in-out;
            background: white;
            box-shadow: 0 1px 0 rgba(0,0,0,0.05);
            font-family: inherit; /* Inherit Roboto */
        }
        .modern-input:focus {
            border-color: #1A5693;
            box-shadow: 0 0 0 1px #1A5693;
            outline: none;
        }
        .modern-input::placeholder { color: #737373; }
        
        select.modern-input {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.8rem center;
            background-repeat: no-repeat;
            background-size: 1.2em 1.2em;
            -webkit-appearance: none;
            padding-right: 2.5rem;
        }

        /* BUTTONS */
        .shopify-btn-primary {
            background-color: #1A5693;
            color: white;
            padding: 1.25rem 1.5rem;
            border-radius: 5px;
            font-weight: 600;
            font-size: 1rem;
            width: 100%;
            text-align: center;
            transition: background-color 0.2s;
            margin-top: 1.5rem;
            cursor: pointer;
            font-family: inherit;
        }
        .shopify-btn-primary:hover { background-color: #144374; }
        .shopify-btn-secondary {
            color: #1A5693;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
            margin-top: 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
            font-family: inherit;
        }

        .checkout-navigation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-direction: row-reverse;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #e1e1e1;
        }

        /* SUMMARY / SIDEBAR STYLES */
        .sidebar-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        .sidebar-label { color: #555; font-size: 0.9rem; }
        .sidebar-value { font-weight: 600; color: #333; font-size: 0.9rem; }
        .sidebar-total {
            border-top: 1px solid #e1e1e1;
            padding-top: 1.25rem;
            margin-top: 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .sidebar-total-label { font-size: 1.1rem; color: #333; }
        .sidebar-total-value { font-size: 1.4rem; font-weight: 700; color: #333; }
        .sidebar-total-currency { font-size: 0.75rem; color: #737373; margin-right: 4px; }

        .checkout-step { display: none; }
        .checkout-step.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }

        /* MOBILE SPECIFIC OVERRIDES */
        @media (max-width: 1023px) {
            .shopify-layout { flex-direction: column; }
            
            .shopify-main {
                width: 100%;
                padding: 1.5rem 1rem;
                border-right: none;
                order: 2;
                box-sizing: border-box; /* Ensure padding doesn't cause overflow */
            }

            .shopify-sidebar {
                display: none;
            }

            /* Mobile Header with Logo */
            .mobile-header {
                padding: 1rem;
                display: flex;
                justify-content: center;
                background: white;
                border-bottom: 1px solid #e1e1e1;
                width: 100%;
            }

            /* Mobile Summary Accordion */
            .mobile-summary-accordion {
                display: block;
                background: #fafafa;
                border-bottom: 1px solid #e1e1e1;
                border-top: 1px solid #e1e1e1;
                width: 100%;
            }
            .mobile-summary-accordion summary {
                list-style: none;
                padding: 1rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
                cursor: pointer;
                color: #1A5693;
                font-size: 0.9rem;
                font-weight: 500;
            }
            .mobile-summary-accordion summary::-webkit-details-marker { display: none; }
            .mobile-summary-accordion summary::after {
                content: '▼';
                font-size: 0.7rem;
                margin-left: 0.5rem;
                transition: transform 0.2s;
            }
            .mobile-summary-accordion[open] summary::after { transform: rotate(180deg); }
            
            .mobile-summary-content {
                padding: 0 1rem 1.5rem 1rem;
                border-top: 1px solid #e6e6e6;
            }
            
            .checkout-header-logo { display: none; }
            
            .shopify-btn-primary { width: 100%; padding: 1.1rem; }
            
            .checkout-navigation {
                flex-direction: column-reverse;
                gap: 1rem;
                align-items: stretch;
            }
            .shopify-btn-secondary { text-align: center; margin-top: 0.5rem; }
        }

        @media (min-width: 1024px) {
            .mobile-header { display: none; }
            .mobile-summary-accordion { display: none; }
        }

    </style>
</head>
<body class="min-h-screen antialiased">
    <!-- Top Notification Strip -->
    <div class="bg-[#F94A4A] h-1.5 sm:h-2 sticky top-0 z-50"></div>

    <!-- Header (Logo Centered) -->
    <header class="bg-white border-b border-gray-100 sticky top-1.5 sm:top-2 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
            <div class="flex justify-between items-center h-14 sm:h-16">
                <!-- Left Side: Mobile Menu & Desktop Search -->
                <div class="flex items-center">
                    <button id="mobile-menu-button" class="md:hidden text-gray-600 hover:text-[#1A5693] mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12"y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
                    </button>
                    <div class="hidden md:block relative">
                        <input type="text" id="search-input" placeholder="Search products..." class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693] w-64 text-sm">
                        <button id="search-button" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-600 hover:text-[#1A5693]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                        </button>
                        <div id="search-dropdown" class="search-dropdown hidden"></div>
                    </div>
                </div>
                <!-- Center: Logo -->
                <div class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2">
                    <a href="#" id="home-logo-link" class="flex-shrink-0 flex items-center">
                        <img src="https://i.imgur.com/R8x4icz.png" alt="ModMedicalis Logo" class="h-10 sm:h-12 w-auto rounded-lg">
                    </a>
                </div>
                <!-- Right Side: Cart Buttons -->
                <div class="flex items-center space-x-3">
                    <button id="desktop-cart-button" class="hidden md:block relative text-gray-600 hover:text-[#1A5693] transition duration-150">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.38a2 2 0 0 0 1.84-1.11L22 7H4"/></svg>
                        <span id="desktop-cart-count" class="absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-[10px] font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-[#1A5693] rounded-full">0</span>
                    </button>
                    <button id="mobile-cart-button" class="md:hidden relative text-gray-600 hover:text-[#1A5693] transition duration-150">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.38a2 2 0 0 0 1.84-1.11L22 7H4"/></svg>
                        <span id="mobile-cart-count" class="absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-[9px] font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-[#1A5693] rounded-full">0</span>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu (Dropdown) -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100">
            <div class="px-4 py-3 space-y-2">
                <div class="relative w-full">
                    <input type="text" id="mobile-search-input" placeholder="Search products..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693] text-sm">
                    <button id="mobile-search-button" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-600 hover:text-[#1A5693]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    </button>
                    <div id="mobile-search-dropdown" class="search-dropdown hidden"></div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <!-- Home / Shop Sections -->
        <section id="hero-section" class="relative bg-red-50 pt-8 pb-8 sm:pb-16 overflow-hidden reveal-on-scroll transition-colors duration-500">
             <div class="max-w-7xl mx-auto px-4 h-full relative z-10 flex flex-col justify-center">
                <div id="hero-content-wrapper" class="mb-8 sm:mb-12 min-h-[350px] flex items-center">
                    <div id="panel-block3" class="tab-panel active w-full flex flex-col-reverse md:flex-row items-center justify-between gap-6 sm:gap-12 animate-fade-right">
                        <div class="text-center md:text-left md:w-1/2 space-y-3 sm:space-y-4">
                            <span class="bg-white text-[#F94A4A] font-bold px-4 py-1.5 rounded-full text-xs sm:text-sm shadow-sm inline-block tracking-wide">1ST YEAR MBBS ESSENTIAL</span>
                            <h1 class="text-5xl sm:text-6xl md:text-7xl font-black text-gray-900 leading-tight algerya-sans-sc-font"> ACE YOUR <br> <span class="text-[#F94A4A]">BLOCK 3 EXAMS</span> </h1>
                            <p class="text-gray-600 font-medium text-sm sm:text-base max-w-md mx-auto md:mx-0">Detailed illustrations and high-yield mnemonics. Perfect for quick revision and concept consolidation.</p>
                            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center md:justify-start mt-4 sm:mt-6">
                                <button class="add-to-cart-btn-hero bg-[#F94A4A] text-white font-bold py-3 px-8 rounded-xl shadow-lg hover:opacity-90 transition transform hover:-translate-y-1 text-sm sm:text-base" onclick="document.querySelector('.add-to-cart-btn[data-product-id=\'4\']').click()"> SHOP BLOCK 3 </button>
                                <button class="bg-white text-gray-900 border-2 border-gray-200 font-bold py-3 px-8 rounded-xl shadow-sm hover:border-[#F94A4A] transition text-sm sm:text-base" onclick="document.getElementById('notes').scrollIntoView({behavior: 'smooth'})"> VIEW ALL NOTES </button>
                            </div>
                        </div>
                        <div class="md:w-1/2 flex justify-center relative"> <img src="https://i.imgur.com/C5uiLKv.jpeg" class="w-48 sm:w-64 md:w-80 rounded-xl shadow-2xl rotate-[2deg] border-4 border-white transform transition hover:rotate-0 duration-500"> </div>
                    </div>
                    <!-- Block 6 Panel -->
                    <div id="panel-block6" class="tab-panel hidden w-full flex flex-col-reverse md:flex-row items-center justify-between gap-6 sm:gap-12 animate-fade-right">
                        <div class="text-center md:text-left md:w-1/2 space-y-3 sm:space-y-4">
                            <span class="bg-white text-[#3b82f6] font-bold px-4 py-1.5 rounded-full text-xs sm:text-sm shadow-sm inline-block tracking-wide">TRUSTED BY 100,000+ MED STUDENTS</span>
                            <h1 class="text-5xl sm:text-6xl md:text-7xl font-black text-gray-900 leading-tight algerya-sans-sc-font"> STUDY SMARTER <br> <span class="text-[#3b82f6]">FOR BLOCK 6</span> </h1>
                            <p class="text-gray-600 font-medium text-sm sm:text-base max-w-md mx-auto md:mx-0">The newly launched minor subjects block notes. Completely aligned with UHS LOs with enhanced illustrations.</p>
                            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center md:justify-start mt-4 sm:mt-6">
                                <button class="add-to-cart-btn-hero bg-[#3b82f6] text-white font-bold py-3 px-8 rounded-xl shadow-lg hover:bg-blue-700 transition transform hover:-translate-y-1 text-sm sm:text-base" onclick="document.querySelector('.add-to-cart-btn[data-product-id=\'3\']').click()"> SHOP BLOCK 6 </button>
                                <button class="bg-white text-gray-900 border-2 border-gray-200 font-bold py-3 px-8 rounded-xl shadow-sm hover:border-blue-600 transition text-sm sm:text-base" onclick="document.getElementById('notes').scrollIntoView({behavior: 'smooth'})"> VIEW ALL NOTES </button>
                            </div>
                        </div>
                        <div class="md:w-1/2 flex justify-center relative"> <img src="https://i.imgur.com/wLiYfOr.jpeg" class="w-48 sm:w-64 md:w-80 rounded-xl shadow-2xl rotate-[-3deg] border-4 border-white transform transition hover:rotate-0 duration-500"> </div>
                    </div>
                    <!-- Block 5 Panel -->
                    <div id="panel-block5" class="tab-panel hidden w-full flex flex-col-reverse md:flex-row items-center justify-between gap-6 sm:gap-12 animate-fade-right">
                        <div class="text-center md:text-left md:w-1/2 space-y-3 sm:space-y-4">
                            <span class="bg-white text-[#ec4899] font-bold px-4 py-1.5 rounded-full text-xs sm:text-sm shadow-sm inline-block tracking-wide">BEST VALUE FOR 2ND YEAR</span>
                            <h1 class="text-5xl sm:text-6xl md:text-7xl font-black text-gray-900 leading-tight algerya-sans-sc-font"> MASTER <br> <span class="text-[#ec4899]">BLOCK 5 MINORS</span> </h1>
                            <p class="text-gray-600 font-medium text-sm sm:text-base max-w-md mx-auto md:mx-0">Say goodbye to boring books. Completely aligned with UHS LOs and recommended books.</p>
                            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center md:justify-start mt-4 sm:mt-6">
                                <button class="add-to-cart-btn-hero bg-[#ec4899] text-white font-bold py-3 px-8 rounded-xl shadow-lg hover:bg-pink-600 transition transform hover:-translate-y-1 text-sm sm:text-base" onclick="document.querySelector('.add-to-cart-btn[data-product-id=\'2\']').click()"> SHOP BLOCK 5 </button>
                                <button class="bg-white text-gray-900 border-2 border-gray-200 font-bold py-3 px-8 rounded-xl shadow-sm hover:border-pink-500 transition text-sm sm:text-base" onclick="document.getElementById('notes').scrollIntoView({behavior: 'smooth'})"> VIEW ALL NOTES </button>
                            </div>
                        </div>
                        <div class="md:w-1/2 flex justify-center relative"> <img src="https://i.imgur.com/mTnWoeB.png" class="w-48 sm:w-64 md:w-80 rounded-xl shadow-2xl rotate-[-2deg] border-4 border-white transform transition hover:rotate-0 duration-500"> </div>
                    </div>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 max-w-4xl mx-auto w-full">
                    <div class="hero-tab-card active-custom-red group" data-target="block3" data-color="custom-red">
                        <div class="tab-icon-box bg-red-100 text-red-600 group-hover:bg-[#F94A4A] group-hover:text-white"> <i class="fa-solid fa-brain"></i> </div> <span class="font-bold text-sm sm:text-base text-gray-800 group-hover:text-[#F94A4A] transition-colors algerya-sans-sc-font tracking-wide">BLOCK 3</span>
                    </div>
                    <div class="hero-tab-card group" data-target="block6" data-color="blue">
                        <div class="tab-icon-box bg-blue-100 text-blue-600 group-hover:bg-blue-600 group-hover:text-white"> <i class="fa-solid fa-book-medical"></i> </div> <span class="font-bold text-sm sm:text-base text-gray-800 group-hover:text-blue-600 transition-colors algerya-sans-sc-font tracking-wide">BLOCK 6</span>
                    </div>
                    <div class="hero-tab-card group" data-target="block5" data-color="pink">
                        <div class="tab-icon-box bg-pink-100 text-pink-600 group-hover:bg-pink-600 group-hover:text-white"> <i class="fa-solid fa-pills"></i> </div> <span class="font-bold text-sm sm:text-base text-gray-800 group-hover:text-pink-600 transition-colors algerya-sans-sc-font tracking-wide">BLOCK 5</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Shop Section -->
        <section id="notes" class="py-8 sm:py-20 mx-0 mt-4 sm:mt-8 mb-4 shadow-xl bg-white relative overflow-hidden reveal-on-scroll">
            <img src="https://i.imgur.com/QRYh6HS.png" alt="Medical Diagram" class="tilted-overlap-image">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-30">
                <h2 class="text-2xl sm:text-5xl font-bold mb-4 text-[#1A5693] algerya-sans-sc-font">TOP RESOURCES</h2>
                <div id="filter-buttons-container" class="flex justify-center space-x-4 sm:space-x-6 mb-6">
                    <span id="filter-all" data-year="all" class="filter-text-button active text-sm sm:text-base text-[#1A5693]">ALL</span>
                    <span id="filter-1st" data-year="1" class="filter-text-button text-sm sm:text-base text-gray-500">1st Year</span>
                    <span id="filter-2nd" data-year="2" class="filter-text-button text-sm sm:text-base text-gray-500">2nd Year</span>
                </div>
                <div id="product-container" class="horizontal-scroll-container">
                    <div class="glass-card snap-center flex-shrink-0 w-40 sm:w-48 p-2 sm:p-3 rounded-xl text-center product-card mr-3" data-year="1" data-product-id="4">
                        <div class="product-image-box rounded-lg flex items-center justify-center product-trigger" data-product-id="4">
                            <img src="https://i.imgur.com/6tFeXf5.jpeg" alt="Mind Your Minors Block 3" class="rounded-lg">
                            <span class="absolute top-1 left-1 text-[10px] font-bold text-white bg-green-500 px-1.5 py-0.5 rounded-full shadow-md">NEW!!</span>
                        </div>
                        <h3 class="product-card-title text-gray-900 mb-0.5 product-trigger" data-product-id="4">MIND YOUR MINORS BLOCK 3</h3>
                        <div class="flex flex-col items-center justify-center space-y-0.5 mt-1 sm:mt-2"> <span class="product-price-main">Rs. 700</span> </div>
                        <button class="add-to-cart-btn rounded-full flex items-center justify-center" data-product-id="4"> <span class="font-light leading-none">+</span> </button>
                    </div>
                    <div class="glass-card snap-center flex-shrink-0 w-40 sm:w-48 p-2 sm:p-3 rounded-xl text-center product-card mr-3" data-year="2" data-product-id="2">
                        <div class="product-image-box rounded-lg flex items-center justify-center product-trigger" data-product-id="2">
                            <img src="https://i.imgur.com/zTYjCgL.jpeg" alt="Mind Your Minors Block 5" class="rounded-lg">
                            <span class="absolute top-1 left-1 text-[10px] font-bold text-white bg-blue-500 px-1.5 py-0.5 rounded-full shadow-md">BEST VALUE</span>
                        </div>
                        <h3 class="product-card-title text-gray-900 mb-0.5 product-trigger" data-product-id="2">MIND YOUR MINORS - BLOCK 5</h3>
                        <div class="flex flex-col items-center justify-center space-y-0.5"> <span class="product-price-main">Rs. 500</span> </div>
                        <button class="add-to-cart-btn rounded-full flex items-center justify-center" data-product-id="2"> <span class="font-light leading-none">+</span> </button>
                    </div>
                    <div class="glass-card snap-center flex-shrink-0 w-40 sm:w-48 p-2 sm:p-3 rounded-xl text-center product-card mr-3" data-year="2" data-product-id="3">
                        <div class="product-image-box rounded-lg flex items-center justify-center product-trigger" data-product-id="3">
                            <img src="https://i.imgur.com/IhQVD4x.jpeg" alt="Mind Your Minors Block 6" class="rounded-lg">
                            <span class="absolute top-1 left-1 text-[10px] font-bold text-white bg-red-600 px-1.5 py-0.5 rounded-full shadow-md">NEW!</span>
                        </div>
                        <h3 class="product-card-title text-gray-900 mb-0.5 product-trigger" data-product-id="3">MIND YOUR MINORS - BLOCK 6</h3>
                        <div class="flex flex-col items-center justify-center space-y-0.5 mt-1 sm:mt-2"> <span class="product-price-main">Rs. 700</span> </div>
                        <button class="add-to-cart-btn rounded-full flex items-center justify-center" data-product-id="3"> <span class="font-light leading-none">+</span> </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Rest of content sections (Review, Free Resources etc) -->
        <section class="pt-6 pb-0 sm:pt-8 sm:pb-0 reveal-on-scroll" style="background-color: #E0F4FF;">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-xl sm:text-4xl font-extrabold text-center mb-6 text-gray-900 algerya-sans-sc-font"> <span class="text-black">TRUSTED BY </span><span style="color: #00A5E3;">STUDENTS FROM 10+</span><span class="text-black"> MEDSCHOOLS</span> </h2>
                <div class="horizontal-scroll-container pb-0 space-x-3">
                    <div class="snap-center flex-shrink-0 w-64 sm:w-80 p-4 sm:p-5 review-box-design">
                        <div class="flex items-center space-x-1 text-yellow-500 text-sm mb-2"> <span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span> </div>
                        <p class="italic text-gray-700 mb-2 text-xs sm:text-sm leading-relaxed">"your FLASHCARDS are super effective and a lifesaver indeed...really admire your efforts behind these &lt;3 BIG thanks for the mnemonics !!"</p>
                        <div class="font-bold text-gray-900 text-xs sm:text-sm">MBBS Student</div>
                        <div class="text-[10px] sm:text-xs text-gray-500">1st year MBBS student AIMC</div>
                    </div>
                    <div class="snap-center flex-shrink-0 w-64 sm:w-80 p-4 sm:p-5 review-box-design">
                        <div class="flex items-center space-x-1 text-yellow-500 text-sm mb-2"> <span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span> </div>
                        <p class="italic text-gray-700 mb-2 text-xs sm:text-sm leading-relaxed">"Mind your minors is literally a v good initiative. The illustrations are quite appealing and all the minors being covered in a book with past ppr questions is cherry on top..."</p>
                        <div class="font-bold text-gray-900 text-xs sm:text-sm">MBBS Student</div>
                        <div class="text-[10px] sm:text-xs text-gray-500">2nd year MBBS student AIMC</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="new-comparison-image" class="pt-0 pb-4 sm:pb-8 bg-[#E0F4FF] reveal-on-scroll">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <div class="max-w-4xl mx-auto rounded-xl shadow-none overflow-hidden"> <img src="https://i.imgur.com/HFxNvsE.png" alt="Mind Your Minors Book Example" class="w-full h-auto object-cover"> </div>
            </div>
        </section>

        <!-- New Section for Vertical Images -->
        <section class="pt-0 pb-10 sm:pb-16 bg-[#E0F4FF] reveal-on-scroll">
             <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-col space-y-6 sm:space-y-8">
                    <img src="https://i.imgur.com/twQBmob.jpeg" alt="Preview 1" class="w-full rounded-3xl shadow-lg border border-white/50">
                    <img src="https://i.imgur.com/XF7dRZ9.jpeg" alt="Preview 2" class="w-full rounded-3xl shadow-lg border border-white/50">
                    <img src="https://i.imgur.com/rvOMwxF.jpeg" alt="Preview 3" class="w-full rounded-3xl shadow-lg border border-white/50">
                </div>
            </div>
        </section>

        <section class="py-10 sm:py-20 red-curved-section mb-4 reveal-on-scroll">
            <svg class="medical-pattern-svg" viewBox="0 0 100 100" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
                <defs> <pattern id="medicalPattern" patternUnits="userSpaceOnUse" width="20" height="20"> <path d="M 10 0 L 10 20 M 0 10 L 20 10" stroke="#fef2f2" stroke-width="1.5" /> <path d="M 5 5 Q 10 0 15 5 Q 20 10 15 5 Q 20 10 15 15 Q 10 20 5 15" fill="none" stroke="#fef2f2" stroke-width="0.5" /> <path d="M 0 12 L 5 12 L 7 8 L 9 16 L 11 8 L 13 12 L 20 12" fill="none" stroke="#fef2f2" stroke-width="0.25" /> </pattern> </defs> <rect width="100%" height="100%" fill="url(#medicalPattern)" />
            </svg>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center content-z">
                <h2 class="text-4xl sm:text-7xl font-extrabold text-white algerya-sans-sc-font">FREE RESOURCES</h2>
                <a href="https://modmedicalis.online/FREE-RESOURCES" class="avail-btn mt-4 inline-block">CLICK TO AVAIL</a>
                <p class="text-white text-opacity-80 mt-4 text-xs sm:text-sm font-medium">Flashcards, Quizzes, Past Papers and UHS Notes</p>
            </div>
        </section>

        <section class="py-10 sm:py-20 bg-[#E0F4FF] border-t border-gray-200 reveal-on-scroll">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-2xl sm:text-5xl font-extrabold text-center mb-6 sm:mb-10 text-gray-900 algerya-sans-sc-font"> <span style="color: black;">MESSAGE FROM THE </span> <span style="color: #00A5E3;">FOUNDER</span> </h2>
                <div class="p-5 sm:p-8 bg-white rounded-xl shadow-2xl border-t-0">
                    <p class="italic text-gray-700 mb-4 sm:mb-6 text-sm sm:text-base leading-relaxed">Mind Your Minors was born from the real struggles of every medical student; endless notes, massive books, and not enough time. We wanted to change the way students learn, making it smarter, simpler, and more visual. Each page blends clarity with creativity, turning complex topics into quick, memorable insights. Designed by students who've been in your shoes, this book makes learning the minor subjects not a burden, but a breakthrough in your MBBS journey.</p>
                    <div class="flex items-center justify-end space-x-3 sm:space-x-4 pt-4 border-t border-gray-100">
                        <div class="text-right"> <p class="font-bold text-base sm:text-lg text-gray-900">Muhammad Hasnain</p> <p class="text-xs sm:text-sm text-[#1A5693] font-semibold">Founder, ModMedicalis</p> </div> <img src="https://i.imgur.com/2y4pFZW.jpeg" alt="Founder's Photo" class="h-12 w-12 sm:h-16 sm:w-16 rounded-full object-cover ring-2 ring-[#1A5693] p-0.5">
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer id="contact" class="bg-[#FFEFF2] text-gray-900 py-8 sm:py-10 reveal-on-scroll">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="flex flex-col items-center mb-6 sm:mb-8">
                <a href="#" class="home-logo-link flex-shrink-0 flex items-center mb-4"> <img src="https://i.imgur.com/R8x4icz.png" alt="ModMedicalis Logo" class="h-10 sm:h-12 w-auto rounded-lg"> </a>
                <h3 class="text-lg sm:text-xl font-bold text-red-600 mb-2 algerya-sans-sc-font">MODMEDICALIS</h3>
                <p class="text-xs sm:text-sm text-gray-600 max-w-sm">Your trusted partner for medical education excellence.</p>
            </div>
            <div class="max-w-xs mx-auto mb-6 sm:mb-8 border-t border-b border-gray-300 py-4 sm:py-6">
                <h4 class="text-sm sm:text-base font-bold mb-4 text-red-600 algerya-sans-sc-font">MENU</h4>
                <ul class="space-y-2 text-sm sm:text-base font-medium">
                    <li><a href="#" class="home-logo-link text-gray-700 hover:text-red-600 transition">Home</a></li>
                    <li><a href="#notes" class="text-gray-700 hover:text-red-600 transition">Shop</a></li>
                    <li><a href="https://modmedicalis.online/FREE-RESOURCES" class="text-gray-700 hover:text-red-600 transition">Free Resources</a></li>
                    <li><a href="#contact" class="text-gray-700 hover:text-red-600 transition">Contact / FAQs</a></li>
                </ul>
            </div>
             <div class="text-[10px] sm:text-xs text-gray-500 space-x-4 pt-4 mt-4 border-t border-gray-300"> <p class="mb-2">&copy; 2025 ModMedicalis</p> </div>
        </div>
    </footer>

    <!-- Cart Modal -->
    <div id="cart-modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div id="cart-modal" class="bg-white rounded-xl shadow-2xl w-full max-w-sm sm:max-w-md transform transition-all duration-300 scale-95 opacity-0">
            <div class="p-4 border-b flex justify-between items-center bg-[#00A5E3] rounded-t-xl">
                <h3 class="text-xl font-bold text-white algerya-sans-sc-font">Your Cart</h3>
                <button id="close-cart-button" class="text-white hover:text-gray-100 transition p-1"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg> </button>
            </div>
            <div id="cart-items-container" class="p-4 max-h-72 overflow-y-auto space-y-3"> <p id="empty-cart-message" class="text-gray-500 text-center italic text-sm">Your cart is empty.</p> </div>
            <div id="cart-footer" class="p-4 border-t space-y-2 rounded-b-xl bg-gray-50">
                <div class="flex justify-between font-semibold text-gray-700 text-sm"> <span>Subtotal:</span> <span id="cart-subtotal">Rs. 0</span> </div>
                <div class="flex justify-between text-lg font-extrabold text-[#1A5693]"> <span>Total:</span> <span id="cart-total">Rs. 0</span> </div>
                <button id="proceed-to-checkout-btn" class="w-full bg-[#00A5E3] text-white py-2 rounded-lg font-bold text-sm hover:bg-cyan-600 transition duration-200 shadow-lg algerya-sans-sc-font"> Proceed to Checkout </button>
            </div>
        </div>
    </div>

    <!-- ======================================================== -->
    <!-- MODIFIED CHECKOUT PAGE (SHOPIFY STYLE + MOBILE OPT)      -->
    <!-- ======================================================== -->
    <div id="checkout-page" class="hidden">
        
        <!-- Mobile Header (Logo Only) -->
        <div class="mobile-header">
            <img src="https://i.imgur.com/R8x4icz.png" alt="ModMedicalis" class="h-10 w-auto rounded-lg">
        </div>

        <!-- Mobile "Show Order Summary" Accordion -->
        <details class="mobile-summary-accordion">
            <summary>
                <span class="flex items-center text-[#1A5693]">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                    Show order summary
                </span>
                <span id="mobile-summary-total" class="text-gray-900 font-bold">Rs. 0</span>
            </summary>
            <div class="mobile-summary-content">
                <ul class="text-sm space-y-3 pt-3 text-gray-600 mobile-cart-mirror">
                    <li class="italic text-xs text-gray-400">Items will appear here at confirmation step.</li>
                </ul>
            </div>
        </details>
        
        <div class="shopify-layout">
            
            <!-- LEFT COLUMN: Main Form -->
            <div class="shopify-main">
                <div class="checkout-header-logo hidden lg:block">
                    <img src="https://i.imgur.com/R8x4icz.png" alt="ModMedicalis" class="h-12 w-auto rounded-lg">
                </div>
                
                <!-- BREADCRUMBS -->
                <div id="checkout-steps-container">
                    <div class="step-indicator shopify-breadcrumbs">
                        <div class="step active" data-step="1"> <div class="step-label">Information</div> </div>
                        <div class="step" data-step="2"> <div class="step-label">Payment</div> </div>
                        <div class="step" data-step="3"> <div class="step-label">Confirmation</div> </div>
                    </div>
                    <!-- Hidden progress bar for JS logic compatibility -->
                    <div class="progress-bar-container" style="display:none;">
                        <div id="checkout-progress-bar" class="progress-bar" style="width: 0%;"></div>
                    </div>
                </div>

                <!-- Forms -->
                <form id="checkout-form" method="POST" enctype="multipart/form-data">
                    <input type="hidden" name="_subject" value="New ModMedicalis Order!">
                    <input type="hidden" name="_template" value="table">
                    <input type="hidden" name="_captcha" value="false">
                    <input type="hidden" name="Cart Details" id="form-cart-details">
                    <input type="hidden" name="Final Bill" id="form-final-bill">
                    <input type="hidden" name="Order ID" id="form-order-id">
                    <input type="hidden" name="Roll Number" id="form-roll-number" value="">

                    <!-- STEP 1: SHIPPING -->
                    <div id="checkout-step-1" class="checkout-step active">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-medium">Contact & Shipping</h2>
                            <p class="text-sm text-[#1A5693] cursor-pointer" onclick="switchView('main')">Return to Cart</p>
                        </div>
                        
                        <div class="shopify-input-group">
                            <label class="shopify-input-label">Full Name</label>
                            <input type="text" id="full_name" name="Full Name" required class="modern-input" placeholder="Enter your name">
                        </div>
                        
                        <div class="shopify-input-group">
                            <label class="shopify-input-label">Contact Number</label>
                            <input type="tel" id="contact_number" name="Contact Number" required class="modern-input" placeholder="03XXXXXXXXX">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="shopify-input-group">
                                <label class="shopify-input-label">College</label>
                                <select id="college" name="College" required class="modern-input">
                                    <option value="" disabled selected>Select Medical College</option>
                                </select>
                            </div>
                            <div class="shopify-input-group">
                                <label class="shopify-input-label">City</label>
                                <select id="city_selector" name="City" required class="modern-input">
                                    <option value="" disabled selected>Select City</option>
                                </select>
                            </div>
                        </div>

                        <div class="shopify-input-group">
                            <label class="shopify-input-label">Shipping Address</label>
                            <textarea id="shipping_address" name="Shipping Address" rows="3" required class="modern-input" placeholder="House no, Street, Area..."></textarea>
                        </div>

                        <!-- Promo Code Section -->
                        <div id="aimc-promo-section" class="hidden">
                            <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                <p class="text-xs font-bold text-blue-800 mb-2 uppercase tracking-wide">AIMC Student Offer</p>
                                <div class="flex gap-2">
                                    <input type="text" id="promo_code" name="Promo Code Entered" class="modern-input uppercase text-sm" placeholder="Promo Code">
                                </div>
                                <div id="roll-number-entry" class="hidden mt-2">
                                    <input type="number" id="roll_number" name="AIMC Roll Number" class="modern-input text-sm" placeholder="Roll Number">
                                    <p id="roll-number-feedback" class="text-[11px] mt-1 font-semibold"></p>
                                </div>
                            </div>
                        </div>

                        <div class="checkout-navigation">
                            <button type="button" id="next-to-payment-btn" class="shopify-btn-primary">Continue to Payment</button>
                            <button type="button" id="cancel-checkout-btn" class="hidden">Cancel</button> 
                        </div>
                    </div>

                    <!-- STEP 2: PAYMENT -->
                    <div id="checkout-step-2" class="checkout-step">
                         <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-medium">Payment</h2>
                        </div>
                        
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-5 mb-6">
                            <p class="text-sm font-medium text-gray-500 mb-1">Send payment to:</p>
                            <p class="text-lg font-bold text-gray-900">MUHAMMAD HASNAIN</p>
                            <div class="flex items-center space-x-2 mt-2">
                                <span class="text-xl font-mono text-[#1A5693] font-bold tracking-wider">03096554421</span>
                                <button type="button" onclick="copyPaymentNumber()" class="text-xs bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded">Copy</button>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">Jazzcash & Easypaisa</p>
                            
                            <div class="mt-4 pt-4 border-t border-gray-200">
                                <p class="text-sm font-medium text-gray-900">Amount to Pay: <span id="payment-amount" class="text-red-600 font-bold">Rs. 0</span></p>
                                <p class="text-[11px] text-gray-500 mt-1">*Delivery charges are paid in Cash on Delivery. Pay only for products now.</p>
                            </div>
                        </div>

                        <div class="shopify-input-group">
                            <label class="shopify-input-label">Upload Payment Proof</label>
                            <div class="flex items-center justify-center w-full">
                                <label for="payment_slip" class="flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition">
                                    <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                        <svg class="w-8 h-8 mb-4 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/>
                                        </svg>
                                        <p class="text-sm text-gray-500"><span id="upload-text">Click to upload slip</span></p>
                                    </div>
                                    <input type="file" id="payment_slip" name="Payment Slip" accept="image/*,.pdf" required class="hidden">
                                </label>
                            </div>
                        </div>

                        <div class="mt-8">
                            <p class="text-sm font-medium mb-3 text-gray-700">How did you hear about us?</p>
                            <div class="space-y-2">
                                <div class="flex items-center"> <input id="source-ambassador" name="Referral Source" type="radio" value="Ambassador" required class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"> <label for="source-ambassador" class="ml-2 text-sm text-gray-700">Ambassador</label> </div>
                                <div class="flex items-center"> <input id="source-social" name="Referral Source" type="radio" value="Social Media" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"> <label for="source-social" class="ml-2 text-sm text-gray-700">Social Media</label> </div>
                                <div class="flex items-center"> <input id="source-colleagues" name="Referral Source" type="radio" value="Colleagues" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"> <label for="source-colleagues" class="ml-2 text-sm text-gray-700">Colleagues</label> </div>
                            </div>
                        </div>

                        <div class="checkout-navigation">
                            <button type="button" id="next-to-confirmation-btn" class="shopify-btn-primary">Review Order</button>
                            <button type="button" id="back-to-shipping-btn" class="shopify-btn-secondary">< Previous step</button>
                        </div>
                    </div>

                    <!-- STEP 3: CONFIRMATION -->
                    <div id="checkout-step-3" class="checkout-step">
                         <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-medium">Review & Submit</h2>
                        </div>
                        
                        <!-- Delivery Note (Fixed: Not Yellow anymore) -->
                        <div id="checkout-delivery-note" class="p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-800 mb-6"></div>
                        
                        <p class="text-sm text-gray-600 mb-4">Please verify all details in the summary before confirming.</p>
                        
                        <div class="checkout-navigation">
                            <button type="submit" id="confirm-order-btn" class="shopify-btn-primary bg-red-600 hover:bg-red-700">Place Order</button>
                            <button type="button" id="back-to-payment-btn" class="shopify-btn-secondary">< Previous step</button>
                        </div>
                        
                         <div class="hidden">
                             <ul id="checkout-summary-list"></ul>
                        </div>
                    </div>

                </form>
                
                <!-- SUCCESS MESSAGE -->
                <div id="checkout-success-page" class="hidden py-12 text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-900 mb-2">Order Confirmed!</h3>
                    <div id="checkout-success-message" class="text-gray-600 mb-6"></div>
                    <p class="text-sm text-gray-500 bg-gray-50 p-4 rounded-lg inline-block">Support: <strong>03096554421</strong></p>
                    <button id="close-success-btn" class="block w-full max-w-xs mx-auto mt-8 shopify-btn-primary">Return to Shop</button>
                </div>
            </div>

            <!-- RIGHT COLUMN: Order Summary (Sticky Sidebar) -->
            <div class="shopify-sidebar">
                <div class="sidebar-product-list"></div>
                <h3 class="text-lg font-bold text-gray-700 mb-4">Order Summary</h3>
                <ul id="checkout-summary-list" class="text-sm space-y-3 mb-4 text-gray-600">
                    <!-- JS Injects items here -->
                </ul>

                <div class="sidebar-total">
                    <span class="sidebar-total-label">Total</span>
                    <div class="flex items-center">
                        <span class="sidebar-total-currency">PKR</span>
                        <span id="checkout-final-total" class="sidebar-total-value">Rs. 0</span>
                    </div>
                </div>
                
                <div class="mt-8 pt-8 border-t border-gray-200">
                    <button id="close-checkout-button" class="text-sm text-red-500 hover:text-red-700 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                        Cancel Checkout
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Product Modal Page (Hidden) -->
    <div id="product-page" class="hidden min-h-screen bg-white">
        <div id="product-page-content" class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="p-3 flex justify-end">
                <button id="close-product-page-button" class="text-gray-500 hover:text-gray-900 transition p-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="grid md:grid-cols-2 gap-8 lg:gap-12">
                <div class="space-y-3">
                    <div id="popup-image-carousel" class="w-full relative">
                        <div class="product-popup-image-container rounded-xl shadow-lg"> <img id="popup-main-image" src="" alt="Product Main Image"> </div>
                        <div id="popup-thumbnails" class="flex space-x-2 mt-3 overflow-x-auto justify-center"></div>
                    </div>
                </div>
                <div class="space-y-4">
                    <h2 id="popup-product-name" class="text-3xl font-extrabold text-[#1A5693] algerya-sans-sc-font"></h2>
                    <div class="flex items-center space-x-2"> <span id="popup-product-price" class="font-extrabold text-red-600 flex items-end space-x-1"></span> <span id="popup-product-old-price" class="text-base text-gray-400 line-through"></span> </div>
                    <div id="popup-delivery-notice"></div>
                    <p id="popup-product-description" class="text-gray-700 leading-relaxed text-sm"></p>
                    <div id="popup-product-features"></div>
                    <div class="flex flex-col space-y-3 pt-2">
                        <button id="popup-add-to-cart-btn" class="w-full bg-[#1A5693] text-white py-2.5 rounded-lg font-bold text-base hover:bg-blue-700 transition duration-200 shadow-lg flex items-center justify-center space-x-2 disabled:opacity-50" data-product-id=""> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.38a2 2 0 0 0 1.84-1.11L22 7H4"/></svg> <span class="algerya-sans-sc-font">Add to cart</span> </button>
                        <button id="popup-free-preview-btn" class="w-full bg-gray-200 text-gray-800 py-2.5 rounded-lg font-bold text-base hover:bg-gray-300 transition duration-200 shadow-md flex items-center justify-center space-x-2"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg> <span class="algerya-sans-sc-font">Click for free preview</span> </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
    // EXISTING LOGIC PRESERVED
    function displayCustomAlert(message) {
        const popup = document.createElement('div');
        popup.className = 'fixed inset-0 bg-black bg-opacity-70 z-[1000] flex items-center justify-center p-4';
        popup.innerHTML = ` <div class="bg-white rounded-xl shadow-2xl p-6 max-w-sm w-full text-center"> <h5 class="text-xl font-bold text-red-600 mb-4 algerya-sans-sc-font">Notification</h5> <p class="text-gray-700 mb-6">${message}</p> <button onclick="this.closest('.fixed').remove()" class="px-6 py-2 bg-[#1A5693] text-white rounded-lg font-bold hover:bg-blue-700 algerya-sans-sc-font">OK</button> </div> `;
        document.body.appendChild(popup);
    }
    function copyPaymentNumber() {
        const number = '03096554421';
        const tempInput = document.createElement('input');
        tempInput.value = number;
        document.body.appendChild(tempInput);
        tempInput.select();
        try { document.execCommand('copy'); displayCustomAlert('Number copied to clipboard!'); } catch (err) { displayCustomAlert('Failed to copy number. Please manually copy: 03096554421'); }
        document.body.removeChild(tempInput);
    }
    const DELIVERY_CHARGE_LAHORE = 100;
    const DELIVERY_CHARGE_OLL = 200;
    const CITIES_LIST = [ 'Lahore', 'Faisalabad', 'Rawalpindi', 'Gujranwala', 'Multan', 'Bahawalpur', 'Sargodha', 'Sialkot', 'Sheikhupura', 'Rahim Yar Khan', 'Jhang', 'Dera Ghazi Khan', 'Gujrat', 'Sahiwal', 'Wah Cantonment', 'Kasur', 'Okara', 'Karachi', 'Hyderabad', 'Sukkur', 'Larkana', 'Peshawar', 'Mardan', 'Abbottabad', 'Swat', 'Quetta', 'Islamabad', 'Muzaffarabad', 'Other' ].sort((a, b) => { if (a === 'Lahore') return -1; if (b === 'Lahore') return 1; if (a === 'Other') return 1; if (b === 'Other') return -1; return a.localeCompare(b); });
    const calculateDeliveryCharge = (cityName) => { return cityName === 'Lahore' ? DELIVERY_CHARGE_LAHORE : DELIVERY_CHARGE_OLL; };
    const PAKISTAN_MEDICAL_COLLEGES = [ 'King Edward Medical University (KEMU), Lahore', 'Allama Iqbal Medical College (AIMC), Lahore', 'Fatima Jinnah Medical University (FJMU), Lahore', 'Services Institute of Medical Sciences (SIMS), Lahore', 'Nishtar Medical University (NMU), Multan', 'Rawalpindi Medical University (RMU), Rawalpindi', 'Quaid-e-Azam Medical College (QAMC), Bahawalpur', 'Faisalabad Medical University (FMU), Faisalabad', 'Sargodha Medical College (SMC), Sargodha', 'Gujranwala Medical College (GMC), Gujranwala', 'Sialkot Medical College (SMC), Sialkot', 'Dera Ghazi Khan Medical College (DGKMC), D.G Khan', 'Dow Medical College (DMC), Karachi', 'Sindh Medical College (SMC), Karachi', 'Jinnah Sindh Medical University (JSMU), Karachi', 'Liaquat University of Medical and Health Sciences (LUMHS), Jamshoro', 'Khyber Medical College (KMC), Peshawar', 'Ayub Medical College (AMC), Abbottabad', 'Bolan Medical College (BMC), Quetta', 'Shaikh Zayed Medical College (SZMC), Rahim Yar Khan', 'Azad Jammu and Kashmir Medical College (AJKMC), Muzaffarabad', 'PIMS Medical College, Islamabad', 'Saidu Medical College, Swat', 'Gajju Khan Medical College (GKMC), Swabi', 'Bannu Medical College (BMC), Bannu', 'Aga Khan University Hospital (AKUH), Karachi', 'Shalamar Medical and Dental College (SMDC), Lahore', 'CMH Lahore Medical College (CMH LMC)', 'FMH College of Medicine and Dentistry (FMHCM&D), Lahore', 'University College of Medicine and Dentistry (UCMD), Lahore', 'Azra Naheed Medical College (ANMC), Lahore', 'Central Park Medical College (CPMC), Lahore', 'Lahore Medical and Dental College (LMDC), Lahore', 'Continental Medical College (CMC), Lahore', 'Amna Inayat Medical College (AIMC), Sheikhupura', 'Islamabad Medical and Dental College (IMDC), Islamabad', 'Foundation University Medical College (FUMC), Rawalpindi', 'Riphah International University (RIU), Islamabad', 'Rawal Institute of Health Sciences, Islamabad', 'Karachi Medical and Dental College (KMDC), Karachi', 'Liaquat College of Medicine and Dentistry (LCMD), Karachi', 'Ziauddin Medical University, Karachi', 'Indus Medical College, Tando Muhammad Khan', 'Wah Medical College, Wah Cantt', 'Hashmat Medical College, Gujrat', 'Akhtar Saeed Medical and Dental College (ASMDC), Lahore', 'Pak Red Crescent Medical and Dental College, Lahore', 'HBS Medical and Dental College, Islamabad', 'Sarhad University of Science and IT, Peshawar', 'Bacha Khan Medical College, Mardan', 'Women Medical and Dental College, Abbottabad', 'Bakhtawar Amin Medical and Dental College, Multan', 'Bilal Medical College, Rawalpindi', 'Fazaia Medical College, Islamabad', 'Green International University (GIU), Lahore', ].sort();
    const BIN_ID = '6916abbf43b1c97be9ac64e8';
    const READ_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}/latest`;
    const WRITE_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;
    const API_KEY = '$2a$10$c2jwTEMgLn/n1ZXEL5qWiOTw4f6Mqr1r1Qd0ah0khbqTrChXEog8u';
    let rollNumberDataFromBackend = {};
    let isBackendReady = false;
    async function fetchRollNumberData() {
        try { const response = await fetch(READ_URL); if (!response.ok) throw new Error(`Backend responded with status: ${response.status}`); const data = await response.json(); if (data.record && data.record.available_rolls && data.record.blocked_rolls && data.record.used_rolls) { rollNumberDataFromBackend = data.record; isBackendReady = true; console.log('Successfully fetched roll number data from backend.'); } } catch (error) { console.error('CRITICAL ERROR fetching roll number data:', error); isBackendReady = false; }
    }
    function getRollNumberStatus(rollNumber) {
        const num = parseInt(rollNumber); if (isNaN(num)) return { isValid: false, message: "Please enter a valid number." }; if (!isBackendReady || !rollNumberDataFromBackend.blocked_rolls) { return { isValid: false, message: "Verification server is not ready. Please try again." }; } if (rollNumberDataFromBackend.blocked_rolls.includes(num)) { return { isValid: false, message: "This roll number is not eligible for the promo." }; } if (rollNumberDataFromBackend.used_rolls.includes(num)) { return { isValid: false, message: "sorry you have either pre ordered the book or already used the promo code" }; } if (!rollNumberDataFromBackend.available_rolls.includes(num)) { return { isValid: false, message: "sorry you have either pre ordered the book or already used the promo code" }; } return { isValid: true, message: "Roll Number is valid and available for promo discount." };
    }
    async function updateBackendWithUsedRollNumber(usedRollNumber) {
        const numToRemove = parseInt(usedRollNumber); if (isNaN(numToRemove) || !isBackendReady) return; const newAvailableRolls = rollNumberDataFromBackend.available_rolls.filter(roll => roll !== numToRemove); const newUsedRolls = [...rollNumberDataFromBackend.used_rolls, numToRemove]; const payload = { ...rollNumberDataFromBackend, available_rolls: newAvailableRolls, used_rolls: newUsedRolls }; try { const response = await fetch(WRITE_URL, { method: 'PUT', headers: { 'Content-Type': 'application/json', 'X-Master-Key': API_KEY, 'X-Bin-Versioning': 'false' }, body: JSON.stringify(payload) }); if (!response.ok) throw new Error(`Backend update failed with status: ${response.status}`); console.log(`Successfully removed roll number ${usedRollNumber} from backend.`); rollNumberDataFromBackend = payload; } catch (error) { console.error('CRITICAL ERROR updating backend with used roll number:', error); }
    }
    document.addEventListener('DOMContentLoaded', () => {
        fetchRollNumberData();
        const mainContent = document.querySelector('main');
        const header = document.querySelector('header');
        const footer = document.querySelector('footer');
        const productPage = document.getElementById('product-page');
        const checkoutPage = document.getElementById('checkout-page');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const filterButtons = document.querySelectorAll('.filter-text-button');
        const productCards = document.querySelectorAll('.product-card');
        const productTriggers = document.querySelectorAll('.product-trigger');
        const searchInput = document.getElementById('search-input');
        const searchDropdown = document.getElementById('search-dropdown');
        const mobileSearchInput = document.getElementById('mobile-search-input');
        const mobileSearchDropdown = document.getElementById('mobile-search-dropdown');
        const cartModalOverlay = document.getElementById('cart-modal-overlay');
        const cartModal = document.getElementById('cart-modal');
        const cartItemsContainer = document.getElementById('cart-items-container');
        const emptyCartMessage = document.getElementById('empty-cart-message');
        const cartSubtotalElement = document.getElementById('cart-subtotal');
        const cartTotalElement = document.getElementById('cart-total');
        const cartCountElements = document.querySelectorAll('[id$="-cart-count"]');
        const proceedToCheckoutBtn = document.getElementById('proceed-to-checkout-btn');
        const closeCheckoutButton = document.getElementById('close-checkout-button');
        const paymentAmount = document.getElementById('payment-amount');
        const checkoutSummaryList = document.getElementById('checkout-summary-list');
        const checkoutFinalTotal = document.getElementById('checkout-final-total');
        const checkoutCollegeSelect = document.getElementById('college');
        const citySelector = document.getElementById('city_selector');
        const checkoutDeliveryNote = document.getElementById('checkout-delivery-note');
        const checkoutForm = document.getElementById('checkout-form');
        const checkoutStepsContainer = document.getElementById('checkout-steps-container');
        const checkoutSuccessPage = document.getElementById('checkout-success-page');
        const checkoutSteps = document.querySelectorAll('.checkout-step');
        const stepIndicators = document.querySelectorAll('.step');
        const progressBar = document.getElementById('checkout-progress-bar');
        const nextToPaymentBtn = document.getElementById('next-to-payment-btn');
        const backToShippingBtn = document.getElementById('back-to-shipping-btn');
        const nextToConfirmationBtn = document.getElementById('next-to-confirmation-btn');
        const backToPaymentBtn = document.getElementById('back-to-payment-btn');
        const cancelCheckoutBtn = document.getElementById('cancel-checkout-btn');
        const closeSuccessBtn = document.getElementById('close-success-btn');
        const closeProductPageButton = document.getElementById('close-product-page-button');
        const popupMainImage = document.getElementById('popup-main-image');
        const popupThumbnails = document.getElementById('popup-thumbnails');
        const popupProductName = document.getElementById('popup-product-name');
        const popupProductPrice = document.getElementById('popup-product-price');
        const popupProductOldPrice = document.getElementById('popup-product-old-price');
        const popupProductDescription = document.getElementById('popup-product-description');
        const popupAddToCartBtn = document.getElementById('popup-add-to-cart-btn');
        const popupFreePreviewBtn = document.getElementById('popup-free-preview-btn');
        const aimcPromoSection = document.getElementById('aimc-promo-section');
        const promoCodeInput = document.getElementById('promo_code');
        const rollNumberEntry = document.getElementById('roll-number-entry');
        const rollNumberInput = document.getElementById('roll_number');
        const rollNumberFeedback = document.getElementById('roll-number-feedback');
        const formRollNumber = document.getElementById('form-roll-number');
        const paymentSlipInput = document.getElementById('payment_slip');
        
        // NEW: Payment Slip Upload Feedback Listener
        if(paymentSlipInput) {
            paymentSlipInput.addEventListener('change', function(e) {
                const fileName = e.target.files[0]?.name;
                const textSpan = document.getElementById('upload-text');
                const label = this.closest('label');
                if (fileName) {
                    textSpan.innerHTML = `Selected: <span class="font-bold text-[#1A5693]">${fileName}</span>`;
                    label.classList.add('border-[#1A5693]', 'bg-blue-50');
                    label.classList.remove('border-gray-300', 'bg-gray-50');
                } else {
                    textSpan.textContent = "Click to upload slip";
                    label.classList.remove('border-[#1A5693]', 'bg-blue-50');
                    label.classList.add('border-gray-300', 'bg-gray-50');
                }
            });
        }

        const PRODUCTS_FORM_URL = "https://formbold.com/s/oP5Jb";
        const BLOCK6_FORM_URL = "https://formbold.com/s/3Z4Np";
        const products = [ { id: 1, name: "BLOCK 2 FLASHCARDS", price: 900, oldPrice: 1100, year: 1, isPrebook: false, images: ["https://i.imgur.com/c4XSHmA.jpeg"], description: "High-yield flashcards for Block 2, aligned with UHS LOs. Perfect for quick revision and concept consolidation.", previewLink: "https://drive.google.com/file/d/1QFJiBzPELwVWcaVi7VWnDrIr-bwm5qBy/view?usp=drivesdk" }, { id: 2, name: "MIND YOUR MINORS - BLOCK 5", price: 500, oldPrice: null, year: 2, isPrebook: false, images: ["https://i.imgur.com/zTYjCgL.jpeg"], description: "Get ready to ace your minor subjects with our illustrative notes and say good bye to boring books. Completely alligned with UHS LOs and recommended books.", previewLink: "https://drive.google.com/file/d/1LDBgWhSP6xeWDqxyKyutZ7tOijrx_uuS/view?usp=drivesdk" }, { id: 3, name: "MIND YOUR MINORS - BLOCK 6", price: 700, oldPrice: 1500, year: 2, isPrebook: false, images: ["https://i.imgur.com/IhQVD4x.jpeg", "https://i.imgur.com/TyME5Qd.jpeg", "https://i.imgur.com/miUBzhw.jpeg", "https://i.imgur.com/o4FT33T.jpeg", "https://i.imgur.com/KluXvgE.jpeg", "https://i.imgur.com/VieVppz.jpeg"], description: "The newly launched minor subjects block notes. Completely aligned with UHS LOs and recommended books, featuring enhanced illustrations and high-yield mnemonics.", previewLink: "https://drive.google.com/file/d/1yhewdyE8Xc4ALB3Eo7CDzAFTsr_PHbK-/view?usp=drivesdk" }, { id: 4, name: "MIND YOUR MINORS BLOCK 3", price: 700, oldPrice: null, year: 1, isPrebook: false, images: ["https://i.imgur.com/6tFeXf5.jpeg", "https://i.imgur.com/rmStT8a.png", "https://i.imgur.com/rQ4hSiA.png", "https://i.imgur.com/kkNXowV.png"], description: "The newly launched minor subjects block 3 notes for 1st Year. Completely aligned with UHS LOs, featuring enhanced illustrations and high-yield mnemonics.", previewLink: "#" } ];
        let cart = [];
        let currentCheckoutStep = 1;
        const findProductById = (id) => products.find(p => p.id === id);
        function switchView(view) {
            mainContent.classList.add('hidden');
            header.classList.add('hidden');
            footer.classList.add('hidden');
            productPage.classList.add('hidden');
            checkoutPage.classList.add('hidden');
            document.querySelector('.sticky.top-0.z-50')?.classList.add('hidden');
            if (view === 'main') { mainContent.classList.remove('hidden'); header.classList.remove('hidden'); footer.classList.remove('hidden'); document.querySelector('.sticky.top-0.z-50')?.classList.remove('hidden'); } else if (view === 'product') { productPage.classList.remove('hidden'); } else if (view === 'checkout') { checkoutPage.classList.remove('hidden'); }
            window.scrollTo(0, 0);
        }
        const performSearch = (searchTerm, dropdownElement) => {
            if (!searchTerm.trim()) { dropdownElement.classList.add('hidden'); return; }
            const searchLower = searchTerm.toLowerCase();
            const matchingProducts = products.filter(p => p.name.toLowerCase().includes(searchLower) || (p.description && p.description.toLowerCase().includes(searchLower)));
            dropdownElement.innerHTML = matchingProducts.length > 0 ? '' : '<div class="search-dropdown-item text-gray-500">No products found</div>';
            matchingProducts.forEach(product => { const item = document.createElement('div'); item.className = 'search-dropdown-item'; item.textContent = product.name; item.addEventListener('click', () => { openProductPage(product.id); dropdownElement.classList.add('hidden'); if (searchInput) searchInput.value = ''; if (mobileSearchInput) mobileSearchInput.value = ''; }); dropdownElement.appendChild(item); });
            dropdownElement.classList.remove('hidden');
        };
        if (searchInput) searchInput.addEventListener('input', () => performSearch(searchInput.value, searchDropdown));
        if (mobileSearchInput) mobileSearchInput.addEventListener('input', () => performSearch(mobileSearchInput.value, mobileSearchDropdown));
        const updateCheckoutProgress = (step) => {
            stepIndicators.forEach((indicator) => { const stepNumber = parseInt(indicator.dataset.step); indicator.classList.toggle('active', stepNumber === step); indicator.classList.toggle('completed', stepNumber < step); });
            progressBar.style.width = `${((step - 1) / (stepIndicators.length - 1)) * 100}%`;
            currentCheckoutStep = step;
        };
        const showCheckoutStep = (step) => { checkoutSteps.forEach(s => s.classList.remove('active')); document.getElementById(`checkout-step-${step}`)?.classList.add('active'); updateCheckoutProgress(step); };
        const isBlock6InCart = () => cart.some(item => item.productId === 3);
        const isSpecialFormProduct = () => cart.some(item => item.productId === 3 || item.productId === 4);
        const toggleAimcPromo = () => { const isAimcSelected = checkoutCollegeSelect.value.includes('Allama Iqbal Medical College (AIMC), Lahore'); const showPromo = isAimcSelected && isBlock6InCart(); aimcPromoSection.classList.toggle('hidden', !showPromo); if (!showPromo) { promoCodeInput.value = ''; rollNumberEntry.classList.add('hidden'); rollNumberInput.value = ''; rollNumberInput.removeAttribute('required'); rollNumberFeedback.textContent = ''; formRollNumber.value = ''; } };
        checkoutCollegeSelect.addEventListener('change', () => { toggleAimcPromo(); updateCheckoutTotals(); });
        promoCodeInput.addEventListener('input', () => { const code = promoCodeInput.value.toUpperCase(); if (code === 'AIMC28') { rollNumberEntry.classList.remove('hidden'); rollNumberInput.setAttribute('required', 'required'); rollNumberFeedback.textContent = 'Promo code accepted. Please enter your Roll Number.'; rollNumberFeedback.className = 'text-[11px] mt-2 font-semibold text-green-600'; } else { rollNumberEntry.classList.add('hidden'); rollNumberInput.removeAttribute('required'); rollNumberInput.value = ''; rollNumberFeedback.textContent = 'Enter the correct code to proceed with the discount.'; rollNumberFeedback.className = 'text-[11px] mt-2 font-semibold text-gray-500'; } formRollNumber.value = ''; updateCheckoutTotals(); });
        rollNumberInput.addEventListener('input', () => { const roll = rollNumberInput.value.trim(); if (!isBackendReady) { rollNumberFeedback.textContent = 'Could not connect to the promo verification server.'; rollNumberFeedback.className = 'text-[11px] mt-2 font-semibold text-red-600'; updateCheckoutTotals(); return; } if (roll.length > 0) { const status = getRollNumberStatus(roll); rollNumberFeedback.textContent = status.message; rollNumberFeedback.className = `text-[11px] mt-2 font-semibold ${status.isValid ? 'text-green-600' : 'text-red-600'}`; } else { rollNumberFeedback.textContent = 'Please enter your Roll Number for verification.'; rollNumberFeedback.className = 'text-[11px] mt-2 font-semibold text-gray-500'; } formRollNumber.value = ''; updateCheckoutTotals(); });
        const calculateDiscount = () => { const isBlock6Present = isBlock6InCart(); const isAimcSelected = checkoutCollegeSelect.value.includes('Allama Iqbal Medical College (AIMC), Lahore'); const isPromoCodeCorrect = promoCodeInput.value.toUpperCase() === 'AIMC28'; if (isBlock6Present && isAimcSelected && isPromoCodeCorrect) { const roll = rollNumberInput.value.trim(); if (roll.length > 0 && getRollNumberStatus(roll).isValid) { const block6Item = cart.find(item => item.productId === 3); if(block6Item) return 100 * block6Item.quantity; } } return 0; };
        const updateCheckoutTotals = () => {
            let itemsTotal = cart.reduce((acc, item) => acc + item.price * item.quantity, 0);
            const discount = calculateDiscount();
            const city = citySelector.value;
            const deliveryCharge = cart.length > 0 && city ? calculateDeliveryCharge(city) : 0;
            const cityStatus = city === 'Lahore' ? 'Lahore' : 'Other City';
            const productSubtotalAfterDiscount = itemsTotal - discount;
            const finalTotal = productSubtotalAfterDiscount + deliveryCharge;
            paymentAmount.textContent = `Rs. ${Math.max(0, productSubtotalAfterDiscount).toLocaleString('en-PK')}`;
            checkoutFinalTotal.textContent = `Rs. ${Math.max(0, finalTotal).toLocaleString('en-PK')}`;
            document.getElementById('mobile-summary-total').textContent = `Rs. ${Math.max(0, finalTotal).toLocaleString('en-PK')}`;
            // Delivery Note Background Fixed: Removed bg-yellow-50, added bg-gray-50
            checkoutDeliveryNote.innerHTML = `<h5 class="text-base font-extrabold text-[#1A5693] algerya-sans-sc-font mb-2">Delivery Payment Note</h5><p class="text-xs">Delivery charges of <strong>Rs. ${deliveryCharge.toLocaleString('en-PK')}</strong> (${cityStatus}) <span class="font-extrabold underline">MUST BE PAID IN CASH TO THE RIDER</span> upon delivery. The total amount you pay online (Rs. ${Math.max(0, productSubtotalAfterDiscount).toLocaleString('en-PK')}) is for products only.</p>`;
            let cartSummary = [];
            checkoutSummaryList.innerHTML = '';
            
            const mobileCartMirror = document.querySelector('.mobile-cart-mirror');
            if (mobileCartMirror) mobileCartMirror.innerHTML = '';
            
            cart.forEach(item => { 
                const itemTotal = item.price * item.quantity; 
                const liHtml = `<li class="sidebar-row"><span class="sidebar-label">${item.name} <span class="text-xs text-gray-400">x${item.quantity}</span></span><span class="sidebar-value">Rs. ${itemTotal.toLocaleString('en-PK')}</span></li>`;
                checkoutSummaryList.insertAdjacentHTML('beforeend', liHtml);
                if (mobileCartMirror) mobileCartMirror.insertAdjacentHTML('beforeend', liHtml);
                cartSummary.push(`${item.name} x ${item.quantity} (Rs. ${itemTotal.toLocaleString('en-PK')})`); 
            });
            if (discount > 0) { 
                const discHtml = `<li class="sidebar-row text-green-600"><span class="sidebar-label text-green-600">AIMC Promo Discount</span><span class="sidebar-value">- Rs. ${discount.toLocaleString('en-PK')}</span></li>`;
                checkoutSummaryList.insertAdjacentHTML('beforeend', discHtml);
                if (mobileCartMirror) mobileCartMirror.insertAdjacentHTML('beforeend', discHtml);
                cartSummary.push(`Discount (Block 6): -Rs. ${discount.toLocaleString('en-PK')}`); 
            }
            if (deliveryCharge > 0) { 
                const delHtml = `<li class="sidebar-row pt-2 border-t border-gray-100"><span class="sidebar-label">Delivery (${cityStatus})</span><span class="sidebar-value">Rs. ${deliveryCharge.toLocaleString('en-PK')}</span></li><li class="text-[10px] text-gray-400 italic text-right -mt-1">Paid to rider in cash</li>`;
                checkoutSummaryList.insertAdjacentHTML('beforeend', delHtml);
                if (mobileCartMirror) mobileCartMirror.insertAdjacentHTML('beforeend', delHtml);
                cartSummary.push(`Delivery Charge (${cityStatus}): +Rs. ${deliveryCharge.toLocaleString('en-PK')} (Cash to Rider)`); 
            }
            document.getElementById('form-cart-details').value = cartSummary.join('; ');
            document.getElementById('form-final-bill').value = `Rs. ${Math.max(0, finalTotal).toLocaleString('en-PK')}`;
        };
        citySelector.addEventListener('change', updateCheckoutTotals);
        const validateStep = (stepNumber) => { const stepDiv = document.getElementById(`checkout-step-${stepNumber}`); const inputs = stepDiv.querySelectorAll('[required]'); let isValid = true; Array.from(inputs).forEach(input => { if (!input.checkValidity()) { isValid = false; input.reportValidity(); } if (input.type === 'radio' && !stepDiv.querySelector(`input[name="${input.name}"]:checked`)) isValid = false; }); if (stepNumber === 1 && !aimcPromoSection.classList.contains('hidden') && checkoutCollegeSelect.value.includes('AIMC') && promoCodeInput.value.toUpperCase() === 'AIMC28') { const roll = rollNumberInput.value.trim(); const status = getRollNumberStatus(roll); if (!status.isValid) { displayCustomAlert('Please enter a valid, unused AIMC roll number.'); isValid = false; } } if (stepNumber === 2) { const paymentSlip = document.getElementById('payment_slip'); if (paymentSlip && !paymentSlip.files.length) { displayCustomAlert('Please upload the payment slip to proceed.'); isValid = false; } } return isValid; };
        const openCheckoutPage = () => {
            if (cart.length === 0) return displayCustomAlert('Your cart is empty.');
            if (checkoutCollegeSelect.options.length <= 1) { const collegeFragment = document.createDocumentFragment(); PAKISTAN_MEDICAL_COLLEGES.forEach(college => { const option = document.createElement('option'); option.value = college; option.textContent = college; collegeFragment.appendChild(option); }); const otherCollegeOption = document.createElement('option'); otherCollegeOption.value = 'Other'; otherCollegeOption.textContent = 'Other (Please specify in Address)'; collegeFragment.appendChild(otherCollegeOption); checkoutCollegeSelect.appendChild(collegeFragment); }
            if (citySelector.options.length <= 1) { const cityFragment = document.createDocumentFragment(); CITIES_LIST.forEach(city => { const option = document.createElement('option'); option.value = city; option.textContent = city; cityFragment.appendChild(option); }); citySelector.appendChild(cityFragment); }
            showCartModal(false); toggleAimcPromo(); updateCheckoutTotals(); showCheckoutStep(1); checkoutStepsContainer.classList.remove('hidden'); checkoutSuccessPage.classList.add('hidden'); checkoutForm.reset(); switchView('checkout');
        };
        nextToPaymentBtn.addEventListener('click', () => { if (validateStep(1)) { if (promoCodeInput.value.toUpperCase() === 'AIMC28' && getRollNumberStatus(rollNumberInput.value.trim()).isValid) formRollNumber.value = rollNumberInput.value.trim(); else formRollNumber.value = ''; updateCheckoutTotals(); showCheckoutStep(2); } });
        backToShippingBtn.addEventListener('click', () => showCheckoutStep(1));
        nextToConfirmationBtn.addEventListener('click', () => { if (validateStep(2)) { updateCheckoutTotals(); showCheckoutStep(3); } });
        backToPaymentBtn.addEventListener('click', () => showCheckoutStep(2));
        checkoutForm.addEventListener('submit', function(e) {
            e.preventDefault(); if (!validateStep(1) || !validateStep(2) || !validateStep(3)) return; const submitButton = document.getElementById('confirm-order-btn'); submitButton.disabled = true; submitButton.textContent = 'Placing Order...';
            const formActionUrl = isSpecialFormProduct() ? BLOCK6_FORM_URL : PRODUCTS_FORM_URL; const orderId = `MOD-${Date.now()}-${Math.floor(Math.random() * 90000) + 10000}`; document.getElementById('form-order-id').value = orderId;
            const formData = new FormData(checkoutForm); const userName = formData.get('Full Name'); const usedRollNumber = formRollNumber.value.trim(); formData.set('Roll Number Used', usedRollNumber || 'N/A');
            const discountValue = calculateDiscount(); if (discountValue > 0) formData.set('Discount Applied', `Rs. ${discountValue.toLocaleString('en-PK')} (Fixed 100/item)`);
            const city = citySelector.value; const deliveryCharge = cart.length > 0 && city ? calculateDeliveryCharge(city) : 0; formData.set('Delivery Charge (Cash to Rider)', `Rs. ${deliveryCharge.toLocaleString('en-PK')}`);
            fetch(formActionUrl, { method: 'POST', body: formData }).then(response => { if (response.ok) { if (usedRollNumber) updateBackendWithUsedRollNumber(usedRollNumber); checkoutStepsContainer.classList.add('hidden'); checkoutSuccessPage.classList.remove('hidden'); document.getElementById('checkout-success-message').innerHTML = `Thank you, <strong>${userName}</strong>! <br> Your order number <strong>${orderId}</strong> has been received.`; cart = []; renderCart(); } else { throw new Error('Form submission failed.'); } }).catch(error => { displayCustomAlert('Error placing order.'); }).finally(() => { submitButton.disabled = false; submitButton.textContent = 'Confirm Order and Place'; });
        });
        proceedToCheckoutBtn.addEventListener('click', openCheckoutPage);
        const renderProductImages = (product) => { popupMainImage.src = product.images[0]; popupThumbnails.innerHTML = ''; product.images.forEach((url, index) => { const thumbnail = document.createElement('img'); thumbnail.src = url; thumbnail.alt = `${product.name} thumbnail ${index + 1}`; thumbnail.className = `w-12 h-12 sm:w-16 sm:h-16 rounded-lg object-cover cursor-pointer border-2 transition duration-150 hover:border-[#1A5693] ${index === 0 ? 'border-[#1A5693]' : 'border-transparent'}`; thumbnail.addEventListener('click', () => { popupMainImage.src = url; document.querySelectorAll('#popup-thumbnails img').forEach(img => img.classList.replace('border-[#1A5693]', 'border-transparent')); thumbnail.classList.replace('border-transparent', 'border-[#1A5693]'); }); popupThumbnails.appendChild(thumbnail); }); };
        const openProductPage = (productId) => { const id = parseInt(productId); const product = findProductById(id); if (!product) return; popupProductName.textContent = product.name; popupProductPrice.innerHTML = `<span class="algerya-sans-sc-font text-4xl sm:text-5xl leading-none">Rs.</span><span class="text-3xl leading-none">${product.price.toLocaleString('en-PK').replace('Rs.', '').trim()}</span>`; popupProductOldPrice.textContent = product.oldPrice ? `Rs. ${product.oldPrice.toLocaleString('en-PK')}` : ''; popupProductDescription.textContent = product.description; popupAddToCartBtn.onclick = () => { addToCart(id); switchView('main'); }; popupFreePreviewBtn.onclick = () => window.open(product.previewLink, '_blank'); const deliveryNotice = document.getElementById('popup-delivery-notice'); const featuresContainer = document.getElementById('popup-product-features'); if (product.id === 4) { deliveryNotice.className = "mt-4 mb-4 text-sm text-gray-700 font-medium"; deliveryNotice.innerHTML = "<strong>Estimated Delivery:</strong> Thursday/Friday (Lahore), Saturday (Other Cities)."; featuresContainer.innerHTML = `<div class="mt-4 mb-4"><h4 class="font-bold text-[#1A5693] mb-2 text-sm uppercase tracking-wide">Key Features:</h4><ul class="list-none text-sm text-gray-600 space-y-1"><li><i class="fas fa-check-circle text-green-500 mr-2"></i>From UHS Recommended books</li><li><i class="fas fa-check-circle text-green-500 mr-2"></i>Access to portal for quiz & past papers</li><li><i class="fas fa-check-circle text-green-500 mr-2"></i>Following all UHS LOs</li><li><i class="fas fa-check-circle text-green-500 mr-2"></i>Spiral binding & matte pages</li><li><i class="fas fa-check-circle text-green-500 mr-2"></i>Mnemonics</li><li><i class="fas fa-check-circle text-green-500 mr-2"></i>Illustrations</li></ul><p class="mt-6 text-center font-bold text-[#1A5693] text-sm italic border-t border-gray-100 pt-3">“Ace your minor subjects in minimum time with Mind Your Minors Block 3”</p></div>`; featuresContainer.classList.remove('hidden'); } else { deliveryNotice.className = "p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm text-[#1A5693]"; deliveryNotice.innerHTML = '<i class="fas fa-truck mr-2"></i> <strong>Order Today:</strong> Delivery by Thursday/Friday (Lahore) & Saturday (Other Cities).'; featuresContainer.innerHTML = ''; featuresContainer.classList.add('hidden'); } renderProductImages(product); switchView('product'); };
        const calculateTotals = () => { let subtotal = cart.reduce((acc, item) => acc + item.price * item.quantity, 0); let totalItems = cart.reduce((acc, item) => acc + item.quantity, 0); cartSubtotalElement.textContent = `Rs. ${subtotal.toLocaleString('en-PK')}`; cartTotalElement.textContent = `Rs. ${subtotal.toLocaleString('en-PK')}`; cartCountElements.forEach(el => el.textContent = totalItems); };
        const renderCart = () => { cartItemsContainer.innerHTML = ''; emptyCartMessage.classList.toggle('hidden', cart.length > 0); proceedToCheckoutBtn.disabled = cart.length === 0; cart.forEach(item => { const itemHtml = `<div class="flex items-center space-x-3 p-2 cart-item-card rounded-xl"><div class="flex-shrink-0 w-10 h-10 bg-gray-200 rounded-lg overflow-hidden"><img src="${item.image}" alt="${item.name}" class="w-full h-full object-contain"></div><div class="flex-grow"><p class="text-xs font-semibold text-gray-800">${item.name}</p><p class="text-[0.65rem] text-red-500 font-bold">Rs. ${item.price.toLocaleString('en-PK')}</p></div><div class="flex items-center space-x-1"><button data-id="${item.productId}" data-delta="-1" class="quantity-btn w-5 h-5 bg-gray-200 rounded-full text-xs font-bold text-gray-700 hover:bg-gray-300 transition touch-manipulation">-</button><span class="w-3 text-center text-xs font-semibold">${item.quantity}</span><button data-id="${item.productId}" data-delta="1" class="quantity-btn w-5 h-5 bg-[#E0F4FF] rounded-full text-xs font-bold text-[#1A5693] hover:bg-[#c9e8f9] transition touch-manipulation">+</button></div><div class="text-right w-12"><p class="text-xs font-bold text-[#1A5693]">Rs. ${(item.price * item.quantity).toLocaleString('en-PK')}</p></div></div>`; cartItemsContainer.insertAdjacentHTML('beforeend', itemHtml); }); document.querySelectorAll('.quantity-btn').forEach(button => button.addEventListener('click', handleQuantityChange)); calculateTotals(); };
        const showCartModal = (show = true) => { if (show) { renderCart(); cartModalOverlay.classList.remove('hidden'); void cartModal.offsetWidth; cartModal.classList.remove('scale-95', 'opacity-0'); cartModal.classList.add('scale-100', 'opacity-100'); } else { cartModal.classList.remove('scale-100', 'opacity-100'); cartModal.classList.add('scale-95', 'opacity-0'); setTimeout(() => cartModalOverlay.classList.add('hidden'), 300); } };
        const addToCart = (productId) => { const id = parseInt(productId); const product = findProductById(id); if (!product) return; const cartItem = cart.find(item => item.productId === id); if (cartItem) cartItem.quantity++; else cart.push({ productId: id, name: product.name, price: product.price, quantity: 1, image: product.images[0] }); showCartModal(true); };
        const handleQuantityChange = (e) => { e.preventDefault(); const productId = parseInt(e.currentTarget.dataset.id); const delta = parseInt(e.currentTarget.dataset.delta); const itemIndex = cart.findIndex(item => item.productId === productId); if (itemIndex > -1) { cart[itemIndex].quantity += delta; if (cart[itemIndex].quantity <= 0) cart.splice(itemIndex, 1); } renderCart(); if (currentCheckoutStep === 1) toggleAimcPromo(); };
        mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
        productTriggers.forEach(trigger => trigger.addEventListener('click', (e) => openProductPage(e.currentTarget.dataset.productId)));
        closeProductPageButton.addEventListener('click', () => switchView('main'));
        closeCheckoutButton.addEventListener('click', () => switchView('main'));
        cancelCheckoutBtn.addEventListener('click', () => switchView('main'));
        closeSuccessBtn.addEventListener('click', () => switchView('main'));
        document.querySelectorAll('.home-logo-link').forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); switchView('main'); }); });
        
        // Tabbed Content
        const heroTabs = document.querySelectorAll('.hero-tab-card'); const heroPanels = document.querySelectorAll('.tab-panel'); const heroSection = document.getElementById('hero-section'); const removeActiveClasses = () => { heroTabs.forEach(t => { t.classList.remove('active-custom-red', 'active-blue', 'active-pink'); }); }; heroTabs.forEach(tab => { tab.addEventListener('click', () => { removeActiveClasses(); const color = tab.getAttribute('data-color'); if (color === 'custom-red') tab.classList.add('active-custom-red'); else if (color === 'blue') tab.classList.add('active-blue'); else if (color === 'pink') tab.classList.add('active-pink'); heroSection.classList.remove('bg-red-50', 'bg-blue-50', 'bg-pink-50'); if (color === 'custom-red') heroSection.classList.add('bg-red-50'); else if (color === 'blue') heroSection.classList.add('bg-blue-50'); else if (color === 'pink') heroSection.classList.add('bg-pink-50'); heroPanels.forEach(panel => { panel.classList.remove('active'); panel.classList.add('hidden'); }); const targetId = tab.getAttribute('data-target'); const targetPanel = document.getElementById(`panel-${targetId}`); if (targetPanel) { targetPanel.classList.remove('hidden'); targetPanel.classList.add('active'); targetPanel.classList.remove('animate-fade-right'); void targetPanel.offsetWidth; targetPanel.classList.add('animate-fade-right'); } }); });
        
        // Scroll Reveal
        const revealElements = document.querySelectorAll('.reveal-on-scroll'); const revealObserver = new IntersectionObserver((entries, observer) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('is-visible'); observer.unobserve(entry.target); } }); }, { root: null, threshold: 0.1, rootMargin: "0px 0px -50px 0px" }); revealElements.forEach(el => revealObserver.observe(el));
        const setFilter = (targetYear) => { filterButtons.forEach(btn => { const isActive = btn.dataset.year === targetYear; btn.classList.toggle('active', isActive); btn.classList.toggle('text-white', isActive); btn.classList.toggle('text-gray-300', !isActive); btn.style.color = isActive ? '#1A5693' : '#6b7280'; }); productCards.forEach(card => { const isVisible = targetYear === 'all' || card.dataset.year === targetYear; card.classList.toggle('hidden', !isVisible); if (isVisible) { card.classList.remove('product-slide-up'); void card.offsetWidth; card.classList.add('product-slide-up'); } }); };
        filterButtons.forEach(button => button.addEventListener('click', (e) => setFilter(e.currentTarget.dataset.year)));
        document.querySelectorAll('.add-to-cart-btn').forEach(button => button.addEventListener('click', (e) => addToCart(e.currentTarget.dataset.productId)));
        document.getElementById('desktop-cart-button').addEventListener('click', () => showCartModal(true));
        document.getElementById('mobile-cart-button').addEventListener('click', () => showCartModal(true));
        document.getElementById('close-cart-button').addEventListener('click', () => showCartModal(false));
        cartModalOverlay.addEventListener('click', (e) => { if (e.target === cartModalOverlay) showCartModal(false); });

        setFilter('all'); calculateTotals();
    });
</script>
</body>
</html>

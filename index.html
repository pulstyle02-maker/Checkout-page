<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModMedicalis | Let the visuals speak</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Import Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Parisienne&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Lilita+One&display=swap');
        /* 5) ADDED: For the bottom notification and new sections */
        @import url('https://fonts.googleapis.com/css2?family=Londrina+Solid:wght@100;300;400;900&display=swap');
        
        /* 1) HEADER FONT FIX: Defining the requested custom font (using a generic sans-serif fallback) */
        @font-face {
            font-family: 'BBH SANS BOGLE';
            /* Note: Since this is a custom font, we use system fallbacks as the font file is not hosted */
            src: local('Arial'), local('Helvetica'), local('sans-serif'); 
            font-weight: 300;
        }
        
        /* 2) DYNAMIC GRADIENT ANIMATION for TOP RESOURCES - (No longer used by section, kept for potential future use) */
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* 1) NEW: Font for VISUALS and FREE RESOURCES */
        .londrina-solid-font {
            font-family: 'Londrina Solid', sans-serif;
            font-weight: 400;
        }

        /* 8) REMOVED DARK THEME: Keeping only Default Light Theme Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
            transition: background-color 0.3s, color 0.3s;
        }
        
        /* --- Custom Styles for New Requirements --- */
        
        /* REQUEST 2: Light Opacity White Grid Lines for TOP RESOURCES - MODIFIED FOR THICKER LINES */
        .grid-pattern-bg {
             /* Use a red gradient on the main element in HTML, and use this for the grid */
             position: absolute;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             z-index: 1; /* Below content (z-30) */
             /* MODIFIED: Increased opacity (0.1 -> 0.2) and thickness (1px -> 2px) */
             background-image: linear-gradient(to right, rgba(255, 255, 255, 0.2) 2px, transparent 2px),
                               linear-gradient(to bottom, rgba(255, 255, 255, 0.2) 2px, transparent 2px);
             background-size: 40px 40px; /* Increased size for visual distinction of thicker lines */
        }
        
        /* 3) NEW SECTION STYLES for FREE RESOURCES */
        .red-curved-section {
            background-color: #ef4444; /* bg-red-500/600 */
            border-bottom-left-radius: 50px; /* Custom curve */
            border-bottom-right-radius: 50px; /* Custom curve */
            position: relative;
            overflow: hidden;
            z-index: 1; /* Ensure content is above SVG */
        }
        
        .red-curved-section .content-z {
            position: relative;
            z-index: 10;
        }

        .medical-pattern-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.05; /* Low opacity */
        }
        
        /* Button style for CLICK TO AVAIL */
        .avail-btn {
            background-color: #1e293b; /* text-gray-900/slate-900 */
            color: white;
            padding: 1rem 2.5rem;
            font-weight: 700;
            border-radius: 1.5rem; /* More curved corners */
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .avail-btn:hover {
            background-color: #334155; /* Darker grey on hover */
            transform: translateY(-2px);
        }
        
        /* TOP RESOURCES Gradient Text - Unchanged */
        .top-resources-gradient {
            background: linear-gradient(90deg, #1A5693, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
            font-weight: 800;
        }
        
        /* FIXED FILTER STYLES for smooth transition - Unchanged */
        .filter-text-button {
            position: relative;
            cursor: pointer;
            padding: 0.5rem 1rem;
            font-weight: 700;
            transition: color 0.3s ease;
            padding-bottom: 0.75rem; 
        }
        
        .filter-text-button::after {
            content: '';
            position: absolute;
            left: 50%; 
            bottom: 0;
            height: 3px;
            width: 0;
            background-color: #3b82f6; 
            transition: width 0.3s ease, transform 0.3s ease;
            transform: translateX(-50%);
        }

        .filter-text-button.active {
            color: #3b82f6; 
        }
        
        /* IMPORTANT: Custom style to ensure filter underline is white in the TOP RESOURCES section */
        #filter-buttons-container .filter-text-button.active::after {
             background-color: white !important; /* Force white underline */
        }

        .filter-text-button.active::after {
            width: 100%;
        }
        
        /* REQUEST 2: Minimalist & Attractive Review Box Design (Removed fixed height to allow full text) */
        .review-box-design {
            background-color: white;
            border: 1px solid #e5e7eb; /* Light grey border */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); /* Subtle shadow */
            border-radius: 1rem; 
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 100%; /* Important: Allow box to grow with content */
        }
        
        .review-box-design:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        /* Optional minimalist flair: a subtle line on hover */
        .review-box-design::before {
             content: '';
             position: absolute;
             top: 0;
             left: 0;
             width: 100%;
             height: 4px;
             background-color: #1A5693; /* Dark Blue */
             transform: scaleX(0); /* Start hidden */
             transform-origin: left;
             transition: transform 0.3s ease;
        }
        
        .review-box-design:hover::before {
            transform: scaleX(1); /* Expand on hover */
        }
        /* END REQUEST 2 */


        /* 3) Product Modal Styles: Set background to WHITE & remove glass styles */
        .product-popup-overlay {
            z-index: 60; 
            background-color: rgba(0, 0, 0, 0.7);
        }

        /* FIX: Ensure modal background is white */
        #product-details-popup {
             background-color: white; /* FIX: Product modal should be white */
             max-width: 32rem; 
             /* REMOVE: backdrop-filter and -webkit-backdrop-filter are removed via class/inline style removal */
             /* REMOVE: border, and shadow are handled by Tailwind classes now */
        }

        .product-popup-image-container {
            width: 100%;
            padding-top: 125%; 
            position: relative;
            overflow: hidden;
            background-color: #f3f4f6;
        }
        
        .product-popup-image-container img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain; 
        }
        
        /* REQUEST 1: Product card styles changed from glass to white */
        .glass-card {
            background-color: #ffffff; /* Changed from rgba(255, 255, 255, 0.7) */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
        }

        /* Horizontal Carousel Styles (Applies to Products and Reviews) - Unchanged */
        .horizontal-scroll-container {
            display: flex;
            overflow-x: scroll;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 1rem;
        }

        /* Hide Scrollbar for Horizontal Carousel - Unchanged */
        .horizontal-scroll-container::-webkit-scrollbar {
            display: none; 
        }
        .horizontal-scroll-container {
            -ms-overflow-style: none;  
            scrollbar-width: none;  
        }
        /* End Hide Scrollbar */

        /* Product Card Specific Styles */
        .product-image-box {
            background-color: #e5e7eb; 
            position: relative;
            height: 9rem; 
            margin-bottom: 0.5rem; 
            cursor: pointer; 
        }
        .product-image-box img {
            /* REQUEST 1: Changed from cover to contain */
            object-fit: contain;
            width: 100%;
            height: 100%;
        }
        .product-card-title {
            /* REQUEST 3: Decreased size from 1.125rem */
            font-size: 1rem; 
            line-height: 1.2;
            font-weight: 900; 
            text-transform: uppercase;
            cursor: pointer; 
        }
        .product-price-main {
            color: #ef4444; 
            /* REQUEST 3: Decreased size from 1.5rem */
            font-size: 1.25rem; 
            font-weight: 900;
        }
        .product-price-cut {
            color: #9ca3af; 
            text-decoration: line-through;
            font-size: 0.875rem; 
        }
        .add-to-cart-btn {
            width: 2rem; 
            height: 2rem; 
            font-size: 1.25rem; 
            background-color: #1e293b; 
            color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            position: absolute; 
            bottom: 0.75rem; 
            right: 0.75rem; 
        }
        /* Cart item card style MODIFIED to red/blue combo with white grid lines */
        .cart-item-card {
            background-color: #fff; /* Base white color */
            border: 1px solid #e5e7eb; /* Light grey border */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            /* NEW: White grid lines for cart items (subtle) */
            background-image: linear-gradient(to right, #ffffff 1px, transparent 1px),
                              linear-gradient(to bottom, #ffffff 1px, transparent 1px);
            background-size: 15px 15px; 
        }
        
        /* REQUEST 2: Animation for product filter */
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .product-slide-up {
          animation: slideUp 0.4s ease-out forwards;
        }
        /* End Request 2 */

        /* Sliding Feature Row Styles - Unchanged */
        @keyframes slide { from { transform: translateX(0); } to { transform: translateX(-50%); } }
        .sliding-row { display: flex; width: fit-content; animation: slide 30s linear infinite; }
        .sliding-item-container { display: inline-block; white-space: nowrap; padding-right: 50vw; }
        .sliding-feature-box { display: inline-flex; align-items: center; padding: 0.5rem 1rem; background-color: #ffffff; border-radius: 9999px; margin: 0 1rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05); }
        .sliding-feature-text { background: linear-gradient(90deg, #3b82f6, #f25f61, #facc15); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; color: transparent; font-weight: 700; font-size: 0.875rem; }
        .sliding-row:nth-child(2) { animation-direction: reverse; animation-duration: 35s; }
        .parisienne-font { font-family: 'Parisienne', cursive; font-weight: 400; }
        .playfair-font { font-family: 'Playfair Display', serif; font-weight: 800; }
        .insight-banner-bg { background-image: linear-gradient(to right, #1A5693, #3b82f6); color: #ffffff; }
        .insight-text-yellow { color: #facc15; font-weight: 700; }
        @keyframes floatAndRotate { 0% { transform: translate(0, 0) rotate(0deg); } 33% { transform: translate(10px, -10px) rotate(3deg); } 66% { transform: translate(-8px, 8px) rotate(-2deg); } 100% { transform: translate(0, 0) rotate(0deg); } }
        .dynamic-bg-img { position: absolute; opacity: 0.12; background-size: contain; background-repeat: no-repeat; pointer-events: none; animation: floatAndRotate 20s ease-in-out infinite alternate; }
        .dynamic-bg-img:nth-child(1) { top: 5%; left: 5%; width: 80px; height: 80px; animation-duration: 22s; animation-delay: 0s; } .dynamic-bg-img:nth-child(2) { top: 40%; left: 15%; width: 70px; height: 70px; animation-duration: 25s; animation-delay: 2s; animation-direction: alternate-reverse; } .dynamic-bg-img:nth-child(3) { top: 10%; right: 10%; width: 90px; height: 90px; animation-duration: 18s; animation-delay: 4s; } .dynamic-bg-img:nth-child(4) { bottom: 10%; right: 5%; width: 60px; height: 60px; animation-duration: 20s; animation-delay: 6s; animation-direction: alternate-reverse; } .dynamic-bg-img:nth-child(5) { bottom: 25%; left: 8%; width: 50px; height: 50px; animation-duration: 28s; animation-delay: 8s; } .dynamic-bg-img:nth-child(6) { top: 55%; right: 20%; width: 85px; height: 85px; animation-duration: 23s; animation-delay: 10s; animation-direction: alternate-reverse; } .dynamic-bg-img:nth-child(7) { top: 30%; left: 25%; width: 65px; height: 65px; animation-duration: 24s; animation-delay: 1s; } .dynamic-bg-img:nth-child(8) { top: 70%; left: 5%; width: 75px; height: 75px; animation-duration: 26s; animation-delay: 3s; animation-direction: alternate; } .dynamic-bg-img:nth-child(9) { top: 45%; right: 5%; width: 80px; height: 80px; animation-duration: 19s; animation-delay: 5s; animation-direction: alternate-reverse; } .dynamic-bg-img:nth-child(10) { bottom: 20%; right: 25%; width: 55px; height: 55px; animation-duration: 21s; animation-delay: 7s; } .dynamic-bg-img:nth-child(11) { top: 15%; left: 40%; width: 60px; height: 60px; animation-duration: 29s; animation-delay: 9s; animation-direction: alternate; } .dynamic-bg-img:nth-child(12) { bottom: 5%; left: 35%; width: 70px; height: 70px; animation-duration: 17s; animation-delay: 11s; animation-direction: alternate-reverse; }

        /* --- NEW: Image Comparison Slider Styles (Minimalist) --- */
        .comparison-container {
            position: relative;
            overflow: hidden;
            /* Maintain Aspect Ratio - Adjust height based on expected image size */
            padding-top: 75%; /* 4:3 aspect ratio (3/4 = 0.75 * 100) */
            max-width: 42rem; 
            margin: 0 auto;
            user-select: none;
            cursor: ew-resize;
            border-radius: 1rem; 
            /* FIX 1: The subtle shadow from the comparison slider section is removed from the HTML class, 
               but no box-shadow property existed here to remove. The change is made in the HTML. */
        }

        .comparison-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* FIX 1: Prevent image cropping from top/bottom */
            object-fit: contain; 
            transition: clip-path 0.3s ease-out; 
            -webkit-transition: clip-path 0.3s ease-out;
            pointer-events: none; 
        }
        
        .comparison-image.after {
            clip-path: inset(0 0 0 50%); 
            -webkit-clip-path: inset(0 0 0 50%);
        }

        .comparison-line {
            position: absolute;
            top: 0;
            left: 50%; 
            /* FIX 4: Make the sliding line more prominent */
            width: 6px; 
            height: 100%;
            background-color: #1A5693; /* Dark Blue */
            transform: translateX(-50%);
            z-index: 20;
            transition: left 0.3s ease-out;
            pointer-events: none;
            border-radius: 9999px; /* Round the line ends */
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); /* Subtle shadow for depth */
        }

        .slider-handle {
            position: absolute;
            top: 50%;
            left: 50%; 
            /* FIX 5: Slightly larger/more prominent handle */
            width: 40px;
            height: 40px;
            background-color: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 30;
            transition: left 0.3s ease-out;
            pointer-events: none; 
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); /* Shadow for lift */
        }
        
        /* FIX 5: Use clean SVG-like arrows (removed :before/:after and replaced with SVG inside HTML) */
        
        /* --- END NEW: Image Comparison Slider Styles --- */

        /* --- REQUEST 1: Tilted Image Style --- */
        .tilted-overlap-image {
            position: absolute;
            top: -2.5rem; /* Adjust to overlap header */
            right: 0.5rem;
            width: 120px; 
            height: 120px; 
            z-index: 20; /* Above the red section content, below the fixed header (z-40) */
            transform: rotate(10deg); /* Slight tilt */
            object-fit: contain;
            pointer-events: none; /* Ignore clicks */
        }
        /* --- REQUEST 3: Logo Font Style --- */
        .logo-font {
            font-family: 'Lilita One', cursive;
            background: linear-gradient(90deg, #1A5693, #ef4444); /* Blue to Red Gradient */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
        }
        
        /* REQUEST 1: Pop-up Notification Styles - CHANGED FROM GLASSY TO LIGHT BLUE */
        .prebook-notification-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* Darker overlay */
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
        }

        .prebook-notification-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .prebook-notification-popup {
            background-color: #eff6ff; /* bg-blue-50 - Light Blue */
            border: 2px solid #93c5fd; /* border-blue-300 */
            box-shadow: 0 10px 25px 0 rgba(0, 0, 0, 0.3);
            border-radius: 16px;
            color: #1e293b; /* Dark text for contrast */
            padding: 1.5rem;
            max-width: 90%;
            width: 380px;
            transform: scale(0.9);
            transition: transform 0.3s ease-in-out;
            position: relative;
            text-align: center;
        }
        
        .prebook-notification-overlay.active .prebook-notification-popup {
             transform: scale(1);
        }
        
        .close-popup-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #dbeafe; /* Light blue background for close button */
            border-radius: 50%;
            padding: 4px;
            line-height: 1;
            cursor: pointer;
            transition: background 0.2s;
        }
        .close-popup-btn:hover {
            background: #93c5fd; /* Darker blue on hover */
        }
        
        /* Party-like animation for pre-book success */
        @keyframes confetti-fall {
            0% { opacity: 1; transform: translateY(-100%) rotate(0deg); }
            100% { opacity: 0; transform: translateY(100vh) rotate(720deg); }
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--color);
            border-radius: 50%;
            animation: confetti-fall var(--duration) linear infinite;
        }
        
        /* Utility class to hide overflow on the body during animations */
        .overflow-hidden-body {
            overflow: hidden;
        }

        /* CHANGE 2 & 4: Style for hiding the bottom notification bar */
        #bottom-notification-bar.hidden-down {
            transform: translateY(150%);
        }

        /* NEW: Progress bar styles for checkout flow */
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background-color: #e5e7eb;
            border-radius: 4px;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #1A5693, #3b82f6);
            border-radius: 4px;
            transition: width 0.5s ease-in-out;
        }
        
        .checkout-step {
            display: none;
        }
        
        .checkout-step.active {
            display: block;
        }
        
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            position: relative;
        }
        
        .step-indicator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #e5e7eb;
            transform: translateY(-50%);
            z-index: 1;
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 2;
            position: relative;
            flex: 1;
        }
        
        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #6b7280;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .step.active .step-circle {
            background-color: #1A5693;
            color: white;
        }
        
        .step.completed .step-circle {
            background-color: #10b981;
            color: white;
        }
        
        .step-label {
            font-size: 0.75rem;
            color: #6b7280;
            text-align: center;
        }
        
        .step.active .step-label {
            color: #1A5693;
            font-weight: 600;
        }
        
        .step.completed .step-label {
            color: #10b981;
        }
        
        .checkout-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }
        
        /* NEW: Search dropdown styles */
        .search-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            max-height: 200px;
            overflow-y: auto;
            z-index: 50;
        }
        
        .search-dropdown-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.2s;
        }
        
        .search-dropdown-item:hover {
            background-color: #f9fafb;
        }
        
        .search-dropdown-item:last-child {
            border-bottom: none;
        }

        /* NEW: Force light theme */
        @media (prefers-color-scheme: dark) {
            body {
                background-color: #f8fafc !important;
                color: #1e293b !important;
            }
        }

    </style>
</head>
<body class="min-h-screen antialiased">

    <div class="bg-red-600 text-white text-center py-2 text-xs font-semibold sticky top-0 z-50">
        Mind your minors BLOCK 6 on its way!
        <button class="ml-2 px-2 py-0.5 bg-white text-red-600 rounded-full text-xs font-bold hover:bg-gray-100 transition duration-200" onclick="showPopup()">
            Prebook now &rarr;
        </button>
    </div>

    <header class="bg-white shadow-lg sticky top-8 md:top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-14 sm:h-16">
                <a href="javascript:location.reload()" class="flex-shrink-0 flex items-center">
                    <img src="https://i.imgur.com/osPp3Sa.jpeg" alt="ModMedicalis Logo" class="h-10 sm:h-12 w-auto rounded-lg">
                </a>
                
                <nav class="hidden md:flex items-center space-x-6">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="Search products..." class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693] w-64">
                        <button id="search-button" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-600 hover:text-[#1A5693]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                        </button>
                        <div id="search-dropdown" class="search-dropdown hidden"></div>
                    </div>
                    <button id="desktop-cart-button" class="relative text-gray-600 hover:text-[#1A5693] transition duration-150">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.38a2 2 0 0 0 1.84-1.11L22 7H4"/></svg>
                        <span id="desktop-cart-count" class="absolute -top-1 -right-1 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-[#1A5693] rounded-full">0</span>
                    </button>
                </nav>

                <div class="flex items-center md:hidden space-x-4">
                    <button id="mobile-cart-button" class="relative text-gray-600 hover:text-[#1A5693] transition duration-150">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.38a2 2 0 0 0 1.84-1.11L22 7H4"/></svg>
                        <span id="mobile-cart-count" class="absolute -top-1 -right-1 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-[#1A5693] rounded-full">0</span>
                    </button>
                    <button id="mobile-menu-button" class="text-gray-600 hover:text-[#1A5693]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100">
            <div class="px-4 py-3 space-y-2">
                <div class="relative w-full">
                    <input type="text" id="mobile-search-input" placeholder="Search products..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693]">
                    <button id="mobile-search-button" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-600 hover:text-[#1A5693]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    </button>
                    <div id="mobile-search-dropdown" class="search-dropdown hidden"></div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="pt-6 pb-12 sm:pt-6 sm:pb-16 bg-white relative overflow-hidden">
            <div class="absolute inset-0 z-0">
                </div>
            
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">

                <div class="inline-block px-3 py-1.5 insight-banner-bg rounded-full text-xs font-medium mb-6 shadow-md">
                    Pakistan's first <span class="insight-text-yellow">insightful</span> platform for MBBS
                </div>

                <h1 class="text-3xl sm:text-6xl font-extrabold tracking-tight mb-4">
                    <span class="text-3xl sm:text-6xl text-gray-700" style="font-family: 'BBH SANS BOGLE', sans-serif; font-weight: 300;">When the words get dull</span>
                    <div class="text-[#1A5693] text-5xl sm:text-7xl mt-1 mb-3 londrina-solid-font">
                        Let the <span class="text-red-600" style="font-family: 'Londrina Solid', sans-serif; font-weight: 400;">VISUALS</span> speak!
                    </div>
                </h1>
                
                <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
                    </div>
            </div>
            
        </section>

        <section class="py-3 bg-gray-100 overflow-hidden border-y border-gray-200 space-y-2">
            
            <div class="flex">
                <div class="sliding-row">
                    <div class="sliding-item-container">
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Aligned with UHS LOs &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">From UHS recommended books &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Mnemonics &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Illustration &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Past papers &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">OSPE &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Online quiz & flashcards &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Flowcharts &rsaquo;</span></span>
                    </div>
                    <div class="sliding-item-container">
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Aligned with UHS LOs &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">From UHS recommended books &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Mnemonics &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Illustration &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Past papers &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">OSPE &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Online quiz & flashcards &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Flowcharts &rsaquo;</span></span>
                    </div>
                </div>
            </div>

            <div class="flex">
                <div class="sliding-row">
                    <div class="sliding-item-container">
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Mnemonics &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Illustration &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Aligned with UHS LOs &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Past papers &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">From UHS recommended books &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Flowcharts &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Online quiz & flashcards &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">OSPE &rsaquo;</span></span>
                    </div>
                    <div class="sliding-item-container">
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Mnemonics &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Illustration &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Aligned with UHS LOs &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Past papers &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">From UHS recommended books &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Flowcharts &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">Online quiz & flashcards &rsaquo;</span></span>
                        <span class="sliding-feature-box"><span class="sliding-feature-text">OSPE &rsaquo;</span></span>
                    </div>
                </div>
            </div>
            
        </section>

        <section id="notes" class="py-12 sm:py-20 mx-0 mt-8 mb-4 shadow-2xl bg-red-600 relative overflow-hidden">
            <div class="grid-pattern-bg"></div>

            <img src="https://i.imgur.com/QRYh6HS.png" alt="Medical Diagram" class="tilted-overlap-image">

             <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-30">
                 <h2 class="text-2xl sm:text-4xl font-bold mb-4 text-white">
                     TOP RESOURCES
                 </h2>
                 
                 <div id="filter-buttons-container" class="flex justify-center space-x-6 mb-8">
                    <span id="filter-all" data-year="all" class="filter-text-button active text-base text-white" style="color: white;">ALL</span> 
                    <span id="filter-1st" data-year="1" class="filter-text-button text-base text-gray-300">1st Year</span>
                    <span id="filter-2nd" data-year="2" data-year="2" class="filter-text-button text-base text-gray-300">2nd Year</span>
                 </div>

                 <div id="product-container" class="horizontal-scroll-container">
                    
                    <div class="glass-card snap-center flex-shrink-0 w-48 p-3 rounded-xl text-center product-card mr-3" data-year="1" data-product-id="1">
                        <div class="product-image-box rounded-lg flex items-center justify-center product-trigger" data-product-id="1">
                            <img src="https://i.imgur.com/c4XSHmA.jpeg" alt="Block 2 Flashcards" class="rounded-lg">
                        </div>
                        
                        <h3 class="product-card-title text-gray-900 mb-0.5 product-trigger" data-product-id="1">BLOCK 2 FLASHCARDS</h3>
                        
                        <div class="flex flex-col items-center justify-center space-y-0.5">
                            <span class="product-price-cut text-xs">Rs. 1100 (pkr)</span>
                            <span class="product-price-main">Rs. 900</span>
                        </div>
                        
                        <button class="add-to-cart-btn rounded-full flex items-center justify-center" data-product-id="1">
                            <span class="text-xl font-light leading-none">+</span>
                        </button>
                    </div>

                    <div class="glass-card snap-center flex-shrink-0 w-48 p-3 rounded-xl text-center product-card mr-3 hidden" data-year="2" data-product-id="2">
                        <div class="product-image-box rounded-lg flex items-center justify-center product-trigger" data-product-id="2">
                            <img src="https://i.imgur.com/mTnWoeB.png" alt="Mind Your Minors Block 5" class="rounded-lg">
                            <span class="absolute top-1 left-1 text-xs font-bold text-white bg-blue-500 px-2 py-0.5 rounded-full shadow-md">BEST VALUE</span>
                        </div>
                        
                        <h3 class="product-card-title text-gray-900 mb-0.5 product-trigger" data-product-id="2">MIND YOUR MINORS - BLOCK 5</h3>
                        
                        <div class="flex flex-col items-center justify-center space-y-0.5">
                            <span class="product-price-main">Rs. 500</span>
                        </div>
                        
                        <button class="add-to-cart-btn rounded-full flex items-center justify-center" data-product-id="2">
                            <span class="text-xl font-light leading-none">+</span>
                        </button>
                    </div>

                    <div class="glass-card snap-center flex-shrink-0 w-48 p-3 rounded-xl text-center product-card mr-3 hidden" data-year="2" data-product-id="3">
                        <div class="product-image-box rounded-lg flex items-center justify-center product-trigger" data-product-id="3">
                             <img src="https://i.imgur.com/wLiYfOr.jpeg" alt="Mind Your Minors Block 6" class="rounded-lg">
                        </div>
                        
                        <div class="text-center text-gray-300 text-xs font-medium my-2">
                            Pre-book only
                        </div>
                        
                        <h3 class="product-card-title text-gray-900 mb-0.5 product-trigger" data-product-id="3">MIND YOUR MINORS - BLOCK 6</h3>
                        
                        <div class="flex flex-col items-center justify-center space-y-0.5 mt-2">
                            <span class="text-base font-bold text-red-300">Launching Soon...</span>
                        </div>
                        
                        <button class="absolute bottom-3 right-3 px-2 py-1 bg-gradient-to-r from-blue-500 to-[#1A5693] text-white text-xs font-semibold rounded-full shadow-lg hover:shadow-xl transition duration-200" onclick="showPrebookModal()">
                            Pre-book
                        </button>
                    </div>
                    
                 </div>

             </div>
        </section>
        <section class="pt-6 pb-12 sm:pt-8 sm:pb-16 bg-gray-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-2xl sm:text-4xl font-extrabold text-center mb-8 text-gray-900">
                    <span class="text-[#1A5693]">SEE WHAT</span> STUDENTS SAY
                </h2>

                <div class="horizontal-scroll-container pb-0 space-x-4">
                    
                    <div class="snap-center flex-shrink-0 w-72 sm:w-80 p-5 review-box-design">
                        <div class="flex items-center space-x-1 text-yellow-500 text-base mb-2">
                            <span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span>
                        </div>
                        <p class="italic text-gray-700 mb-3 text-sm leading-relaxed">
                            "your FLASHCARDS are super effective and a lifesaver indeed...really admire your efforts behind these &lt;3 BIG thanks for the mnemonics !!"
                        </p>
                        <div class="font-bold text-gray-900 text-sm">MBBS Student</div>
                        <div class="text-xs text-gray-500">1st year MBBS student AIMC</div>
                    </div>

                    <div class="snap-center flex-shrink-0 w-72 sm:w-80 p-5 review-box-design">
                        <div class="flex items-center space-x-1 text-yellow-500 text-base mb-2">
                            <span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span>
                        </div>
                        <p class="italic text-gray-700 mb-3 text-sm leading-relaxed">
                            "Mind your minors is literally a v good initiative. The illustrations are quite appealing and all the minors being covered in a book with past ppr questions is cherry on top.... The quality of book is great. Thank yuh so much for your kind efforts"
                        </p>
                        <div class="font-bold text-gray-900 text-sm">MBBS Student</div>
                        <div class="text-xs text-gray-500">2nd year MBBS student AIMC</div>
                    </div>

                    <div class="snap-center flex-shrink-0 w-72 sm:w-80 p-5 review-box-design">
                        <div class="flex items-center space-x-1 text-yellow-500 text-base mb-2">
                            <span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span>
                        </div>
                        <p class="italic text-gray-700 mb-3 text-sm leading-relaxed">
                            "9.5/10. The idea, the design, the packaging and a good initiative for helping students achieve marks in minor subjects. Near to perfect. May ALLAH grant you with great success and fulfil your desires. Ameen"
                        </p>
                        <div class="font-bold text-gray-900 text-sm">Hamza</div>
                        <div class="text-xs text-gray-500">1st year central park medical college</div>
                    </div>
                    
                    <div class="snap-center flex-shrink-0 w-72 sm:w-80 p-5 review-box-design">
                        <div class="flex items-center space-x-1 text-yellow-500 text-base mb-2">
                            <span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span>
                        </div>
                        <p class="italic text-gray-700 mb-3 text-sm leading-relaxed">
                            "AJ ke assessment mein pharmacology ke all 3 LOS THAY AND 9 MCQS THAY ALL COVERED FROM FLASHCARDS"
                        </p>
                        <div class="font-bold text-gray-900 text-sm">Abd-ur-Rehman</div>
                        <div class="text-xs text-gray-500">1st year MBBS Sialkot medical college</div>
                    </div>

                    <div class="snap-center flex-shrink-0 w-72 sm:w-80 p-5 review-box-design">
                        <div class="flex items-center space-x-1 text-yellow-500 text-base mb-2">
                            <span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span><span>⭐️</span>
                        </div>
                        <p class="italic text-gray-700 mb-3 text-sm leading-relaxed">
                            "For the first time in my life i have recieved a book in this packaging ... and everything is on top notch ... quality over everything More powers to you guys"
                        </p>
                        <div class="font-bold text-gray-900 text-sm">Meerab Murtaza</div>
                        <div class="text-xs text-gray-500">2nd year MBBS AIMC</div>
                    </div>

                </div>
            </div>
        </section>
        <section id="comparison-slider" class="py-6 sm:py-8 bg-gray-900">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-2xl sm:text-4xl font-extrabold text-white mb-8">
                    <span class="text-[#1A5693]"></span> COMPARISON
                </h2>

                <div id="image-comparison-wrapper" class="comparison-container rounded-xl">
                    <!-- SWAPPED POSITION OF PICTURES -->
                    <img id="image-before" src="https://i.imgur.com/kPxsoe1.jpeg" alt="UHS Recommended Book" class="comparison-image">
                    <img id="image-after" src="https://i.imgur.com/3yiZGYe.png" alt="Our Notes" class="comparison-image after">
                    
                    <div id="comparison-line" class="comparison-line">
                        <div id="slider-handle" class="slider-handle">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#1A5693" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 absolute left-0 ml-1">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#1A5693" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 absolute right-0 mr-1">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between max-w-lg mx-auto mt-4 text-lg font-bold">
                    <span class="text-[#1A5693]">Book View</span> 
                    <span class="text-white">Our Notes</span> 
                </div>
            </div>
        </section>

        <section class="py-12 sm:py-20 red-curved-section mb-4">
            <svg class="medical-pattern-svg" viewBox="0 0 100 100" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <pattern id="medicalPattern" patternUnits="userSpaceOnUse" width="20" height="20">
                        <path d="M 10 0 L 10 20 M 0 10 L 20 10" stroke="#fef2f2" stroke-width="1.5" />
                        <path d="M 5 5 Q 10 0 15 5 Q 20 10 15 15 Q 10 20 5 15" fill="none" stroke="#fef2f2" stroke-width="0.5" />
                        <path d="M 0 12 L 5 12 L 7 8 L 9 16 L 11 8 L 13 12 L 20 12" fill="none" stroke="#fef2f2" stroke-width="0.25" />
                    </pattern>
                </defs>
                <rect width="100%" height="100%" fill="url(#medicalPattern)" />
            </svg>
            
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center content-z">
                <h2 class="text-4xl sm:text-6xl font-extrabold text-white mb-8 londrina-solid-font">
                    FREE RESOURCES
                </h2>
                <a href="https://modmedicalis.online/FREE-RESOURCES" class="avail-btn">
                    CLICK TO AVAIL
                </a>
                <p class="text-white text-opacity-80 mt-4 text-sm font-medium">Flashcards, Quizzes, Past Papers & UHS Notes</p>
            </div>
        </section>
        
        <section class="py-12 sm:py-20 bg-gray-100 border-t border-gray-200">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-2xl sm:text-4xl font-extrabold text-center mb-10 text-gray-900">
                    <span class="text-red-600">MESSAGE FROM THE</span> <span class="text-[#1A5693]">FOUNDER</span>
                </h2>
                
                <div class="p-6 sm:p-8 bg-white rounded-xl shadow-2xl border-t-0">
                    <p class="italic text-gray-700 mb-6 text-base leading-relaxed">
                        Mind Your Minors was born from the real struggles of every medical student; endless notes, massive books, and not enough time. We wanted to change the way students learn, making it smarter, simpler, and more visual. Each page blends clarity with creativity, turning complex topics into quick, memorable insights. Designed by students who've been in your shoes, this book makes learning the minor subjects not a burden, but a breakthrough in your MBBS journey.
                    </p>
                    
                    <div class="flex items-center justify-end space-x-4 pt-4 border-t border-gray-100">
                        <div class="text-right">
                            <p class="font-bold text-lg text-gray-900">Muhammad Hasnain</p>
                            <p class="text-sm text-[#1A5693] font-semibold">Founder, ModMedicalis</p>
                        </div>
                        <img src="https://i.imgur.com/2y4pFZW.jpeg" alt="Founder's Photo" class="h-16 w-16 rounded-full object-cover ring-2 ring-[#1A5693] p-0.5">
                    </div>
                </div>
            </div>
        </section>
        
        <section class="py-12 sm:py-20 bg-gray-50 border-t border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-2xl sm:text-4xl font-extrabold text-center mb-10 text-gray-900">
                    <span class="text-[#1A5693]">OUR</span> TEAM
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-8">
                    
                    <div class="flex flex-col items-center text-center p-4 bg-white rounded-xl shadow-lg hover:shadow-xl transition duration-300">
                        <img src="https://i.imgur.com/2y4pFZW.jpeg" alt="Muhammad Hasnain Photo" class="h-24 w-24 rounded-full object-cover ring-4 ring-red-600 mb-3">
                        <p class="font-bold text-lg text-gray-900">Muhammad Hasnain</p>
                        <p class="text-sm text-red-600 font-semibold">Founder | Developer | Graphic designer</p>
                        <p class="text-xs text-gray-500 mt-1">MS-II (AIMC)</p>
                    </div>
                    
                    <div class="flex flex-col items-center text-center p-4 bg-white rounded-xl shadow-lg hover:shadow-xl transition duration-300">
                        <img src="https://i.imgur.com/RbGRiTF.jpeg" alt="Hamza Masood Gondal Photo" class="h-24 w-24 rounded-full object-cover ring-4 ring-red-600 mb-3">
                        <p class="font-bold text-lg text-gray-900">Hamza Masood Gondal</p>
                        <p class="text-sm text-red-600 font-semibold">Co-Founder | 1st Position holder AIMC (MS-I)</p>
                        <p class="text-xs text-gray-500 mt-1">MS-II (AIMC)</p>
                    </div>
                    
                    <div class="flex flex-col items-center text-center p-4 bg-white rounded-xl shadow-lg hover:shadow-xl transition duration-300">
                        <img src="https://i.imgur.com/A3rIAiM.jpeg" alt="Mahrukh Nadeem Photo" class="h-24 w-24 rounded-full object-cover ring-4 ring-red-600 mb-3">
                        <p class="font-bold text-lg text-gray-900">Mahrukh Nadeem</p>
                        <p class="text-sm text-red-600 font-semibold">Admin | Designer</p>
                        <p class="text-xs text-gray-500 mt-1">MS-II (AIMC)</p>
                    </div>
                    
                    <div class="flex flex-col items-center text-center p-4 bg-white rounded-xl shadow-lg hover:shadow-xl transition duration-300">
                        <img src="https://i.imgur.com/VQH3Rqp.png" alt="Hadia Gulshan Photo" class="h-24 w-24 rounded-full object-cover ring-4 ring-red-600 mb-3">
                        <p class="font-bold text-lg text-gray-900">Hadia Gulshan</p>
                        <p class="text-sm text-red-600 font-semibold">Graphic designer</p>
                        <p class="text-xs text-gray-500 mt-1">MS-II (AIMC)</p>
                    </div>

                </div>
                </div>
        </section>
        
        </main>
    
    <footer id="contact" class="bg-gray-800 text-white py-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-lg font-bold text-[#1A5693] mb-3">MODMEDICALIS</h3>
                    <p class="text-xs text-gray-400">Your trusted partner for medical education excellence.</p>
                    <p class="text-xs text-gray-400 mt-3">&copy; 2025 ModMedicalis</p>
                    <p class="text-xs text-gray-400 mt-3">
                        Developed by <span class="text-xl font-extrabold logo-font">HASNAIN & MAHRUKH</span>
                    </p>
                </div>

                <div>
                    <h4 class="text-base font-semibold mb-3">Quick Links</h4>
                    <ul class="space-y-1 text-sm">
                        <li><a href="#notes" class="text-gray-400 hover:text-[#1A5693]">TOP RESOURCES</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-[#1A5693]">Order Tracking</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-base font-semibold mb-3">Resources</h4>
                    <ul class="space-y-1 text-sm">
                        <li><a href="https://modmedicalis.online/FREE-RESOURCES" class="text-gray-400 hover:text-[#1A5693]">FREE RESOURCES</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-base font-semibold mb-3">Get In Touch</h4>
                    <p class="text-sm text-gray-400">Email: modmedicalis@gmail.com</p>
                    <p class="text-sm text-gray-400">Phone: 03096554421</p>
                </div>
            </div>
        </div>
    </footer>
    
    <div id="cart-modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div id="cart-modal" class="bg-white rounded-xl shadow-2xl w-full max-w-sm sm:max-w-md transform transition-all duration-300 scale-95 opacity-0">
            <div class="p-4 border-b flex justify-between items-center bg-red-600 rounded-t-xl">
                <h3 class="text-xl font-bold text-white">Your Cart 🛒</h3>
                <button id="close-cart-button" class="text-red-200 hover:text-white transition p-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            
            <div id="cart-items-container" class="p-4 max-h-72 overflow-y-auto space-y-3">
                <p id="empty-cart-message" class="text-gray-500 text-center italic text-sm">Your cart is empty.</p>
            </div>
            
            <div id="cart-footer" class="p-4 border-t space-y-2 rounded-b-xl bg-blue-50">
                <div class="flex justify-between font-semibold text-gray-700 text-sm">
                    <span>Subtotal:</span>
                    <span id="cart-subtotal">Rs. 0</span>
                </div>
                <div class="flex justify-between text-lg font-extrabold text-red-600">
                    <span>Total:</span>
                    <span id="cart-total">Rs. 0</span>
                </div>
                <button id="proceed-to-checkout-btn" class="w-full bg-[#1A5693] text-white py-2 rounded-lg font-bold text-sm hover:bg-blue-700 transition duration-200 shadow-lg">
                    Proceed to Checkout
                </button>
            </div>
        </div>
    </div>
    
    <div id="checkout-modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
        <div id="checkout-modal" class="bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[95vh] overflow-y-auto transform transition-all duration-300 scale-95 opacity-0">
            <div class="p-4 border-b flex justify-between items-center bg-[#1A5693] rounded-t-xl">
                <h3 class="text-xl font-bold text-white">Checkout</h3>
                <button id="close-checkout-button" class="text-blue-200 hover:text-white transition p-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            
            <!-- NEW: Progress Bar -->
            <div class="p-4 border-b">
                <div class="step-indicator">
                    <div class="step active" data-step="1">
                        <div class="step-circle">1</div>
                        <div class="step-label">Shipping</div>
                    </div>
                    <div class="step" data-step="2">
                        <div class="step-circle">2</div>
                        <div class="step-label">Payment</div>
                    </div>
                    <div class="step" data-step="3">
                        <div class="step-circle">3</div>
                        <div class="step-label">Confirmation</div>
                    </div>
                </div>
                <div class="progress-bar-container">
                    <div id="checkout-progress-bar" class="progress-bar" style="width: 33%"></div>
                </div>
            </div>
            
            <!-- NEW: Multi-step checkout form -->
            <form id="checkout-form">
                <input type="hidden" name="_subject" value="ModMedicalis Order Confirmation">
                <input type="hidden" name="_template" value="table">
                <input type="hidden" name="Cart Details" id="form-cart-details">
                <input type="hidden" name="Final Bill" id="form-final-bill">

                <!-- Step 1: Shipping Details -->
                <div id="checkout-step-1" class="checkout-step active p-6 space-y-5">
                    <h4 class="text-lg font-bold text-gray-700">Shipping Details</h4>
                    <hr class="border-gray-100">

                    <div>
                        <label for="full_name" class="block text-sm font-medium text-gray-700 mb-1">FULL NAME</label>
                        <input type="text" id="full_name" name="FULL NAME" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693]">
                    </div>

                    <div>
                        <label for="college" class="block text-sm font-medium text-gray-700 mb-1">SELECT COLLEGE</label>
                        <select id="college" name="COLLEGE" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693]">
                            <option value="" disabled selected>Select your medical college</option>
                            <optgroup label="Public Medical Colleges (Sample)">
                                <option value="KEMU">King Edward Medical University (KEMU)</option>
                                <option value="AIMC">Allama Iqbal Medical College (AIMC)</option>
                                <option value="FJMC">Fatima Jinnah Medical University (FJMU)</option>
                                <option value="GMC">Services Institute of Medical Sciences (SIMS)</option>
                                <option value="PGMI">Postgraduate Medical Institute (PGMI)</option>
                                <option value="DMC">Dow Medical College (DMC)</option>
                                <option option value="A-I-K-M-U">Aga Khan University Hospital (AKUH)</option>
                                <option option value="P-I-M-S">Pakistan Institute of Medical Sciences (PIMS)</option>
                                <option value="B-O-K-C">Bolan Medical College (BMC)</option>
                                <option value="Q-U-A-I-D-E-M-C">Quaid-e-Azam Medical College (QAMC)</option>
                                <option value="L-I-A-Q-A-T-M-C">Liaquat University of Medical and Health Sciences (LUMHS)</option>
                                <option value="K-P-K">Khyber Medical College (KMC)</option>
                                <option value="N-I-U-M-S">National University of Medical Sciences (NUMS)</option>
                                <option value="R-A-W-A-L-P-I-N-D-I">Rawalpindi Medical University (RMU)</option>
                            </optgroup>
                            <optgroup label="Private Medical Colleges (Sample)">
                                <option value="CMH-L">CMH Lahore Medical College</option>
                                <option value="FMH">Fatima Memorial Hospital (FMH)</option>
                                <option value="RMU">Riphah International University</option>
                                <option value="SKMCH">Shaukat Khanum Memorial Cancer Hospital</option>
                                <option value="LCMD">Lahore Central College of Medicine and Dentistry</option>
                                <option value="SMU">Shaheed Zulfiqar Ali Bhutto Medical University (SZABMU)</option>
                                <option value="I-M-C-H">Indus Medical College and Hospital (IMCH)</option>
                                <option value="S-H-I-E-L-D">Shield College of Medicine and Dentistry (SCMD)</option>
                                <option value="P-K-R-I">Pak International Medical College (PIMC)</option>
                                <option value="M-A-R-Y-A-M-I-N-T">Maryam International Medical College (MIMC)</option>
                            </optgroup>
                            <option value="Other">Other (Please specify in Address)</option>
                        </select>
                    </div>

                    <div>
                        <label for="contact_number" class="block text-sm font-medium text-gray-700 mb-1">CONTACT NUMBER</label>
                        <input type="tel" id="contact_number" name="CONTACT NUMBER" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693]">
                    </div>

                    <div>
                        <label for="shipping_address" class="block text-sm font-medium text-gray-700 mb-1">SHIPPING ADDRESS (Full Details for Courier)</label>
                        <textarea id="shipping_address" name="SHIPPING ADDRESS" rows="3" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693]"></textarea>
                    </div>
                    
                    <div class="checkout-navigation">
                        <button type="button" id="cancel-checkout-btn" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition duration-200">
                            Cancel
                        </button>
                        <button type="button" id="next-to-payment-btn" class="px-4 py-2 bg-[#1A5693] text-white rounded-lg font-medium hover:bg-blue-700 transition duration-200">
                            Next: Payment Details
                        </button>
                    </div>
                </div>

                <!-- Step 2: Payment Details -->
                <div id="checkout-step-2" class="checkout-step p-6 space-y-5">
                    <h4 class="text-lg font-bold text-gray-700">Payment Details</h4>
                    <hr class="border-gray-100">

                    <div class="bg-gray-100 p-4 rounded-lg border border-gray-200 text-center">
                        <p class="text-sm font-semibold text-gray-800 mb-2">PAYMENT TO:</p>
                        <p class="text-lg font-bold text-gray-900">MUHAMMAD HASNAIN</p>
                        <div class="flex items-center justify-center space-x-2 mt-2">
                            <span id="payment-number" class="text-lg font-mono text-blue-600">03096554421</span>
                            <button type="button" onclick="copyPaymentNumber()" class="bg-blue-600 text-white px-3 py-1 rounded-lg text-xs font-semibold hover:bg-blue-700 transition">Copy</button>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Jazzcash / Easypaisa</p>
                        <p class="text-base font-extrabold text-red-600 mt-3">
                            Total Amount: <span id="payment-amount">Rs. 0</span>
                        </p>
                    </div>
                    
                    <div>
                        <label for="payment_slip" class="block text-sm font-medium text-gray-700 mb-1">Upload Payment Slip (Required for confirmation)</label>
                        <input type="file" id="payment_slip" name="Upload Payment Slip" accept="image/*,.pdf" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-[#1A5693] focus:border-[#1A5693] text-sm">
                    </div>
                    
                    <h4 class="text-lg font-bold text-gray-700 pt-3">How did you hear about us?</h4>
                    <hr class="border-gray-100">
                    
                    <div class="space-y-2">
                        <div class="flex items-center">
                            <input id="source-ambassador" name="How do you know about us?" type="radio" value="Ambassador" required class="h-4 w-4 text-[#1A5693] border-gray-300 focus:ring-[#1A5693]">
                            <label for="source-ambassador" class="ml-3 block text-sm font-medium text-gray-700">Ambassador</label>
                        </div>
                        <div class="flex items-center">
                            <input id="source-social" name="How do you know about us?" type="radio" value="Social Media" class="h-4 w-4 text-[#1A5693] border-gray-300 focus:ring-[#1A5693]">
                            <label for="source-social" class="ml-3 block text-sm font-medium text-gray-700">Social Media</label>
                        </div>
                        <div class="flex items-center">
                            <input id="source-colleagues" name="How do you know about us?" type="radio" value="Colleagues" class="h-4 w-4 text-[#1A5693] border-gray-300 focus:ring-[#1A5693]">
                            <label for="source-colleagues" class="ml-3 block text-sm font-medium text-gray-700">Colleagues</label>
                        </div>
                        <div class="flex items-center">
                            <input id="source-other" name="How do you know about us?" type="radio" value="Other" class="h-4 w-4 text-[#1A5693] border-gray-300 focus:ring-[#1A5693]">
                            <label for="source-other" class="ml-3 block text-sm font-medium text-gray-700">Other</label>
                        </div>
                    </div>
                    
                    <div class="checkout-navigation">
                        <button type="button" id="back-to-shipping-btn" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition duration-200">
                            Back
                        </button>
                        <button type="button" id="next-to-confirmation-btn" class="px-4 py-2 bg-[#1A5693] text-white rounded-lg font-medium hover:bg-blue-700 transition duration-200">
                            Next: Confirmation
                        </button>
                    </div>
                </div>

                <!-- Step 3: Order Confirmation -->
                <div id="checkout-step-3" class="checkout-step p-6 space-y-5">
                    <h4 class="text-lg font-bold text-gray-700">Order Confirmation</h4>
                    <hr class="border-gray-100">
                    
                    <div class="p-3 bg-red-50 rounded-lg border border-red-200">
                        <h5 class="text-lg font-extrabold text-red-600">Final Bill & Order Confirmation</h5>
                        <ul id="checkout-summary-list" class="text-sm text-gray-700 mt-1 space-y-0.5">
                        </ul>
                        <div class="flex justify-between font-extrabold text-[#1A5693] mt-2 pt-2 border-t border-red-200">
                            <span>TOTAL:</span>
                            <span id="checkout-final-total">Rs. 0</span>
                        </div>
                    </div>
                    
                    <div class="checkout-navigation">
                        <button type="button" id="back-to-payment-btn" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-400 transition duration-200">
                            Back
                        </button>
                        <button type="button" id="confirm-order-btn" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition duration-200">
                            Confirm Order & Upload Slip
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <div id="prebook-page-overlay" class="hidden fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4">
        <div id="prebook-page-modal" class="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[95vh] overflow-y-auto transform transition-all duration-300 scale-95 opacity-0">
            
            <div id="prebook-page-content">
                <div class="p-4 border-b flex justify-between items-center bg-red-600 rounded-t-xl">
                    <h3 class="text-xl font-bold text-white">Pre-Book: Mind Your Minors Block 6</h3>
                    <button id="close-prebook-page-button" class="text-red-200 hover:text-white transition p-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                    </button>
                </div>

                <form id="prebook-form">
                    <input type="hidden" name="_subject" value="MYM-6 PRE-BOOKING">
                    <input type="hidden" name="_template" value="table">

                    <div class="p-6 space-y-6">
                        <div class="flex flex-col items-center text-center space-y-4">
                            <img src="https://i.imgur.com/wLiYfOr.jpeg" alt="Mind Your Minors Block 6 Preview" class="w-40 h-40 object-contain rounded-lg shadow-lg border border-gray-200">
                            <h4 class="text-2xl font-extrabold text-[#1A5693]">Mind Your Minors - Block 6</h4>
                            <p class="text-sm text-gray-600 italic">"The ultimate visual guide for your minor subjects. Secure your 15% discount now!"</p>
                        </div>

                        <div>
                            <label for="prebook_name" class="block text-sm font-medium text-gray-700 mb-1">FULL NAME</label>
                            <input type="text" id="prebook_name" name="FULL NAME" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-red-600 focus:border-red-600">
                        </div>

                        <div>
                            <label for="prebook_college" class="block text-sm font-medium text-gray-700 mb-1">COLLEGE</label>
                            <input type="text" id="prebook_college" name="COLLEGE" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-red-600 focus:border-red-600" placeholder="e.g., King Edward Medical University">
                        </div>
                        
                        <div class="space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <label class="block text-base font-bold text-[#1A5693]">How should we inform you? (Select One)</label>
                            <div class="space-y-2">
                                <div class="flex items-center">
                                    <input id="inform-email" name="Inform Via" type="radio" value="Email" required class="h-4 w-4 text-red-600 border-gray-300 focus:ring-red-600" data-target="email-entry">
                                    <label for="inform-email" class="ml-3 block text-sm font-medium text-gray-700">Inform me via Email</label>
                                </div>
                                <div id="email-entry" class="hidden pl-8">
                                    <input type="email" id="prebook_email" name="EMAIL" placeholder="Your Email Address" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-red-600 focus:border-red-600">
                                </div>
                            </div>
                            <div class="space-y-2">
                                <div class="flex items-center">
                                    <input id="inform-whatsapp" name="Inform Via" type="radio" value="WhatsApp" class="h-4 w-4 text-red-600 border-gray-300 focus:ring-red-600" data-target="whatsapp-entry">
                                    <label for="inform-whatsapp" class="ml-3 block text-sm font-medium text-gray-700">Inform me via WhatsApp</label>
                                </div>
                                <div id="whatsapp-entry" class="hidden pl-8">
                                    <input type="tel" id="prebook_whatsapp" name="WHATSAPP NUMBER" placeholder="Your WhatsApp Number (e.g., 03xx-xxxxxxx)" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-red-600 focus:border-red-600">
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="w-full bg-red-600 text-white py-3 rounded-lg font-bold text-base hover:bg-red-700 transition duration-200 shadow-lg">
                            COMPLETE PRE-BOOK & CLAIM 15% OFF
                        </button>
                    </div>
                </form>
            </div>

            <div id="prebook-success-page" class="hidden p-8 text-center bg-white rounded-xl">
                 <h3 class="text-5xl font-extrabold text-red-600 londrina-solid-font mb-4">
                     YAYYYY! 🎉
                 </h3>
                 <p class="text-4xl font-extrabold text-[#1A5693] mb-6">YOU GOT 15% OFF!</p>
                 <!-- CHANGE 4: Removed yellow background, replaced with light green -->
                 <div id="success-message-info" class="text-lg font-semibold text-gray-800 p-4 bg-green-100 rounded-lg border border-green-200">
                 </div>
                 <button onclick="closePrebookModal(true)" class="mt-8 bg-green-500 text-white py-3 px-8 rounded-lg font-bold text-base hover:bg-green-600 transition duration-200 shadow-lg">
                     Close
                 </button>
            </div>
            
        </div>
    </div>
    
    <div id="product-details-popup-overlay" class="product-popup-overlay hidden fixed inset-0 flex items-center justify-center p-4">
        <div id="product-details-popup" class="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[95vh] overflow-y-auto transform transition-all duration-300 scale-95 opacity-0">
            
            <div class="sticky top-0 p-3 border-b flex justify-end bg-white rounded-t-xl z-10">
                <button id="close-product-popup-button" class="text-gray-500 hover:text-gray-900 transition p-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            
            <div class="grid md:grid-cols-1 gap-4 p-4"> 
                <div class="space-y-3"> 
                    <div id="popup-image-carousel" class="w-full relative">
                        <div class="product-popup-image-container rounded-xl shadow-lg"> 
                            <img id="popup-main-image" src="" alt="Product Main Image">
                        </div>
                        <div id="popup-thumbnails" class="flex space-x-2 mt-3 overflow-x-auto justify-center">
                            </div>
                    </div>
                </div>
                
                <div class="space-y-4"> 
                    <h2 id="popup-product-name" class="text-2xl font-extrabold text-[#1A5693]"></h2>
                    
                    <div class="flex items-center space-x-2">
                         <span id="popup-product-price" class="text-3xl font-extrabold text-red-600"></span>
                         <span id="popup-product-old-price" class="text-base text-gray-400 line-through"></span>
                    </div>
                    
                    <p id="popup-product-description" class="text-gray-700 leading-relaxed text-sm">
                        </p>
                    
                    <div class="flex flex-col space-y-3 pt-2">
                        <button id="popup-add-to-cart-btn" class="w-full bg-[#1A5693] text-white py-2.5 rounded-lg font-bold text-base hover:bg-blue-700 transition duration-200 shadow-lg flex items-center justify-center space-x-2 disabled:opacity-50" data-product-id="">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.38a2 2 0 0 0 1.84-1.11L22 7H4"/></svg>
                            <span>Add to cart</span>
                        </button>
                        <button id="popup-free-preview-btn" class="w-full bg-gray-200 text-gray-800 py-2.5 rounded-lg font-bold text-base hover:bg-gray-300 transition duration-200 shadow-md flex items-center justify-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
                            <span>Click for free preview</span>
                        </button>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    
    <!-- CHANGE 2 & 4: Added ID and transition classes for JS control -->
    <div id="bottom-notification-bar" class="fixed bottom-0 left-0 w-full z-[100] text-center transition-transform duration-300 ease-in-out">
        <div class="bg-red-600 text-white py-2 px-4 shadow-2xl rounded-t-xl rounded-b-none mx-2 sm:mx-4 md:mx-8">
             <p class="londrina-solid-font text-xl sm:text-2xl tracking-wider">
                 AVAIL 15% OFF IN PREBOOKING!
             </p>
        </div>
    </div>
    
    <div id="prebook-notification-popup-overlay" class="prebook-notification-overlay">
        <div id="prebook-notification-popup" class="prebook-notification-popup">
            <button class="close-popup-btn" onclick="hidePopup()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x text-gray-800"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </button>
            <div class="flex flex-col items-center space-y-4">
                <img src="https://i.imgur.com/wLiYfOr.jpeg" alt="Mind Your Minors Block 6" class="w-32 h-32 object-contain rounded-lg shadow-lg">
                <p class="text-2xl font-extrabold text-[#1A5693] londrina-solid-font tracking-wider">
                    PREBOOK MIND YOUR MINORS BLOCK 6
                </p>
                <p class="text-4xl font-extrabold text-red-600">
                    & CLAIM 15% OFF!!
                </p>
                <p class="text-xs font-semibold text-gray-700 italic border-t pt-2 w-full">
                    Offer valid till launching of the book
                </p>
                <button onclick="hidePopup(); showPrebookModal();" class="w-full bg-red-600 text-white py-2 rounded-lg font-bold hover:bg-red-700 transition duration-200 shadow-md">
                    Prebook Now
                </button>
            </div>
        </div>
    </div>


    <script>
        // CHANGE 3: Function to copy payment number
        function copyPaymentNumber() {
            const number = '03096554421';
            navigator.clipboard.writeText(number).then(() => {
                alert('Number copied to clipboard!'); // You can replace this with a more subtle notification
            }, (err) => {
                alert('Failed to copy number.');
                console.error('Could not copy text: ', err);
            });
        }

        // --- College List Data ---
        const PAKISTAN_MEDICAL_COLLEGES = [
            // Public Colleges (A comprehensive list sample)
            'King Edward Medical University (KEMU), Lahore',
            'Allama Iqbal Medical College (AIMC), Lahore',
            'Fatima Jinnah Medical University (FJMU), Lahore',
            'Services Institute of Medical Sciences (SIMS), Lahore',
            'Postgraduate Medical Institute (PGMI), Lahore',
            'Dow Medical College (DMC), Karachi',
            'Jinnah Sindh Medical University (JSMU), Karachi',
            'Khyber Medical College (KMC), Peshawar',
            'Ayub Medical College (AMC), Abbottabad',
            'Rawalpindi Medical University (RMU), Rawalpindi',
            'Quaid-e-Azam Medical College (QAMC), Bahawalpur',
            'Liaquat University of Medical and Health Sciences (LUMHS), Jamshoro',
            'Bolan Medical College (BMC), Quetta',
            'Nishtar Medical University (NMU), Multan',
            'Shaikh Zayed Medical College (SZMC), Rahim Yar Khan',
            'Gujranwala Medical College (GMC), Gujranwala',
            'Sialkot Medical College (SMC), Sialkot',
            'Faisalabad Medical University (FMU), Faisalabad',
            'National University of Medical Sciences (NUMS) Colleges',
            'PIMS Medical College, Islamabad',
            // Private Colleges (A comprehensive list sample)
            'CMH Lahore Medical College',
            'FMH College of Medicine and Dentistry, Lahore',
            'Azra Naheed Medical College (ANMC), Lahore',
            'Continental Medical College (CMC), Lahore',
            'Lahore Medical & Dental College (LMDC), Lahore',
            'University College of Medicine and Dentistry (UCMD), Lahore',
            'Shalamar Medical and Dental College (SMDC), Lahore',
            'Aga Khan University Hospital (AKUH), Karachi',
            'Liaquat College of Medicine and Dentistry (LCMD), Karachi',
            'Indus Medical College, Tando Muhammad Khan',
            'Wah Medical College, Wah Cantt',
            'Riphah International University, Islamabad',
            'Foundation University Medical College (FUMC), Rawalpindi',
            'Islamabad Medical and Dental College (IMDC)',
            'Karachi Medical and Dental College (KMDC)',
            'Ziauddin Medical University, Karachi',
            'Other' // Final 'Other' option
        ];

        // REQUEST 3: Popup Show/Hide Functions for sticky notification
        const stickyPrebookPopupOverlay = document.getElementById('prebook-notification-popup-overlay');

        function showPopup() {
            stickyPrebookPopupOverlay.classList.add('active');
        }

        function hidePopup() {
            stickyPrebookPopupOverlay.classList.remove('active');
        }
        
        // Show the popup on page load after a delay (e.g., 2 seconds)
        window.addEventListener('load', () => {
             // Delay showing the pop-up to allow the user to see the page first
             setTimeout(showPopup, 2000); 
        });
        
        // Close popup when clicking outside (on the overlay)
        stickyPrebookPopupOverlay.addEventListener('click', (e) => {
            if (e.target === stickyPrebookPopupOverlay) {
                hidePopup();
            }
        });


        document.addEventListener('DOMContentLoaded', () => {
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            const filterButtons = document.querySelectorAll('.filter-text-button');
            const productCards = document.querySelectorAll('.product-card');
            const productTriggers = document.querySelectorAll('.product-trigger'); 
            
            // --- Search Elements ---
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            const searchDropdown = document.getElementById('search-dropdown');
            const mobileSearchInput = document.getElementById('mobile-search-input');
            const mobileSearchButton = document.getElementById('mobile-search-button');
            const mobileSearchDropdown = document.getElementById('mobile-search-dropdown');
            
            // --- Cart Elements ---
            const cartModalOverlay = document.getElementById('cart-modal-overlay');
            const cartModal = document.getElementById('cart-modal');
            const cartItemsContainer = document.getElementById('cart-items-container');
            const emptyCartMessage = document.getElementById('empty-cart-message');
            const cartSubtotalElement = document.getElementById('cart-subtotal');
            const cartTotalElement = document.getElementById('cart-total');
            const cartCountElements = document.querySelectorAll('[id$="-cart-count"]');
            const proceedToCheckoutBtn = document.getElementById('proceed-to-checkout-btn');
            
            // --- Checkout Elements (REQUEST 4) ---
            const checkoutModalOverlay = document.getElementById('checkout-modal-overlay');
            const checkoutModal = document.getElementById('checkout-modal');
            const closeCheckoutButton = document.getElementById('close-checkout-button');
            const paymentAmount = document.getElementById('payment-amount');
            const checkoutSummaryList = document.getElementById('checkout-summary-list');
            const checkoutFinalTotal = document.getElementById('checkout-final-total');
            const checkoutCollegeSelect = document.getElementById('college');
            
            // NEW: Multi-step checkout elements
            const checkoutSteps = document.querySelectorAll('.checkout-step');
            const stepIndicators = document.querySelectorAll('.step');
            const progressBar = document.getElementById('checkout-progress-bar');
            const nextToPaymentBtn = document.getElementById('next-to-payment-btn');
            const backToShippingBtn = document.getElementById('back-to-shipping-btn');
            const nextToConfirmationBtn = document.getElementById('next-to-confirmation-btn');
            const backToPaymentBtn = document.getElementById('back-to-payment-btn');
            const cancelCheckoutBtn = document.getElementById('cancel-checkout-btn');
            const confirmOrderBtn = document.getElementById('confirm-order-btn');
            
            // --- Pre-book Elements (REQUEST 5) ---
            const prebookPageOverlay = document.getElementById('prebook-page-overlay');
            const prebookPageModal = document.getElementById('prebook-page-modal');
            const prebookPageContent = document.getElementById('prebook-page-content');
            const prebookSuccessPage = document.getElementById('prebook-success-page');
            const closePrebookPageButton = document.getElementById('close-prebook-page-button');
            const prebookForm = document.getElementById('prebook-form');
            const informViaRadios = document.querySelectorAll('input[name="Inform Via"]');
            const emailEntry = document.getElementById('email-entry');
            const whatsappEntry = document.getElementById('whatsapp-entry');
            const prebookEmailInput = document.getElementById('prebook_email');
            const prebookWhatsappInput = document.getElementById('prebook_whatsapp');
            
            // --- Product Popup Elements ---
            const productPopupOverlay = document.getElementById('product-details-popup-overlay');
            const productPopup = document.getElementById('product-details-popup');
            const closeProductPopupButton = document.getElementById('close-product-popup-button');
            const popupMainImage = document.getElementById('popup-main-image');
            const popupThumbnails = document.getElementById('popup-thumbnails');
            const popupProductName = document.getElementById('popup-product-name');
            const popupProductPrice = document.getElementById('popup-product-price');
            const popupProductOldPrice = document.getElementById('popup-product-old-price');
            const popupProductDescription = document.getElementById('popup-product-description');
            const popupAddToCartBtn = document.getElementById('popup-add-to-cart-btn');
            const popupFreePreviewBtn = document.getElementById('popup-free-preview-btn');
            
            // CHANGE 2 & 4: Get the bottom notification bar
            const bottomNotificationBar = document.getElementById('bottom-notification-bar');

            // --- Product Data Model (UPDATED with removal of Anatomy Essentials) ---
            const products = [
                { 
                    id: 1, 
                    name: "BLOCK 2 FLASHCARDS", 
                    price: 900, 
                    oldPrice: 1100, 
                    year: 1, 
                    isPrebook: false,
                    images: ["https://i.imgur.com/c4XSHmA.jpeg"],
                    description: "",
                    previewLink: "https://drive.google.com/file/d/1QFJiBzPELwVWcaVi7VWnDrIr-bwm5qBy/view?usp=drivesdk"
                },
                { 
                    id: 2, 
                    name: "MIND YOUR MINORS - BLOCK 5", 
                    price: 500, 
                    oldPrice: null, 
                    year: 2, 
                    isPrebook: false,
                    images: ["https://i.imgur.com/mTnWoeB.png"], 
                    description: "Get ready to ace your minor subjects with our illustrative notes & say good bye to boring books. Completely alligned with UHS LOs & recommended books",
                    previewLink: "https://drive.google.com/file/d/1LDBgWhSP6xeWDqxyKyutZ7tOijrx_uuS/view?usp=drivesdk"
                },
                { 
                    id: 3, 
                    name: "MIND YOUR MINORS - BLOCK 6", 
                    price: 0, 
                    oldPrice: null, 
                    year: 2, 
                    isPrebook: true,
                    images: ["https://i.imgur.com/wLiYfOr.jpeg", "https://i.imgur.com/3d96vIC.jpeg", "https://i.imgur.com/iAdfNwC.png", "https://i.imgur.com/e9WIdYm.jpeg"],
                    description: "Pre-book access for the upcoming minor subjects block notes. Secure your copy of the next high-demand resource for Second Year MBBS before the official launch. Special early-bird content included.",
                    previewLink: "https://drive.google.com/file/d/1yhewdyE8Xc4ALB3Eo7CDzAFTsr_PHbK-/view?usp=drivesdk"
                }
            ];
            
            let cart = []; // Cart state: [{ productId: 1, quantity: 1, name: "...", price: 900, image: "..." }, ...]
            let currentCheckoutStep = 1;

            // --- Helper Functions ---
            
            /** Finds product details by ID. */
            const findProductById = (id) => products.find(p => p.id === id);
            
            // --- Search Functionality ---
            const performSearch = (searchTerm, dropdownElement) => {
                if (!searchTerm.trim()) {
                    dropdownElement.classList.add('hidden');
                    return;
                }
                
                const searchLower = searchTerm.toLowerCase();
                const matchingProducts = products.filter(product => 
                    product.name.toLowerCase().includes(searchLower) || 
                    (product.description && product.description.toLowerCase().includes(searchLower))
                );
                
                if (matchingProducts.length === 0) {
                    dropdownElement.innerHTML = '<div class="search-dropdown-item text-gray-500">No products found</div>';
                    dropdownElement.classList.remove('hidden');
                    return;
                }
                
                dropdownElement.innerHTML = '';
                matchingProducts.forEach(product => {
                    const item = document.createElement('div');
                    item.className = 'search-dropdown-item';
                    item.textContent = product.name;
                    item.addEventListener('click', () => {
                        showProductPopup(product.id);
                        dropdownElement.classList.add('hidden');
                        if (searchInput) searchInput.value = '';
                        if (mobileSearchInput) mobileSearchInput.value = '';
                    });
                    dropdownElement.appendChild(item);
                });
                
                dropdownElement.classList.remove('hidden');
            };
            
            // Search event listeners
            if (searchInput && searchDropdown) {
                searchInput.addEventListener('input', () => {
                    performSearch(searchInput.value, searchDropdown);
                });
                
                searchInput.addEventListener('focus', () => {
                    if (searchInput.value.trim()) {
                        performSearch(searchInput.value, searchDropdown);
                    }
                });
                
                // Hide dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!searchInput.contains(e.target) && !searchDropdown.contains(e.target)) {
                        searchDropdown.classList.add('hidden');
                    }
                });
            }
            
            if (mobileSearchInput && mobileSearchDropdown) {
                mobileSearchInput.addEventListener('input', () => {
                    performSearch(mobileSearchInput.value, mobileSearchDropdown);
                });
                
                mobileSearchInput.addEventListener('focus', () => {
                    if (mobileSearchInput.value.trim()) {
                        performSearch(mobileSearchInput.value, mobileSearchDropdown);
                    }
                });
                
                // Hide dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!mobileSearchInput.contains(e.target) && !mobileSearchDropdown.contains(e.target)) {
                        mobileSearchDropdown.classList.add('hidden');
                    }
                });
            }
            
            // --- NEW: Multi-step Checkout Functions ---
            const updateCheckoutProgress = (step) => {
                // Update step indicators
                stepIndicators.forEach((indicator, index) => {
                    const stepNumber = index + 1;
                    if (stepNumber < step) {
                        indicator.classList.remove('active');
                        indicator.classList.add('completed');
                    } else if (stepNumber === step) {
                        indicator.classList.add('active');
                        indicator.classList.remove('completed');
                    } else {
                        indicator.classList.remove('active', 'completed');
                    }
                });
                
                // Update progress bar
                const progressPercentage = ((step - 1) / 2) * 100;
                progressBar.style.width = `${progressPercentage}%`;
                
                // Update current step
                currentCheckoutStep = step;
            };
            
            const showCheckoutStep = (step) => {
                checkoutSteps.forEach(checkoutStep => {
                    checkoutStep.classList.remove('active');
                });
                
                document.getElementById(`checkout-step-${step}`).classList.add('active');
                updateCheckoutProgress(step);
            };
            
            // --- Pre-book Modal Functions (REQUEST 5) ---
            window.showPrebookModal = () => {
                prebookPageContent.classList.remove('hidden');
                prebookSuccessPage.classList.add('hidden');
                prebookPageOverlay.classList.remove('hidden');
                document.body.classList.add('overflow-hidden'); // Add overflow hidden for full page modal
                void prebookPageModal.offsetWidth; 
                prebookPageModal.classList.remove('scale-95', 'opacity-0');
                prebookPageModal.classList.add('scale-100', 'opacity-100');
                // CHANGE 4: Hide bottom notification
                bottomNotificationBar.classList.add('hidden-down');
            };

            window.closePrebookModal = (refresh = false) => {
                prebookPageModal.classList.remove('scale-100', 'opacity-100');
                prebookPageModal.classList.add('scale-95', 'opacity-0');
                document.body.classList.remove('overflow-hidden'); // Remove overflow hidden
                // CHANGE 4: Show bottom notification
                bottomNotificationBar.classList.remove('hidden-down');
                setTimeout(() => {
                    prebookPageOverlay.classList.add('hidden');
                    if (refresh) location.reload();
                }, 300);
            };

            // Pre-book contact method toggling
            informViaRadios.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    emailEntry.classList.add('hidden');
                    whatsappEntry.classList.add('hidden');
                    prebookEmailInput.required = false;
                    prebookWhatsappInput.required = false;

                    const target = e.target.getAttribute('data-target');
                    if (target === 'email-entry') {
                        emailEntry.classList.remove('hidden');
                        prebookEmailInput.required = true;
                    } else if (target === 'whatsapp-entry') {
                        whatsappEntry.classList.remove('hidden');
                        prebookWhatsappInput.required = true;
                    }
                });
            });

            // Pre-book form submission
            prebookForm.addEventListener('submit', async (e) => {
                 e.preventDefault(); 
                 
                 const name = document.getElementById('prebook_name').value;
                 const methodRadio = document.querySelector('input[name="Inform Via"]:checked');
                 const method = methodRadio ? methodRadio.value : '';
                 let contact = '';
                 if (method === 'Email') {
                     contact = prebookEmailInput.value;
                 } else if (method === 'WhatsApp') {
                     contact = prebookWhatsappInput.value;
                 }
                 
                 document.getElementById('success-message-info').innerHTML = `
                     Dear <strong>${name}</strong>,<br>
                     You will be informed via 
                     <span class="font-extrabold text-red-600">${method}</span>
                     at 
                     <span class="font-extrabold text-[#1A5693]">${contact}</span> when the book is launched.
                 `;
                 
                 prebookPageContent.classList.add('hidden');
                 prebookSuccessPage.classList.remove('hidden');
                 
                 startConfetti();
                 
                 // Submit form data in the background using Fetch API to prevent redirect
                 const formData = new FormData(prebookForm);
                 try {
                     const response = await fetch('https://formsubmit.co/ajax/modmedicalis@gmail.com', {
                         method: 'POST',
                         body: formData,
                         headers: { 
                             'Accept': 'application/json',
                         }
                     });
                     
                     if (response.ok) {
                         console.log('Pre-book form submitted successfully.');
                     } else {
                         console.error('Pre-book form submission failed.');
                     }
                 } catch (error) {
                     console.error('Error submitting pre-book form:', error);
                 }
            });

            closePrebookPageButton.addEventListener('click', () => closePrebookModal());
            prebookPageOverlay.addEventListener('click', (e) => {
                if (e.target === prebookPageOverlay) {
                    closePrebookModal();
                }
            });

            // Confetti animation function
            const startConfetti = () => {
                const confettiColors = ['#ef4444', '#3b82f6', '#facc15', '#10b981', '#ffffff'];
                const count = 50; // Number of confetti pieces
                const container = prebookPageModal;
                const fragment = document.createDocumentFragment();

                for (let i = 0; i < count; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');
                    
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.top = `${Math.random() * 100}%`;
                    confetti.style.setProperty('--color', confettiColors[Math.floor(Math.random() * confettiColors.length)]);
                    confetti.style.setProperty('--duration', `${Math.random() * 3 + 2}s`);
                    
                    fragment.appendChild(confetti);
                }
                container.appendChild(fragment);
                
                setTimeout(() => {
                    container.querySelectorAll('.confetti').forEach(c => c.remove());
                }, 5000);
            };
            
            // --- Checkout Functions (REQUEST 4) ---
            const showCheckoutModal = () => {
                if (cart.length === 0) {
                    alert('Your cart is empty. Please add items before proceeding to checkout.');
                    return;
                }
                
                showCartModal(false); 
                
                if (checkoutCollegeSelect.options.length <= 1) {
                    const fragment = document.createDocumentFragment();
                    const publicGroup = document.createElement('optgroup');
                    publicGroup.label = "Public Medical Colleges";
                    const privateGroup = document.createElement('optgroup');
                    privateGroup.label = "Private Medical Colleges";
                    
                    PAKISTAN_MEDICAL_COLLEGES.forEach(college => {
                        const option = document.createElement('option');
                        option.value = college;
                        option.textContent = college;
                        
                        if (college.includes('(KEMU)') || college.includes('(AIMC)') || college.includes('(FJMU)') || college.includes('(SIMS)') || college.includes('(DMC)') || college.includes('(KMC)') || college.includes('(RMU)') || college.includes('(QAMC)') || college.includes('(LUMHS)') || college.includes('(BMC)') || college.includes('(NMU)') || college.includes('(SZMC)') || college.includes('(GMC)') || college.includes('(SMC)') || college.includes('(FMU)') || college.includes('(NUMS)') || college.includes('PIMS')) {
                             publicGroup.appendChild(option);
                        } else if (college === 'Other') {
                             fragment.appendChild(option);
                        }
                        else {
                            privateGroup.appendChild(option);
                        }
                    });
                    
                    checkoutCollegeSelect.appendChild(publicGroup);
                    checkoutCollegeSelect.appendChild(privateGroup);
                    checkoutCollegeSelect.appendChild(fragment);
                }
                
                let total = 0;
                checkoutSummaryList.innerHTML = '';
                let cartSummary = [];
                
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    
                    const listItem = document.createElement('li');
                    listItem.textContent = `${item.name} x ${item.quantity} - Rs. ${itemTotal.toLocaleString('en-PK')}`;
                    checkoutSummaryList.appendChild(listItem);
                    
                    cartSummary.push(`${item.name} x ${item.quantity} (Rs. ${itemTotal.toLocaleString('en-PK')})`);
                });
                
                paymentAmount.textContent = `Rs. ${total.toLocaleString('en-PK')}`;
                checkoutFinalTotal.textContent = `Rs. ${total.toLocaleString('en-PK')}`;
                
                document.getElementById('form-cart-details').value = cartSummary.join('; ');
                document.getElementById('form-final-bill').value = `Rs. ${total.toLocaleString('en-PK')}`;

                // Reset to first step
                showCheckoutStep(1);
                
                checkoutModalOverlay.classList.remove('hidden');
                void checkoutModal.offsetWidth; 
                checkoutModal.classList.remove('scale-95', 'opacity-0');
                checkoutModal.classList.add('scale-100', 'opacity-100');

                // CHANGE 2: Hide bottom notification
                bottomNotificationBar.classList.add('hidden-down');
            };

            const closeCheckoutModal = () => {
                checkoutModal.classList.remove('scale-100', 'opacity-100');
                checkoutModal.classList.add('scale-95', 'opacity-0');
                // CHANGE 2: Show bottom notification
                bottomNotificationBar.classList.remove('hidden-down');
                setTimeout(() => {
                    checkoutModalOverlay.classList.add('hidden');
                }, 300);
            };
            
            // NEW: Multi-step checkout navigation
            nextToPaymentBtn.addEventListener('click', () => {
                // Validate shipping form
                const shippingForm = document.getElementById('checkout-step-1');
                const requiredFields = shippingForm.querySelectorAll('[required]');
                let isValid = true;
                
                requiredFields.forEach(field => {
                    if (!field.value.trim()) {
                        isValid = false;
                        field.classList.add('border-red-500');
                    } else {
                        field.classList.remove('border-red-500');
                    }
                });
                
                if (isValid) {
                    showCheckoutStep(2);
                } else {
                    alert('Please fill in all required shipping details.');
                }
            });
            
            backToShippingBtn.addEventListener('click', () => {
                showCheckoutStep(1);
            });
            
            nextToConfirmationBtn.addEventListener('click', () => {
                // Validate payment form
                const paymentForm = document.getElementById('checkout-step-2');
                const requiredFields = paymentForm.querySelectorAll('[required]');
                let isValid = true;
                
                requiredFields.forEach(field => {
                    if (!field.value.trim() && field.type !== 'file') {
                        isValid = false;
                        field.classList.add('border-red-500');
                    } else {
                        field.classList.remove('border-red-500');
                    }
                });
                
                // Check if payment slip is uploaded
                const paymentSlip = document.getElementById('payment_slip');
                if (!paymentSlip.files.length) {
                    isValid = false;
                    paymentSlip.classList.add('border-red-500');
                } else {
                    paymentSlip.classList.remove('border-red-500');
                }
                
                // Check if referral source is selected
                const referralSource = document.querySelector('input[name="How do you know about us?"]:checked');
                if (!referralSource) {
                    isValid = false;
                    document.querySelectorAll('input[name="How do you know about us?"]').forEach(radio => {
                        radio.parentNode.classList.add('text-red-500');
                    });
                } else {
                    document.querySelectorAll('input[name="How do you know about us?"]').forEach(radio => {
                        radio.parentNode.classList.remove('text-red-500');
                    });
                }
                
                if (isValid) {
                    showCheckoutStep(3);
                } else {
                    alert('Please fill in all required payment details.');
                }
            });
            
            backToPaymentBtn.addEventListener('click', () => {
                showCheckoutStep(2);
            });
            
            cancelCheckoutBtn.addEventListener('click', () => {
                closeCheckoutModal();
            });
            
            // NEW: Checkout form submission without redirect
            confirmOrderBtn.addEventListener('click', async () => {
                // Create FormData object from all form fields
                const formData = new FormData();
                
                // Add all form fields
                const formFields = document.querySelectorAll('#checkout-form input, #checkout-form select, #checkout-form textarea');
                formFields.forEach(field => {
                    if (field.type === 'file') {
                        // Add file if exists
                        if (field.files.length > 0) {
                            formData.append(field.name, field.files[0]);
                        }
                    } else if (field.type === 'radio') {
                        // Only add checked radio buttons
                        if (field.checked) {
                            formData.append(field.name, field.value);
                        }
                    } else {
                        // Add regular fields
                        formData.append(field.name, field.value);
                    }
                });
                
                // Add hidden fields
                formData.append('_subject', 'ModMedicalis Order Confirmation');
                formData.append('_template', 'table');
                formData.append('Cart Details', document.getElementById('form-cart-details').value);
                formData.append('Final Bill', document.getElementById('form-final-bill').value);
                
                // Submit form data using Fetch API
                try {
                    const response = await fetch('https://formsubmit.co/ajax/modmedicalis@gmail.com', {
                        method: 'POST',
                        body: formData,
                        headers: { 
                            'Accept': 'application/json',
                        }
                    });
                    
                    if (response.ok) {
                        alert('Order submitted successfully! We will contact you shortly.');
                        // Clear cart and close modal
                        cart = [];
                        renderCart();
                        calculateTotals();
                        closeCheckoutModal();
                    } else {
                        alert('There was an error submitting your order. Please try again.');
                    }
                } catch (error) {
                    console.error('Error submitting order:', error);
                    alert('There was an error submitting your order. Please try again.');
                }
            });
            
            proceedToCheckoutBtn.addEventListener('click', showCheckoutModal);
            closeCheckoutButton.addEventListener('click', closeCheckoutModal);
            checkoutModalOverlay.addEventListener('click', (e) => {
                if (e.target === checkoutModalOverlay) {
                    closeCheckoutModal();
                }
            });


            // --- Popup Functions ---

            const renderProductImages = (product) => {
                const mainImage = document.getElementById('popup-main-image');
                const thumbnailsContainer = document.getElementById('popup-thumbnails');
                thumbnailsContainer.innerHTML = '';
                
                mainImage.src = product.images[0];
                
                product.images.forEach((url, index) => {
                    const thumbnail = document.createElement('img');
                    thumbnail.src = url;
                    thumbnail.alt = `${product.name} thumbnail ${index + 1}`;
                    thumbnail.classList.add(
                        'w-12', 'h-12', 'sm:w-16', 'sm:h-16', 'rounded-lg', 'object-cover', 'cursor-pointer', 'border-2', 'transition', 'duration-150',
                        'hover:border-[#1A5693]', index === 0 ? 'border-[#1A5693]' : 'border-transparent'
                    );
                    
                    thumbnail.addEventListener('click', () => {
                        mainImage.src = url;
                        document.querySelectorAll('#popup-thumbnails img').forEach(img => img.classList.remove('border-[#1A5693]'));
                        thumbnail.classList.add('border-[#1A5693]');
                    });
                    
                    thumbnailsContainer.appendChild(thumbnail);
                });
            }

            const showProductPopup = (productId) => {
                const id = parseInt(productId);
                const product = findProductById(id);
                
                if (!product) return;

                popupProductName.textContent = product.name;
                
                // Updated for Block 6: Changed price from Rs. 0 to Rs. ??
                if (id === 3) {
                    popupProductPrice.textContent = "Rs. ??";
                } else {
                    popupProductPrice.textContent = `Rs. ${product.price.toLocaleString('en-PK')}`;
                }
                
                popupProductOldPrice.textContent = product.oldPrice ? `Rs. ${product.oldPrice.toLocaleString('en-PK')}` : '';
                popupProductDescription.textContent = product.description;
                
                popupAddToCartBtn.setAttribute('data-product-id', id);
                if (product.isPrebook) {
                    // Updated for Block 6: Changed button text
                    popupAddToCartBtn.textContent = 'CLICK FOR FREE PREVIEW';
                    popupAddToCartBtn.disabled = false;
                    popupAddToCartBtn.classList.remove('bg-gray-400', 'hover:bg-gray-400');
                    popupAddToCartBtn.classList.add('bg-[#1A5693]', 'hover:bg-blue-700');
                    popupAddToCartBtn.onclick = () => {
                        window.open(product.previewLink, '_blank');
                    };
                    popupFreePreviewBtn.textContent = 'Pre-book Now';
                    popupFreePreviewBtn.onclick = showPrebookModal;
                } else {
                    popupAddToCartBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.38a2 2 0 0 0 1.84-1.11L22 7H4"/></svg><span>Add to cart</span>';
                    popupAddToCartBtn.disabled = false;
                    popupAddToCartBtn.classList.remove('bg-gray-400', 'hover:bg-gray-400');
                    popupAddToCartBtn.classList.add('bg-[#1A5693]', 'hover:bg-blue-700');
                    popupAddToCartBtn.onclick = (e) => {
                        const productId = e.currentTarget.getAttribute('data-product-id');
                        addToCart(productId);
                        closeProductPopup(); 
                    };
                    
                    // Set preview button to open the PDF link
                    popupFreePreviewBtn.textContent = 'Click for free preview';
                    popupFreePreviewBtn.onclick = () => {
                        if (product.previewLink) {
                            window.open(product.previewLink, '_blank');
                        } else {
                            alert('Free preview not available for this product.');
                        }
                    };
                }

                renderProductImages(product);

                productPopupOverlay.classList.remove('hidden');
                void productPopup.offsetWidth; 
                productPopup.classList.remove('scale-95', 'opacity-0');
                productPopup.classList.add('scale-100', 'opacity-100');
            };

            const closeProductPopup = () => {
                productPopup.classList.remove('scale-100', 'opacity-100');
                productPopup.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    productPopupOverlay.classList.add('hidden');
                }, 300);
            };

            // --- Cart Functions ---

            const calculateTotals = () => {
                let subtotal = 0;
                let totalItems = 0;

                cart.forEach(item => {
                    subtotal += item.price * item.quantity;
                    totalItems += item.quantity;
                });
                
                const total = subtotal; 
                
                cartSubtotalElement.textContent = `Rs. ${subtotal.toLocaleString('en-PK')}`;
                cartTotalElement.textContent = `Rs. ${total.toLocaleString('en-PK')}`;

                cartCountElements.forEach(el => el.textContent = totalItems);
            };

            const renderCart = () => {
                cartItemsContainer.innerHTML = '';

                if (cart.length === 0) {
                    emptyCartMessage.classList.remove('hidden');
                    proceedToCheckoutBtn.disabled = true;
                    calculateTotals();
                    return;
                }
                emptyCartMessage.classList.add('hidden');
                proceedToCheckoutBtn.disabled = false;


                cart.forEach(item => {
                    const itemHtml = `
                        <div class="flex items-center space-x-3 p-2 cart-item-card rounded-xl">
                            <div class="flex-shrink-0 w-10 h-10 bg-gray-200 rounded-lg overflow-hidden">
                                <img src="${item.image}" alt="${item.name} image" class="w-full h-full object-cover">
                            </div>
                            <div class="flex-grow">
                                <p class="text-xs font-semibold text-gray-800">${item.name}</p>
                                <p class="text-[0.65rem] text-red-500 font-bold">Rs. ${(item.price).toLocaleString('en-PK')}</p>
                            </div>
                            <div class="flex items-center space-x-1">
                                <button data-id="${item.productId}" data-delta="-1" class="w-5 h-5 bg-red-100 rounded-full text-xs font-bold text-red-700 hover:bg-red-200 transition quantity-btn">-</button>
                                <span class="w-3 text-center text-xs font-semibold">${item.quantity}</span>
                                <button data-id="${item.productId}" data-delta="1" class="w-5 h-5 bg-blue-100 rounded-full text-xs font-bold text-blue-700 hover:bg-blue-200 transition quantity-btn">+</button>
                            </div>
                            <div class="text-right w-12">
                                <p class="text-xs font-bold text-[#1A5693]">Rs. ${(item.price * item.quantity).toLocaleString('en-PK')}</p>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.insertAdjacentHTML('beforeend', itemHtml);
                });
                
                document.querySelectorAll('.quantity-btn').forEach(button => {
                    button.addEventListener('click', handleQuantityChange);
                });

                calculateTotals();
            };
            
            const showCartModal = (show = true) => {
                if (show) {
                    renderCart();
                    cartModalOverlay.classList.remove('hidden');
                    void cartModal.offsetWidth; 
                    cartModal.classList.remove('scale-95', 'opacity-0');
                    cartModal.classList.add('scale-100', 'opacity-100');
                } else {
                    cartModal.classList.remove('scale-100', 'opacity-100');
                    cartModal.classList.add('scale-95', 'opacity-0');
                    setTimeout(() => {
                        cartModalOverlay.classList.add('hidden');
                    }, 300); 
                }
            };
            
            const addToCart = (productId) => {
                const id = parseInt(productId);
                const product = findProductById(id);
                
                if (!product || product.isPrebook) {
                    return;
                }

                const cartItemIndex = cart.findIndex(item => item.productId === id);

                if (cartItemIndex > -1) {
                    cart[cartItemIndex].quantity += 1;
                } else {
                    cart.push({
                        productId: id,
                        name: product.name,
                        price: product.price,
                        quantity: 1,
                        image: product.images[0] 
                    });
                }
                
                showCartModal(true);
            };

            const handleQuantityChange = (e) => {
                const productId = parseInt(e.currentTarget.getAttribute('data-id'));
                const delta = parseInt(e.currentTarget.getAttribute('data-delta'));
                
                const cartItemIndex = cart.findIndex(item => item.productId === productId);

                if (cartItemIndex > -1) {
                    cart[cartItemIndex].quantity += delta;

                    if (cart[cartItemIndex].quantity <= 0) {
                        cart.splice(cartItemIndex, 1);
                    }
                }
                renderCart();
            };

            // --- NEW: Image Comparison Slider Logic ---
            const comparisonWrapper = document.getElementById('image-comparison-wrapper');
            const imageAfter = document.getElementById('image-after');
            const comparisonLine = document.getElementById('comparison-line');
            const sliderHandle = document.getElementById('slider-handle');

            let isDragging = false;

            const updateSlider = (e) => {
                const rect = comparisonWrapper.getBoundingClientRect();
                let clientX;
                
                if (e.touches) {
                    clientX = e.touches[0].clientX;
                } else {
                    clientX = e.clientX;
                }

                let x = clientX - rect.left;
                
                if (x < 0) x = 0;
                if (x > rect.width) x = rect.width;
                
                const percent = (x / rect.width) * 100;

                imageAfter.style.clipPath = `inset(0 0 0 ${percent}%)`;
                imageAfter.style.webkitClipPath = `inset(0 0 0 ${percent}%)`;

                comparisonLine.style.left = `${percent}%`;
                sliderHandle.style.left = `${percent}%`;
            };

            const startDrag = (e) => {
                if (e.type === 'mousedown') {
                    e.preventDefault();
                }
                isDragging = true;
                comparisonWrapper.classList.add('dragging');
                
                updateSlider(e);

                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDrag);
                document.addEventListener('touchmove', drag, { passive: false });
                document.addEventListener('touchend', stopDrag);
            };

            const drag = (e) => {
                if (isDragging) {
                    updateSlider(e);
                }
            };

            const stopDrag = () => {
                isDragging = false;
                comparisonWrapper.classList.remove('dragging');
                
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
                document.removeEventListener('touchmove', drag);
                document.removeEventListener('touchend', stopDrag);
            };

            if (comparisonWrapper) {
                comparisonWrapper.addEventListener('mousedown', startDrag);
                comparisonWrapper.addEventListener('touchstart', startDrag, { passive: false });
                
                const imagesToLoad = [
                    document.getElementById('image-before'),
                    document.getElementById('image-after')
                ];
                
                let loadedCount = 0;
                imagesToLoad.forEach(img => {
                    if (img.complete) {
                        loadedCount++;
                    } else {
                        img.onload = () => {
                            loadedCount++;
                            if (loadedCount === imagesToLoad.length) {
                                updateSlider({ clientX: comparisonWrapper.getBoundingClientRect().left + comparisonWrapper.offsetWidth / 2 });
                            }
                        };
                    }
                });
                if (loadedCount === imagesToLoad.length) {
                     updateSlider({ clientX: comparisonWrapper.getBoundingClientRect().left + comparisonWrapper.offsetWidth / 2 });
                }
            }
            // --- END NEW: Image Comparison Slider Logic ---



            // --- Event Listeners Initialization ---
            
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            productTriggers.forEach(trigger => {
                trigger.addEventListener('click', (e) => {
                    const productId = e.currentTarget.getAttribute('data-product-id');
                    showProductPopup(productId);
                });
            });

            closeProductPopupButton.addEventListener('click', closeProductPopup);
            productPopupOverlay.addEventListener('click', (e) => {
                if (e.target === productPopupOverlay) {
                    closeProductPopup();
                }
            });

            const setFilter = (targetYear) => {
                filterButtons.forEach(btn => {
                    const year = btn.getAttribute('data-year');
                    if (year === targetYear) {
                        btn.classList.add('active');
                        btn.classList.remove('text-gray-300');
                        btn.classList.add('text-white');
                        btn.style.color = 'white'; 
                    } else {
                        btn.classList.remove('active');
                        btn.classList.remove('text-white');
                        btn.classList.add('text-gray-300');
                        btn.style.color = '#d1d5db';
                    }
                });

                let firstVisibleProduct = null;
                const productContainer = document.getElementById('product-container');
                
                productCards.forEach(card => {
                    const cardYear = card.getAttribute('data-year');
                    
                    if (targetYear === 'all' || cardYear === targetYear) {
                        card.classList.remove('product-slide-up');
                        card.classList.remove('hidden');
                        
                        void card.offsetWidth; 
                        
                        card.classList.add('product-slide-up');
                        
                        if (!firstVisibleProduct) {
                            firstVisibleProduct = card;
                        }
                    } else {
                        card.classList.add('hidden');
                        card.classList.remove('product-slide-up');
                    }
                });

                if (firstVisibleProduct) {
                    productContainer.scrollTo({ left: firstVisibleProduct.offsetLeft - 16, behavior: 'smooth' });
                } else {
                    productContainer.scrollTo({ left: 0, behavior: 'smooth' });
                }
            }

            filterButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const year = e.currentTarget.getAttribute('data-year');
                    setFilter(year);
                });
            });
            
            document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = e.currentTarget.getAttribute('data-product-id');
                    addToCart(productId);
                });
            });
            
            document.getElementById('desktop-cart-button').addEventListener('click', () => showCartModal(true));
            document.getElementById('mobile-cart-button').addEventListener('click', () => showCartModal(true));
            document.getElementById('close-cart-button').addEventListener('click', () => showCartModal(false));
            cartModalOverlay.addEventListener('click', (e) => {
                if (e.target === cartModalOverlay) {
                    showCartModal(false);
                }
            });

            setFilter('all');
            calculateTotals();
        });
    </script>
</body>
</html>

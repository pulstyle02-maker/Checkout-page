<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pathology - Neurosciences Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a0b2e; /* Deep Purple Background */
            color: #ffffff;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2d1b4e; 
        }
        ::-webkit-scrollbar-thumb {
            background: #fbbf24; 
            border-radius: 4px;
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .btn-glass:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: #fbbf24;
            transform: translateY(-2px);
        }

        .option-btn {
            transition: all 0.2s;
        }
        
        .option-btn.selected {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.1);
        }

        .correct-anim {
            background-color: #22c55e !important;
            border-color: #22c55e !important;
            color: white !important;
        }

        .wrong-anim {
            background-color: #ef4444 !important;
            border-color: #ef4444 !important;
            color: white !important;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="p-4 bg-opacity-90 backdrop-blur-md bg-[#2d1b4e] border-b border-yellow-500/30 sticky top-0 z-50 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <i class="fa-solid fa-brain text-yellow-400 text-2xl"></i>
                <h1 class="text-xl md:text-2xl font-bold tracking-wider text-white">
                    PATHOLOGY <span class="text-yellow-400">NEUROQUIZ</span>
                </h1>
            </div>
            <button onclick="goHome()" class="text-sm text-gray-300 hover:text-yellow-400 transition">
                <i class="fa-solid fa-house"></i> Home
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto p-4 md:p-6 flex flex-col items-center justify-center">
        
        <!-- Section Selection Screen -->
        <div id="section-menu" class="w-full max-w-4xl grid gap-6 fade-in">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-yellow-400 mb-2">Neurosciences Pathology Module</h2>
                <p class="text-gray-400">Select a Learning Objective (LO) to begin</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Buttons generated by JS -->
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-container" class="w-full max-w-2xl hidden fade-in">
            <!-- Progress Header -->
            <div class="flex justify-between items-center mb-4 text-sm text-gray-400">
                <span id="progress-text">Question 1/25</span>
                <span id="score-badge" class="bg-yellow-500/20 text-yellow-400 px-3 py-1 rounded-full border border-yellow-500/30">
                    Score: 0
                </span>
            </div>
            
            <!-- Progress Bar -->
            <div class="w-full bg-gray-700 h-2 rounded-full mb-6 overflow-hidden">
                <div id="progress-bar" class="bg-gradient-to-r from-yellow-400 to-orange-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>

            <!-- Question Card -->
            <div class="bg-[#2d1b4e] border border-purple-500/30 rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden">
                <div class="absolute top-0 right-0 w-32 h-32 bg-yellow-500/10 rounded-full blur-3xl -mr-16 -mt-16"></div>
                
                <h3 id="question-text" class="text-xl md:text-2xl font-semibold mb-8 leading-relaxed text-gray-100">
                    Loading Question...
                </h3>

                <!-- Options -->
                <div id="options-container" class="grid gap-3">
                    <!-- Options injected here -->
                </div>

                <!-- Explanation Box -->
                <div id="explanation-box" class="mt-6 p-4 bg-blue-900/30 border border-blue-500/30 rounded-xl hidden">
                    <p class="text-blue-200 text-sm"><i class="fa-solid fa-circle-info mr-2"></i><span id="explanation-text"></span></p>
                </div>

                <!-- Next Button -->
                <button id="next-btn" onclick="nextQuestion()" class="mt-8 w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-3 px-6 rounded-xl shadow-lg transform transition hover:-translate-y-1 hidden">
                    Next Question <i class="fa-solid fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="w-full max-w-3xl hidden fade-in text-center">
            <div class="bg-[#2d1b4e] border border-yellow-500/30 rounded-3xl p-8 shadow-2xl">
                <div class="w-24 h-24 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-6 shadow-[0_0_20px_rgba(251,191,36,0.5)]">
                    <i class="fa-solid fa-trophy text-4xl text-black"></i>
                </div>
                
                <h2 class="text-3xl font-bold text-white mb-2">Module Completed!</h2>
                <p class="text-gray-400 mb-6">Here is how you performed</p>

                <div class="text-6xl font-bold text-yellow-400 mb-8" id="final-score">0%</div>

                <div class="flex flex-col md:flex-row gap-4 justify-center mb-8">
                    <button onclick="restartModule()" class="btn-glass text-white px-8 py-3 rounded-xl font-semibold hover:bg-white/10">
                        <i class="fa-solid fa-rotate-right mr-2"></i> Retry Module
                    </button>
                    <button onclick="goHome()" class="bg-yellow-400 text-black px-8 py-3 rounded-xl font-semibold hover:bg-yellow-500 transition">
                        <i class="fa-solid fa-list mr-2"></i> Main Menu
                    </button>
                </div>

                <!-- Wrong Answers Section -->
                <div id="review-section" class="text-left mt-8 border-t border-gray-700 pt-8 hidden">
                    <h3 class="text-xl font-bold text-red-400 mb-4"><i class="fa-solid fa-circle-exclamation mr-2"></i>Review Incorrect Answers</h3>
                    <div id="wrong-answers-list" class="space-y-4">
                        <!-- Wrong answers injected here -->
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="text-center p-6 text-gray-600 text-sm">
        <p>Pathology Neurosciences Module • Designed for Mobile</p>
    </footer>

    <script>
        // --- DATA: 50 MCQs for Pathology Neurosciences ---
        const questionBank = [
            // LO 1: Discuss the pathophysiology of cerebral vascular accident (CVA). (25 Qs)
            {
                id: 1, section: "Neuro-Path-001", question: "A patient with atrial fibrillation abruptly develops right-sided hemiparesis. This presentation most strongly suggests which type of CVA?",
                options: ["Ischemic - Thrombotic", "Ischemic - Embolic", "Intracerebral Hemorrhage", "Subarachnoid Hemorrhage"], answer: 1,
                explanation: "Embolic strokes often present abruptly and severely, commonly originating from the heart (like in AFib) and traveling to a cerebral artery."
            },
            {
                id: 2, section: "Neuro-Path-001", question: "The primary pathological event in an ischemic stroke is:",
                options: ["Vasospasm", "Rupture of a vessel", "Complete cessation of blood flow to a localized area", "Hemolysis"], answer: 2,
                explanation: "Ischemic stroke is caused by a blockage (thrombus or embolus), leading to localized cessation of blood flow (ischemia) and subsequent infarction."
            },
            {
                id: 3, section: "Neuro-Path-001", question: "Which term describes the area of tissue surrounding the core ischemic zone that is salvageable with prompt intervention?",
                options: ["Infarct core", "Penumbra", "Watershed zone", "Lacunae"], answer: 1,
                explanation: "The ischemic penumbra is metabolically compromised but structurally intact tissue that can be rescued by timely restoration of blood flow."
            },
            {
                id: 4, section: "Neuro-Path-001", question: "A thrombotic stroke typically arises from atherosclerosis at which major arterial site?",
                options: ["Posterior communicating artery", "Middle cerebral artery (MCA) distal branches", "Bifurcation of the internal carotid and vertebral arteries", "Anterior cerebral artery (ACA)"], answer: 2,
                explanation: "Thrombotic strokes are frequently associated with plaque rupture and thrombus formation at large artery bifurcations, especially the carotid or vertebrobasilar systems."
            },
            {
                id: 5, section: "Neuro-Path-001", question: "The immediate cellular consequence of severe ischemia in the brain that leads to neuronal death is:",
                options: ["Massive increase in intracellular protein synthesis", "Failure of the Na+/K+ ATPase pump leading to cellular swelling", "Overproduction of dopamine", "Suppression of inflammatory cytokines"], answer: 1,
                explanation: "ATP depletion causes the Na+/K+ pump to fail, leading to an influx of sodium, chloride, and water, resulting in cellular swelling (cytotoxic edema) and necrosis."
            },
            {
                id: 6, section: "Neuro-Path-001", question: "The most common cause of a primary non-traumatic intracerebral hemorrhage (ICH) is:",
                options: ["Saccular aneurysm rupture", "Arteriovenous malformation (AVM)", "Chronic uncontrolled hypertension", "Cerebral amyloid angiopathy"], answer: 2,
                explanation: "Chronic hypertension leads to microaneurysm (Charcot-Bouchard) rupture in the deep penetrating arteries, commonly causing ICH in the basal ganglia or thalamus."
            },
            {
                id: 7, section: "Neuro-Path-001", question: "A patient presenting with 'the worst headache of my life' and meningeal irritation but often without focal deficits points towards:",
                options: ["Lacunar infarction", "Transient Ischemic Attack (TIA)", "Subarachnoid Hemorrhage (SAH)", "Basilar artery occlusion"], answer: 2,
                explanation: "Thunderclap headache, nuchal rigidity (meningeal irritation), and often clear consciousness are classic for SAH, typically from a ruptured saccular aneurysm."
            },
            {
                id: 8, section: "Neuro-Path-001", question: "The primary mechanism of brain injury following an intracerebral hemorrhage (ICH) is:",
                options: ["Direct toxic effect of blood components and mechanical compression", "Severe vasoconstriction", "Formation of microemboli", "Demyelination"], answer: 0,
                explanation: "The mass effect of the hematoma causes immediate tissue compression, while hemoglobin and its breakdown products cause delayed edema and neurotoxicity."
            },
            {
                id: 9, section: "Neuro-Path-001", question: "Delayed cerebral ischemia following a Subarachnoid Hemorrhage (SAH) is most often caused by:",
                options: ["Re-bleeding", "Hydrocephalus", "Vasospasm", "Infection"], answer: 2,
                explanation: "Cerebral vasospasm, usually peaking 4-14 days post-SAH, is the leading cause of delayed morbidity and mortality."
            },
            {
                id: 10, section: "Neuro-Path-001", question: "Which type of stroke is characterized by pure motor or pure sensory deficits due to occlusion of small, deep penetrating arteries?",
                options: ["Hemorrhagic stroke", "Embolic stroke", "Lacunar stroke", "Watershed stroke"], answer: 2,
                explanation: "Lacunar strokes are small infarcts in the deep brain structures (basal ganglia, thalamus, internal capsule) caused by lipohyalinosis secondary to hypertension."
            },
            {
                id: 11, section: "Neuro-Path-001", question: "Transient Ischemic Attacks (TIAs) are often considered a precursor to a major stroke and are defined by symptoms lasting:",
                options: ["Less than 24 hours (with no permanent infarction)", "Less than 7 days", "Less than 72 hours", "Less than 30 minutes"], answer: 0,
                explanation: "The modern definition of TIA is a transient episode of neurologic dysfunction caused by focal brain, spinal cord, or retinal ischemia, *without acute infarction*."
            },
            {
                id: 12, section: "Neuro-Path-001", question: "Why is hyperglycemia detrimental to stroke prognosis?",
                options: ["It increases the risk of bleeding", "It alters blood viscosity", "It worsens cerebral edema and acidosis in the ischemic penumbra", "It interferes with fibrinolysis"], answer: 2,
                explanation: "High glucose levels lead to increased anaerobic metabolism during ischemia, causing excessive lactic acid production, acidosis, and thus greater tissue damage."
            },
            {
                id: 13, section: "Neuro-Path-001", question: "A crucial risk factor that accounts for the majority of large artery atherosclerotic thrombotic strokes is:",
                options: ["Low cholesterol", "Smoking and Diabetes Mellitus", "Diet high in vegetables", "Regular exercise"], answer: 1,
                explanation: "Smoking and DM are powerful accelerators of atherosclerosis, the underlying pathology for thrombotic CVA."
            },
            {
                id: 14, section: "Neuro-Path-001", question: "In the ischemic cascade, the neurotransmitter glutamate plays a central role in:",
                options: ["Inducing cerebral vasodilation", "Excitotoxicity leading to calcium overload and cell death", "Reducing oxidative stress", "Inhibiting platelet aggregation"], answer: 1,
                explanation: "Ischemia causes massive release of glutamate, which overstimulates NMDA receptors, leading to calcium influx and the death of neurons (excitotoxicity)."
            },
            {
                id: 15, section: "Neuro-Path-001", question: "The phenomenon where blood flow to two adjacent cerebral artery territories is reduced, causing infarction along the border, is known as a:",
                options: ["Deep perforator stroke", "Venous stroke", "Watershed infarction", "Cryptogenic stroke"], answer: 2,
                explanation: "Watershed infarctions occur at the junctions between major cerebral artery territories (e.g., MCA/ACA), which are most vulnerable during severe systemic hypoperfusion (e.g., shock)."
            },
            {
                id: 16, section: "Neuro-Path-001", question: "Following reperfusion after an ischemic event, a secondary injury mechanism involves:",
                options: ["Increased inflammatory response and free radical generation", "Increased blood viscosity", "Decreased intracranial pressure", "Reduced metabolism"], answer: 0,
                explanation: "Reperfusion paradoxically causes secondary injury through the influx of neutrophils, activation of complement, and the production of reactive oxygen species (free radicals)."
            },
            {
                id: 17, section: "Neuro-Path-001", question: "Cerebral edema is a major cause of death in large strokes. What is the primary type of edema seen in the immediate aftermath of ischemia?",
                options: ["Vasogenic edema", "Interstitial edema", "Hydrostatic edema", "Cytotoxic edema"], answer: 3,
                explanation: "Cytotoxic edema (intracellular swelling) is the initial type due to failure of the Na+/K+ pump, followed later by vasogenic edema (extracellular fluid accumulation)."
            },
            {
                id: 18, section: "Neuro-Path-001", question: "The rupture of a saccular (Berry) aneurysm is the typical cause of Subarachnoid Hemorrhage. These aneurysms are usually located at:",
                options: ["Deep penetrating arteries", "Arterial bifurcations in the Circle of Willis", "Large venous sinuses", "Cerebellar arteries"], answer: 1,
                explanation: "Saccular aneurysms preferentially form at the arterial branch points, especially the anterior communicating artery (ACom) and MCA bifurcations, within the Circle of Willis."
            },
            {
                id: 19, section: "Neuro-Path-001", question: "Which clinical sign is characteristic of Middle Cerebral Artery (MCA) territory stroke?",
                options: ["Isolated pure sensory loss in the leg", "Global aphasia and contralateral face/arm hemiparesis", "Visual loss in one eye (Amaurosis Fugax)", "Incontinence and contralateral leg weakness"], answer: 1,
                explanation: "MCA supplies the majority of the lateral convexity, including the motor/sensory areas for the face and arm, and the language centers (Wernicke's/Broca's areas)."
            },
            {
                id: 20, section: "Neuro-Path-001", question: "Occlusion of the Posterior Cerebral Artery (PCA) classically results in:",
                options: ["Pure motor hemiplegia", "Loss of proprioception", "Contralateral homonymous hemianopia", "Locked-in syndrome"], answer: 2,
                explanation: "PCA supplies the occipital lobe, containing the primary visual cortex, leading to a loss of vision in the opposite visual field."
            },
            {
                id: 21, section: "Neuro-Path-001", question: "A massive stroke causing brain shift and herniation typically involves which structure compressing the brainstem?",
                options: ["Tonsillar herniation", "Subfalcine herniation", "Transtentorial (Uncal) herniation", "Transalar herniation"], answer: 2,
                explanation: "Uncal herniation (a type of transtentorial herniation) is the most critical as it compresses the midbrain, leading to consciousness loss and pupil dilation (CN III compression)."
            },
            {
                id: 22, section: "Neuro-Path-001", question: "Hemorrhagic transformation (bleeding into an ischemic area) is a risk, particularly after:",
                options: ["Large embolic strokes", "Lacunar strokes", "Strokes treated without tPA", "Strokes caused by vasospasm"], answer: 0,
                explanation: "Large embolic strokes, where the original embolus fragments and blood flow is restored to damaged vessels, carry the highest risk of hemorrhagic conversion."
            },
            {
                id: 23, section: "Neuro-Path-001", question: "What is the primary pathological difference between a CVA and a TIA?",
                options: ["A CVA involves permanent brain tissue infarction, while a TIA does not", "CVA is hemorrhagic, TIA is always embolic", "CVA involves the posterior circulation, TIA involves the anterior circulation", "CVA symptoms are always severe"], answer: 0,
                explanation: "A stroke (CVA) results in permanent, irreversible tissue death (infarction), whereas TIA symptoms are transient and resolve without radiographic evidence of infarction."
            },
            {
                id: 24, section: "Neuro-Path-001", question: "In the pathophysiology of CVA, free radical damage occurs primarily during:",
                options: ["The initial blockage phase", "Reperfusion", "Cellular hibernation", "Before ATP depletion"], answer: 1,
                explanation: "Oxygen free radicals (reactive oxygen species) are generated when oxygen is reintroduced to the compromised tissue during reperfusion, causing lipid peroxidation and cell membrane damage."
            },
            {
                id: 25, section: "Neuro-Path-001", question: "A patient presents with pure motor hemiparesis affecting the face, arm, and leg equally. The most likely stroke type is:",
                options: ["Hemispheric embolic stroke", "Brainstem hemorrhage", "Lacunar stroke in the internal capsule", "Basilar artery occlusion"], answer: 2,
                explanation: "Pure motor stroke is the classic presentation of a lacunar infarct in the posterior limb of the internal capsule, a deep-penetrating artery territory."
            },
            // LO 2: Define Meningitis & Identify types of meningitis (25 Qs)
            {
                id: 26, section: "Neuro-Path-002", question: "Meningitis is defined as the inflammation of which anatomical structures?",
                options: ["The cerebral cortex and basal ganglia", "The three layers of meninges (dura, arachnoid, pia) and the CSF", "The pia and arachnoid mater (leptomeninges) and the subarachnoid space", "The white matter tracts and cerebellum"], answer: 2,
                explanation: "Meningitis is specifically the inflammation of the leptomeninges and the cerebrospinal fluid (CSF) within the subarachnoid space."
            },
            {
                id: 27, section: "Neuro-Path-002", question: "The classic clinical triad for acute bacterial meningitis includes fever, severe headache, and:",
                options: ["Unilateral paralysis", "Seizures", "Photophobia and nuchal rigidity (stiff neck)", "Vertigo and tinnitus"], answer: 2,
                explanation: "The triad (fever, headache, nuchal rigidity) is a key diagnostic indicator, with photophobia also being highly suggestive of meningeal irritation."
            },
            {
                id: 28, section: "Neuro-Path-002", question: "Which microorganism is the most common cause of acute bacterial meningitis in neonates?",
                options: ["Streptococcus pneumoniae", "Neisseria meningitidis", "Group B Streptococcus (S. agalactiae)", "Haemophilus influenzae"], answer: 2,
                explanation: "Group B *Streptococcus* (*S. agalactiae*) and *E. coli* are the most common causes in infants less than 1 month old."
            },
            {
                id: 29, section: "Neuro-Path-002", question: "Lumbar puncture (LP) fluid analysis in *acute bacterial* meningitis typically shows:",
                options: ["Lymphocytic pleocytosis, Normal glucose, Elevated protein", "Marked neutrophil (PMN) pleocytosis, Low glucose, Elevated protein", "Monocytic pleocytosis, Normal glucose, High protein", "Eosinophilic pleocytosis, Very high glucose"], answer: 1,
                explanation: "Bacteria consume glucose (low), inflammatory response brings neutrophils (PMN pleocytosis), and high protein leaks from the damaged blood-brain barrier."
            },
            {
                id: 30, section: "Neuro-Path-002", question: "Which sign is performed by flexing the patient's hip and knee, then extending the knee, which causes pain and resistance?",
                options: ["Brudzinski's sign", "Kernig's sign", "Chvostek's sign", "Romberg test"], answer: 1,
                explanation: "Kernig's sign is resistance and pain in the posterior thigh/hamstring upon attempting to fully extend the leg."
            },
            {
                id: 31, section: "Neuro-Path-002", question: "A petechial or purpuric rash is highly characteristic of meningitis caused by:",
                options: ["Streptococcus pneumoniae", "Haemophilus influenzae", "Neisseria meningitidis", "Listeria monocytogenes"], answer: 2,
                explanation: "Meningococcemia (*N. meningitidis* infection) causes a disseminated vasculitis resulting in the characteristic non-blanching petechial or purpuric rash."
            },
            {
                id: 32, section: "Neuro-Path-002", question: "The major virulence factor of *Neisseria meningitidis* that causes rapid shock and disseminated intravascular coagulation (DIC) is:",
                options: ["IgA protease", "Polysaccharide capsule", "Endotoxin (Lipooligosaccharide - LOS)", "M protein"], answer: 2,
                explanation: "LOS (endotoxin) triggers a massive inflammatory response, causing shock, endothelial damage, and activation of the coagulation cascade (DIC)."
            },
            {
                id: 33, section: "Neuro-Path-002", question: "Vaccination has dramatically reduced the incidence of meningitis caused by:",
                options: ["Enteroviruses", "S. pneumoniae and H. influenzae type B (Hib)", "E. coli", "Cryptococcus neoformans"], answer: 1,
                explanation: "Widespread vaccination programs target *S. pneumoniae* (Pneumococcal vaccine) and *H. influenzae* type B (Hib vaccine)."
            },
            {
                id: 34, section: "Neuro-Path-002", question: "A common route for bacterial pathogens to enter the CNS and cause meningitis is:",
                options: ["Direct trauma", "Hematogenous spread (crossing the blood-brain barrier)", "Lymphatic drainage", "Direct extension from the middle ear or sinuses"], answer: 1,
                explanation: "Most bacterial meningitis occurs after the pathogen colonizes the nasopharynx, invades the bloodstream (bacteremia), and then breaches the blood-brain barrier."
            },
            {
                id: 35, section: "Neuro-Path-002", question: "Which type of meningitis is generally milder, self-limiting, and often associated with a normal or near-normal CSF glucose level?",
                options: ["Acute bacterial meningitis", "Viral (Aseptic) meningitis", "Fungal meningitis", "Tuberculous meningitis"], answer: 1,
                explanation: "Viral meningitis, predominantly caused by Enteroviruses, is usually a benign, self-limited illness with preserved CSF glucose."
            },
            {
                id: 36, section: "Neuro-Path-002", question: "The most common etiological agent for viral (aseptic) meningitis is:",
                options: ["Herpes Simplex Virus 1 (HSV-1)", "Varicella Zoster Virus (VZV)", "Mumps Virus", "Enteroviruses (e.g., Coxsackievirus, Echovirus)"], answer: 3,
                explanation: "Enteroviruses are responsible for over 90% of all viral meningitis cases, especially during the summer and fall."
            },
            {
                id: 37, section: "Neuro-Path-002", question: "Aseptic meningitis is a term used to describe CNS inflammation with negative bacterial cultures. The typical CSF finding is:",
                options: ["PMN pleocytosis and very low glucose", "Lymphocytic pleocytosis and normal/mildly reduced glucose", "High PMNs and high protein", "No cells present"], answer: 1,
                explanation: "Viral infections typically cause an immune response dominated by lymphocytes (lymphocytic pleocytosis), and CSF glucose is generally normal."
            },
            {
                id: 38, section: "Neuro-Path-002", question: "In immunocompetent patients, Viral Meningitis usually has a better prognosis than Bacterial Meningitis primarily because:",
                options: ["Viruses cannot cross the BBB", "The brain tissue is not involved", "The inflammation is less destructive and is typically self-limiting", "There is no cerebral edema"], answer: 2,
                explanation: "Viral inflammation is usually confined to the meninges and the infection resolves without the extensive vasculitis, thrombosis, and cerebral edema seen in bacterial forms."
            },
            {
                id: 39, section: "Neuro-Path-002", question: "A patient with HIV and signs of chronic meningitis (over weeks) is most likely suffering from which fungal agent?",
                options: ["Candida albicans", "Aspergillus fumigatus", "Cryptococcus neoformans", "Coccidioides immitis"], answer: 2,
                explanation: "*Cryptococcus neoformans* is the most common cause of fungal meningitis, particularly in patients with AIDS (CD4 < 100 cells/µL)."
            },
            {
                id: 40, section: "Neuro-Path-002", question: "The CSF findings for Tuberculous meningitis are distinct, often showing:",
                options: ["Normal pressure and clear fluid", "Extremely high glucose", "Marked PMN pleocytosis", "Low glucose, High protein, and mononuclear cell predominance"], answer: 3,
                explanation: "TBM is subacute, causing profound inflammation (high protein) and significant glucose consumption (low), with a shift to mononuclear cells (lymphocytes) over time."
            },
            {
                id: 41, section: "Neuro-Path-002", question: "Which finding on physical examination is characterized by involuntary flexion of the hips and knees when the patient's neck is passively flexed?",
                options: ["Brudzinski's sign", "Kernig's sign", "Hoffmann's sign", "Babinski reflex"], answer: 0,
                explanation: "Brudzinski's sign is a reflex response to passive neck flexion, indicating meningeal irritation."
            },
            {
                id: 42, section: "Neuro-Path-002", question: "Pathophysiologically, acute bacterial meningitis causes brain injury via:",
                options: ["Direct viral cytotoxicity", "Widespread demyelination", "Cerebral edema, vasculitis, and increased intracranial pressure", "Calcification of the meninges"], answer: 2,
                explanation: "The inflammatory cascade leads to endothelial damage, thrombosis (vasculitis), impaired CSF flow, and severe cytotoxic/vasogenic cerebral edema, driving up intracranial pressure."
            },
            {
                id: 43, section: "Neuro-Path-002", question: "A 7-year-old child presents with a non-blanching rash and fever. The most critical complication to watch for immediately in the ICU is:",
                options: ["Hydrocephalus", "Permanent hearing loss", "Septic shock and adrenal hemorrhage (Waterhouse-Friderichsen syndrome)", "Seizure disorder"], answer: 2,
                explanation: "This presentation strongly suggests meningococcemia, which can rapidly progress to severe septic shock, DIC, and bilateral adrenal hemorrhage (Waterhouse-Friderichsen syndrome)."
            },
            {
                id: 44, section: "Neuro-Path-002", question: "Which anatomical barrier, compromised during bacterial meningitis, normally protects the brain parenchyma?",
                options: ["Blood-retinal barrier", "Blood-testis barrier", "Blood-brain barrier (BBB)", "Perineurium"], answer: 2,
                explanation: "The BBB prevents passage of inflammatory cells, proteins, and fluid into the CNS. Its breakdown leads to vasogenic edema and direct toxicity."
            },
            {
                id: 45, section: "Neuro-Path-002", question: "Recurrent, non-infectious causes of chronic meningitis (Aseptic Meningitis) may include:",
                options: ["Rheumatoid Arthritis", "Systemic Lupus Erythematosus (SLE) or NSAID use", "Common cold", "Malaria"], answer: 1,
                explanation: "Malignancy, autoimmune diseases (like SLE), and certain drugs (NSAIDs, trimethoprim-sulfamethoxazole) can cause non-infectious, chronic meningeal inflammation."
            },
            {
                id: 46, section: "Neuro-Path-002", question: "Which organism is a major concern for meningitis in the elderly and immunocompromised, often acquired from contaminated food (e.g., deli meats)?",
                options: ["Streptococcus pyogenes", "Listeria monocytogenes", "Staphylococcus aureus", "Klebsiella pneumoniae"], answer: 1,
                explanation: "*Listeria monocytogenes* causes meningitis primarily in extremes of age (neonates, elderly) and immunocompromised patients and is known for foodborne transmission."
            },
            {
                id: 47, section: "Neuro-Path-002", question: "In chronic meningitis due to *Mycobacterium tuberculosis* (TBM), the inflammatory exudate tends to accumulate at the:",
                options: ["Cerebral cortex surface", "Base of the brain (basal cisterns)", "Superior sagittal sinus", "Choroid plexus"], answer: 1,
                explanation: "TBM characteristically forms a thick, gelatinous exudate at the base of the brain, often leading to cranial nerve palsies and obstructive hydrocephalus."
            },
            {
                id: 48, section: "Neuro-Path-002", question: "The characteristic 'India ink' stain is used in CSF examination to identify the capsule of:",
                options: ["Streptococcus pneumoniae", "Haemophilus influenzae", "Cryptococcus neoformans", "Neisseria meningitidis"], answer: 2,
                explanation: "India ink highlights the large, gelatinous capsule of the yeast *Cryptococcus neoformans* as a clear halo against the black background."
            },
            {
                id: 49, section: "Neuro-Path-002", question: "Why is immediate empirical antibiotic therapy crucial in suspected bacterial meningitis?",
                options: ["To prevent permanent hearing loss", "The disease course is rapidly fatal due to high mortality", "To avoid unnecessary hospitalization", "To prevent viral resistance"], answer: 1,
                explanation: "Bacterial meningitis is a neurological emergency; delayed treatment dramatically increases the risk of mortality and severe sequelae (e.g., hearing loss, cognitive impairment)."
            },
            {
                id: 50, section: "Neuro-Path-002", question: "Hydrocephalus is a common complication of meningitis, particularly the bacterial type. This is primarily due to:",
                options: ["Increased CSF production", "Obstruction of CSF flow/reabsorption in the arachnoid villi", "Brain atrophy", "Arterial occlusion"], answer: 1,
                explanation: "Inflammatory exudate and fibrosis often clog the arachnoid granulations/villi, preventing CSF reabsorption and causing communicating hydrocephalus."
            }
        ];

        // --- STATE MANAGEMENT ---
        let currentSectionQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let wrongAnswers = [];

        // --- DOM ELEMENTS ---
        const sectionMenu = document.getElementById('section-menu');
        const quizContainer = document.getElementById('quiz-container');
        const resultScreen = document.getElementById('result-screen');
        
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const scoreBadge = document.getElementById('score-badge');
        const explanationBox = document.getElementById('explanation-box');
        const explanationText = document.getElementById('explanation-text');
        const nextBtn = document.getElementById('next-btn');
        const finalScoreDisplay = document.getElementById('final-score');
        const reviewSection = document.getElementById('review-section');
        const wrongAnswersList = document.getElementById('wrong-answers-list');

        // --- INITIALIZATION ---
        function init() {
            // Updated sections for Pathology Neurosciences
            const sections = [
                { id: "Neuro-Path-001", title: "LO 1: Cerebral Vascular Accident (CVA)", desc: "25 Qs on Pathophysiology (Ischemic & Hemorrhagic)" },
                { id: "Neuro-Path-002", title: "LO 2: Meningitis", desc: "25 Qs on Definition, Types (Bacterial, Viral, Fungal) & CSF Findings" }
            ];

            const container = sectionMenu.querySelector('.grid');
            container.innerHTML = '';

            sections.forEach(sec => {
                const btn = document.createElement('button');
                btn.className = "bg-[#2d1b4e] border border-purple-500/30 hover:border-yellow-400 p-6 rounded-2xl text-left transition-all hover:bg-purple-900/50 group shadow-lg";
                btn.onclick = () => startQuiz(sec.id);
                btn.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <span class="bg-yellow-400/10 text-yellow-400 text-xs px-2 py-1 rounded uppercase tracking-wide">${sec.id.replace('Neuro-Path-', 'LO ')}</span>
                        <i class="fa-solid fa-chevron-right text-gray-500 group-hover:text-yellow-400 transition"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-1 group-hover:text-yellow-300 transition">${sec.title}</h3>
                    <p class="text-sm text-gray-400">${sec.desc}</p>
                `;
                container.appendChild(btn);
            });
        }

        // --- QUIZ LOGIC ---
        function startQuiz(sectionId) {
            currentSectionQuestions = questionBank.filter(q => q.section === sectionId);
            currentQuestionIndex = 0;
            score = 0;
            wrongAnswers = [];
            
            sectionMenu.classList.add('hidden');
            resultScreen.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            
            renderQuestion();
        }

        function renderQuestion() {
            const q = currentSectionQuestions[currentQuestionIndex];
            
            // Update UI
            progressText.innerText = `Question ${currentQuestionIndex + 1}/${currentSectionQuestions.length}`;
            questionText.innerText = `${currentQuestionIndex + 1}. ${q.question}`;
            scoreBadge.innerText = `Score: ${score}`;
            progressBar.style.width = `${((currentQuestionIndex) / currentSectionQuestions.length) * 100}%`;
            
            // Reset State
            optionsContainer.innerHTML = '';
            explanationBox.classList.add('hidden');
            nextBtn.classList.add('hidden');

            // Create Options
            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = "option-btn w-full text-left p-4 rounded-xl border border-gray-600 bg-gray-800/50 hover:bg-gray-700 text-gray-200 font-medium relative";
                btn.innerHTML = `<span class="inline-block w-6 h-6 rounded-full bg-gray-700 text-center text-xs leading-6 mr-3 border border-gray-600">${String.fromCharCode(65 + index)}</span> ${opt}`;
                btn.onclick = () => checkAnswer(index, btn);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selectedIndex, btnElement) {
            // Disable all buttons
            const buttons = optionsContainer.querySelectorAll('button');
            buttons.forEach(b => b.disabled = true);

            const q = currentSectionQuestions[currentQuestionIndex];
            const isCorrect = selectedIndex === q.answer;

            if (isCorrect) {
                score++;
                btnElement.classList.add('correct-anim');
                btnElement.querySelector('span').classList.replace('bg-gray-700', 'bg-green-600');
                scoreBadge.innerText = `Score: ${score}`;
            } else {
                btnElement.classList.add('wrong-anim');
                btnElement.querySelector('span').classList.replace('bg-gray-700', 'bg-red-600');
                
                // Highlight correct answer
                buttons[q.answer].classList.add('correct-anim');
                buttons[q.answer].querySelector('span').classList.replace('bg-gray-700', 'bg-green-600');
                
                wrongAnswers.push({
                    question: q.question,
                    yourAnswer: q.options[selectedIndex],
                    correctAnswer: q.options[q.answer],
                    explanation: q.explanation
                });
            }

            // Show Explanation
            explanationText.innerHTML = `<strong>${isCorrect ? "Correct!" : "Incorrect."}</strong> ${q.explanation}`;
            explanationBox.classList.remove('hidden');
            
            // Show Next Button
            nextBtn.classList.remove('hidden');
            
            // Update Progress Bar
            progressBar.style.width = `${((currentQuestionIndex + 1) / currentSectionQuestions.length) * 100}%`;
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentSectionQuestions.length) {
                renderQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            quizContainer.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            
            const percentage = Math.round((score / currentSectionQuestions.length) * 100);
            finalScoreDisplay.innerText = `${percentage}%`;
            finalScoreDisplay.className = `text-6xl font-bold mb-8 ${percentage >= 70 ? 'text-green-400' : 'text-red-400'}`;

            // Render Wrong Answers
            if (wrongAnswers.length > 0) {
                reviewSection.classList.remove('hidden');
                wrongAnswersList.innerHTML = '';
                wrongAnswers.forEach(item => {
                    const div = document.createElement('div');
                    div.className = "bg-gray-800/50 p-4 rounded-xl border border-red-500/20";
                    div.innerHTML = `
                        <p class="text-white font-semibold mb-2 text-sm md:text-base">${item.question}</p>
                        <div class="text-xs md:text-sm grid gap-1">
                            <p class="text-red-400"><i class="fa-solid fa-xmark mr-2"></i>Your Answer: ${item.yourAnswer}</p>
                            <p class="text-green-400"><i class="fa-solid fa-check mr-2"></i>Correct Answer: ${item.correctAnswer}</p>
                            <p class="text-blue-300 mt-2 italic border-t border-gray-700 pt-2"><i class="fa-solid fa-lightbulb mr-1"></i> ${item.explanation}</p>
                        </div>
                    `;
                    wrongAnswersList.appendChild(div);
                });
            } else {
                reviewSection.classList.add('hidden');
            }
        }

        function restartModule() {
            // Identify current section ID by checking the first question of the last set
            if (currentSectionQuestions.length > 0) {
                const currentSecID = currentSectionQuestions[0].section;
                startQuiz(currentSecID);
            } else {
                 goHome();
            }
        }

        function goHome() {
            quizContainer.classList.add('hidden');
            resultScreen.classList.add('hidden');
            sectionMenu.classList.remove('hidden');
        }

        // Run
        init();

    </script>
</body>
</html>

